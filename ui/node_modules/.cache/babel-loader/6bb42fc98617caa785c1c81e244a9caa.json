{"ast":null,"code":"import _toConsumableArray from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/common/components/Uploader.tsx\";\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n  position: relative;\\n  margin-top: 10px;\\n\\n  label {\\n    padding: 7px 15px;\\n    background: \", \";\\n    border-radius: 4px;\\n    font-weight: 500;\\n    transition: background 0.3s ease;\\n    display: inline-block;\\n\\n    &:hover {\\n      background: \", \";\\n      cursor: pointer;\\n    }\\n  }\\n\\n  input[type='file'] {\\n    display: none;\\n  }\\n\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n  background: \", \";\\n  border-radius: 4px;\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n\\n  > div {\\n    height: 80px;\\n    margin-right: 7px;\\n  }\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  padding: 7px 15px;\\n  border-radius: 4px;\\n  margin-bottom: 15px;\\n\\n  &:hover {\\n    background: \", \";\\n  }\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  text-decoration: underline;\\n  transition: all 0.3s ease;\\n  color: \", \";\\n\\n  &:hover {\\n    color: \", \";\\n    cursor: pointer;\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  margin-bottom: 10px;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  margin: 10px 0;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport { __, Alert, confirm, uploadHandler } from 'modules/common/utils';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { rgba } from '../styles/color';\nimport colors from '../styles/colors';\nimport Attachment from './Attachment';\nimport Spinner from './Spinner';\nvar List = styled.div(_templateObject());\nvar Item = styled.div(_templateObject2());\nvar Delete = styled.span(_templateObject3(), colors.colorCoreGray, colors.colorCoreBlack);\nvar ToggleButton = styled(Delete.withComponent('div'))(_templateObject4(), rgba(colors.colorCoreDarkBlue, 0.07));\nvar LoadingContainer = styled(List)(_templateObject5(), colors.bgActive);\nvar UploadBtn = styled.div(_templateObject6(), rgba(colors.colorCoreDarkBlue, 0.05), rgba(colors.colorCoreDarkBlue, 0.1));\n\nvar Uploader =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Uploader, _React$Component);\n\n  function Uploader(props) {\n    var _this;\n\n    _classCallCheck(this, Uploader);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Uploader).call(this, props));\n\n    _this.handleFileInput = function (_ref) {\n      var target = _ref.target;\n      var files = target.files;\n      uploadHandler({\n        files: files,\n        beforeUpload: function beforeUpload() {\n          _this.setState({\n            loading: true\n          });\n        },\n        afterUpload: function afterUpload(_ref2) {\n          var status = _ref2.status,\n              response = _ref2.response,\n              fileInfo = _ref2.fileInfo;\n\n          if (status !== 'ok') {\n            Alert.error(response);\n            return _this.setState({\n              loading: false\n            });\n          }\n\n          Alert.info('Success'); // set attachments\n\n          var attachment = _objectSpread({\n            url: response\n          }, fileInfo);\n\n          var attachments = [attachment].concat(_toConsumableArray(_this.state.attachments));\n\n          _this.props.onChange(attachments);\n\n          _this.setState({\n            loading: false,\n            attachments: attachments\n          });\n        }\n      });\n      target.value = '';\n    };\n\n    _this.removeAttachment = function (index) {\n      var attachments = _toConsumableArray(_this.state.attachments);\n\n      attachments.splice(index, 1);\n\n      _this.setState({\n        attachments: attachments\n      });\n\n      _this.props.onChange(attachments);\n    };\n\n    _this.renderItem = function (item, index) {\n      var removeAttachment = function removeAttachment() {\n        confirm().then(function () {\n          return _this.removeAttachment(index);\n        });\n      };\n\n      var remove = React.createElement(Delete, {\n        onClick: removeAttachment,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, __('Delete'));\n      return React.createElement(Item, {\n        key: item.url,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(Attachment, {\n        attachment: item,\n        additionalItem: remove,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }));\n    };\n\n    _this.toggleAttachments = function () {\n      _this.setState({\n        hideOthers: !_this.state.hideOthers\n      });\n    };\n\n    _this.renderToggleButton = function (hiddenCount) {\n      if (hiddenCount > 0) {\n        var buttonText = _this.state.hideOthers ? \"\".concat(__('View all attachments'), \" (\").concat(hiddenCount, \" \").concat(__('hidden'), \")\") : \"\".concat(__('Show fewer attachments'));\n        return React.createElement(ToggleButton, {\n          onClick: _this.toggleAttachments,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }, buttonText);\n      }\n\n      return null;\n    };\n\n    _this.state = {\n      attachments: props.defaultFileList || [],\n      loading: false,\n      hideOthers: true\n    };\n    return _this;\n  }\n\n  _createClass(Uploader, [{\n    key: \"renderUploadButton\",\n    value: function renderUploadButton() {\n      var _this$props = this.props,\n          multiple = _this$props.multiple,\n          single = _this$props.single;\n\n      if (single && this.state.attachments.length > 0) {\n        return null;\n      }\n\n      return React.createElement(UploadBtn, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, __('Upload an attachment'), React.createElement(\"input\", {\n        type: \"file\",\n        multiple: multiple,\n        onChange: this.handleFileInput,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props$limit = this.props.limit,\n          limit = _this$props$limit === void 0 ? 4 : _this$props$limit;\n      var _this$state = this.state,\n          attachments = _this$state.attachments,\n          hideOthers = _this$state.hideOthers,\n          loading = _this$state.loading;\n      var length = attachments.length;\n      return React.createElement(React.Fragment, null, loading && React.createElement(LoadingContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }, React.createElement(Spinner, {\n        objective: true,\n        size: 18,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217\n        },\n        __self: this\n      }), __('Uploading'), \"...\"), React.createElement(List, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, this.state.attachments.slice(0, limit && hideOthers ? limit : length).map(function (item, index) {\n        return _this2.renderItem(item, index);\n      })), this.renderToggleButton(length - limit), this.renderUploadButton());\n    }\n  }]);\n\n  return Uploader;\n}(React.Component);\n\nUploader.defaultProps = {\n  multiple: true,\n  limit: 4\n};\nexport default Uploader;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/common/components/Uploader.tsx"],"names":["__","Alert","confirm","uploadHandler","React","styled","rgba","colors","Attachment","Spinner","List","div","Item","Delete","span","colorCoreGray","colorCoreBlack","ToggleButton","withComponent","colorCoreDarkBlue","LoadingContainer","bgActive","UploadBtn","Uploader","props","handleFileInput","target","files","beforeUpload","setState","loading","afterUpload","status","response","fileInfo","error","info","attachment","url","attachments","state","onChange","value","removeAttachment","index","splice","renderItem","item","then","remove","toggleAttachments","hideOthers","renderToggleButton","hiddenCount","buttonText","defaultFileList","multiple","single","length","limit","slice","map","renderUploadButton","Component","defaultProps"],"mappings":"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","sourcesContent":["import { __, Alert, confirm, uploadHandler } from 'modules/common/utils';\nimport React from 'react';\nimport styled from 'styled-components';\nimport { rgba } from '../styles/color';\nimport colors from '../styles/colors';\nimport { IAttachment } from '../types';\nimport Attachment from './Attachment';\nimport Spinner from './Spinner';\n\nconst List = styled.div`\n  margin: 10px 0;\n`;\n\nconst Item = styled.div`\n  margin-bottom: 10px;\n`;\n\nconst Delete = styled.span`\n  text-decoration: underline;\n  transition: all 0.3s ease;\n  color: ${colors.colorCoreGray};\n\n  &:hover {\n    color: ${colors.colorCoreBlack};\n    cursor: pointer;\n  }\n`;\n\nconst ToggleButton = styled(Delete.withComponent('div'))`\n  padding: 7px 15px;\n  border-radius: 4px;\n  margin-bottom: 15px;\n\n  &:hover {\n    background: ${rgba(colors.colorCoreDarkBlue, 0.07)};\n  }\n`;\n\nconst LoadingContainer = styled(List)`\n  background: ${colors.bgActive};\n  border-radius: 4px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  > div {\n    height: 80px;\n    margin-right: 7px;\n  }\n`;\n\nconst UploadBtn = styled.div`\n  position: relative;\n  margin-top: 10px;\n\n  label {\n    padding: 7px 15px;\n    background: ${rgba(colors.colorCoreDarkBlue, 0.05)};\n    border-radius: 4px;\n    font-weight: 500;\n    transition: background 0.3s ease;\n    display: inline-block;\n\n    &:hover {\n      background: ${rgba(colors.colorCoreDarkBlue, 0.1)};\n      cursor: pointer;\n    }\n  }\n\n  input[type='file'] {\n    display: none;\n  }\n`;\n\ntype Props = {\n  defaultFileList: IAttachment[];\n  onChange: (attachments: IAttachment[]) => void;\n  single?: boolean;\n  limit?: number;\n  multiple?: boolean;\n};\n\ntype State = {\n  attachments: IAttachment[];\n  loading: boolean;\n  hideOthers: boolean;\n};\n\nclass Uploader extends React.Component<Props, State> {\n  static defaultProps = {\n    multiple: true,\n    limit: 4\n  };\n\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      attachments: props.defaultFileList || [],\n      loading: false,\n      hideOthers: true\n    };\n  }\n\n  handleFileInput = ({ target }) => {\n    const files = target.files;\n\n    uploadHandler({\n      files,\n\n      beforeUpload: () => {\n        this.setState({\n          loading: true\n        });\n      },\n\n      afterUpload: ({ status, response, fileInfo }) => {\n        if (status !== 'ok') {\n          Alert.error(response);\n          return this.setState({ loading: false });\n        }\n\n        Alert.info('Success');\n\n        // set attachments\n        const attachment = { url: response, ...fileInfo };\n\n        const attachments = [attachment, ...this.state.attachments];\n\n        this.props.onChange(attachments);\n\n        this.setState({\n          loading: false,\n          attachments\n        });\n      }\n    });\n\n    target.value = '';\n  };\n\n  removeAttachment = (index: number) => {\n    const attachments = [...this.state.attachments];\n\n    attachments.splice(index, 1);\n\n    this.setState({ attachments });\n\n    this.props.onChange(attachments);\n  };\n\n  renderItem = (item: IAttachment, index: number) => {\n    const removeAttachment = () => {\n      confirm().then(() => this.removeAttachment(index));\n    };\n\n    const remove = <Delete onClick={removeAttachment}>{__('Delete')}</Delete>;\n\n    return (\n      <Item key={item.url}>\n        <Attachment attachment={item} additionalItem={remove} />\n      </Item>\n    );\n  };\n\n  renderUploadButton() {\n    const { multiple, single } = this.props;\n\n    if (single && this.state.attachments.length > 0) {\n      return null;\n    }\n\n    return (\n      <UploadBtn>\n        <label>\n          {__('Upload an attachment')}\n          <input\n            type=\"file\"\n            multiple={multiple}\n            onChange={this.handleFileInput}\n          />\n        </label>\n      </UploadBtn>\n    );\n  }\n\n  toggleAttachments = () => {\n    this.setState({ hideOthers: !this.state.hideOthers });\n  };\n\n  renderToggleButton = (hiddenCount: number) => {\n    if (hiddenCount > 0) {\n      const buttonText = this.state.hideOthers\n        ? `${__('View all attachments')} (${hiddenCount} ${__('hidden')})`\n        : `${__('Show fewer attachments')}`;\n\n      return (\n        <ToggleButton onClick={this.toggleAttachments}>\n          {buttonText}\n        </ToggleButton>\n      );\n    }\n\n    return null;\n  };\n\n  render() {\n    const { limit = 4 } = this.props;\n    const { attachments, hideOthers, loading } = this.state;\n\n    const length = attachments.length;\n\n    return (\n      <>\n        {loading && (\n          <LoadingContainer>\n            <Spinner objective={true} size={18} />\n            {__('Uploading')}...\n          </LoadingContainer>\n        )}\n        <List>\n          {this.state.attachments\n            .slice(0, limit && hideOthers ? limit : length)\n            .map((item, index) => this.renderItem(item, index))}\n        </List>\n        {this.renderToggleButton(length - limit)}\n        {this.renderUploadButton()}\n      </>\n    );\n  }\n}\n\nexport default Uploader;\n"]},"metadata":{},"sourceType":"module"}