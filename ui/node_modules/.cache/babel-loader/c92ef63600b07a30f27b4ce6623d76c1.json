{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/appContext.tsx\";\nimport dayjs from 'dayjs';\nimport T from 'i18n-react';\nimport React from 'react';\nvar AppContext = React.createContext({});\nexport var AppConsumer = AppContext.Consumer;\nexport var AppProvider =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AppProvider, _React$Component);\n\n  function AppProvider(props) {\n    var _this;\n\n    _classCallCheck(this, AppProvider);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AppProvider).call(this, props)); // initiliaze locale ======\n\n    _this.checkisShownIndicatorData = function () {\n      var lastImport = localStorage.getItem('erxes_import_data');\n      var type = localStorage.getItem('erxes_import_data_type');\n      var isRemovingImport = type === 'remove' ? true : false;\n\n      if (lastImport) {\n        return _this.setState({\n          isShownIndicator: true,\n          isRemovingImport: isRemovingImport\n        });\n      }\n\n      return _this.setState({\n        isShownIndicator: false,\n        isRemovingImport: false\n      });\n    };\n\n    _this.closeLoadingBar = function () {\n      _this.setState({\n        isShownIndicator: false\n      });\n\n      localStorage.setItem('erxes_import_data', '');\n      localStorage.setItem('erxes_import_data_type', '');\n    };\n\n    _this.showLoadingBar = function (isRemovingImport) {\n      _this.setState({\n        isDoneIndicatorAction: false,\n        isShownIndicator: true,\n        isRemovingImport: isRemovingImport\n      });\n    };\n\n    _this.doneIndicatorAction = function () {\n      _this.setState({\n        isDoneIndicatorAction: true\n      });\n    };\n\n    _this.setLocale = function (currentLanguage) {\n      if (currentLanguage !== 'mn') {\n        import(\"dayjs/locale/\".concat(currentLanguage)).then(function () {\n          return dayjs.locale(currentLanguage);\n        }).catch(function (_) {\n          return dayjs.locale('en');\n        });\n      }\n\n      import(\"./locales/\".concat(currentLanguage, \".json\")).then(function (data) {\n        var translations = data.default;\n        T.setTexts(translations);\n      }).catch(function (e) {\n        return console.log(e);\n      }); // tslint:disable-line\n    };\n\n    _this.changeLanguage = function (languageCode) {\n      if (_this.state.currentLanguage !== languageCode) {\n        localStorage.setItem('currentLanguage', languageCode || 'en');\n        window.location.reload();\n      }\n    };\n\n    var _currentLanguage = localStorage.getItem('currentLanguage') || 'en';\n\n    _this.state = {\n      currentUser: props.currentUser,\n      currentLanguage: _currentLanguage,\n      isShownIndicator: false,\n      isRemovingImport: false,\n      isDoneIndicatorAction: false\n    };\n\n    _this.setLocale(_currentLanguage);\n\n    return _this;\n  }\n\n  _createClass(AppProvider, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.checkisShownIndicatorData();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          currentUser = _this$state.currentUser,\n          currentLanguage = _this$state.currentLanguage,\n          isShownIndicator = _this$state.isShownIndicator,\n          isRemovingImport = _this$state.isRemovingImport,\n          isDoneIndicatorAction = _this$state.isDoneIndicatorAction;\n      return React.createElement(AppContext.Provider, {\n        value: {\n          currentUser: currentUser,\n          currentLanguage: currentLanguage,\n          changeLanguage: this.changeLanguage,\n          closeLoadingBar: this.closeLoadingBar,\n          showLoadingBar: this.showLoadingBar,\n          doneIndicatorAction: this.doneIndicatorAction,\n          isShownIndicator: isShownIndicator,\n          isRemovingImport: isRemovingImport,\n          isDoneIndicatorAction: isDoneIndicatorAction\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, this.props.children);\n    }\n  }]);\n\n  return AppProvider;\n}(React.Component);","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/appContext.tsx"],"names":["dayjs","T","React","AppContext","createContext","AppConsumer","Consumer","AppProvider","props","checkisShownIndicatorData","lastImport","localStorage","getItem","type","isRemovingImport","setState","isShownIndicator","closeLoadingBar","setItem","showLoadingBar","isDoneIndicatorAction","doneIndicatorAction","setLocale","currentLanguage","then","locale","catch","_","data","translations","default","setTexts","e","console","log","changeLanguage","languageCode","state","window","location","reload","currentUser","children","Component"],"mappings":"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","sourcesContent":["import dayjs from 'dayjs';\nimport T from 'i18n-react';\nimport { IUser } from 'modules/auth/types';\nimport React from 'react';\n\ninterface IState {\n  currentUser?: IUser;\n  currentLanguage: string;\n  isShownIndicator: boolean;\n  isRemovingImport: boolean;\n  isDoneIndicatorAction: boolean;\n}\n\ninterface IStore extends IState {\n  currentUser?: IUser;\n  changeLanguage: (languageCode: string) => void;\n  closeLoadingBar: () => void;\n  doneIndicatorAction: () => void;\n  showLoadingBar: (isRemovingImport: boolean) => void;\n}\n\nconst AppContext = React.createContext({} as IStore);\n\nexport const AppConsumer = AppContext.Consumer;\n\nexport class AppProvider extends React.Component<\n  { currentUser?: IUser },\n  IState\n> {\n  constructor(props) {\n    super(props);\n\n    // initiliaze locale ======\n    const currentLanguage = localStorage.getItem('currentLanguage') || 'en';\n\n    this.state = {\n      currentUser: props.currentUser,\n      currentLanguage,\n      isShownIndicator: false,\n      isRemovingImport: false,\n      isDoneIndicatorAction: false\n    };\n\n    this.setLocale(currentLanguage);\n  }\n\n  checkisShownIndicatorData = () => {\n    const lastImport = localStorage.getItem('erxes_import_data');\n    const type = localStorage.getItem('erxes_import_data_type');\n    const isRemovingImport = type === 'remove' ? true : false;\n\n    if (lastImport) {\n      return this.setState({ isShownIndicator: true, isRemovingImport });\n    }\n\n    return this.setState({ isShownIndicator: false, isRemovingImport: false });\n  };\n\n  closeLoadingBar = () => {\n    this.setState({ isShownIndicator: false });\n\n    localStorage.setItem('erxes_import_data', '');\n    localStorage.setItem('erxes_import_data_type', '');\n  };\n\n  showLoadingBar = (isRemovingImport: boolean) => {\n    this.setState({\n      isDoneIndicatorAction: false,\n      isShownIndicator: true,\n      isRemovingImport\n    });\n  };\n\n  doneIndicatorAction = () => {\n    this.setState({ isDoneIndicatorAction: true });\n  };\n\n  componentDidMount() {\n    this.checkisShownIndicatorData();\n  }\n\n  setLocale = (currentLanguage: string): void => {\n    if (currentLanguage !== 'mn') {\n      import(`dayjs/locale/${currentLanguage}`)\n        .then(() => dayjs.locale(currentLanguage))\n        .catch(_ => dayjs.locale('en'));\n    }\n\n    import(`./locales/${currentLanguage}.json`)\n      .then(data => {\n        const translations = data.default;\n        T.setTexts(translations);\n      })\n      .catch(e => console.log(e)); // tslint:disable-line\n  };\n\n  changeLanguage = (languageCode): void => {\n    if (this.state.currentLanguage !== languageCode) {\n      localStorage.setItem('currentLanguage', languageCode || 'en');\n      window.location.reload();\n    }\n  };\n\n  public render() {\n    const {\n      currentUser,\n      currentLanguage,\n      isShownIndicator,\n      isRemovingImport,\n      isDoneIndicatorAction\n    } = this.state;\n\n    return (\n      <AppContext.Provider\n        value={{\n          currentUser,\n          currentLanguage,\n          changeLanguage: this.changeLanguage,\n          closeLoadingBar: this.closeLoadingBar,\n          showLoadingBar: this.showLoadingBar,\n          doneIndicatorAction: this.doneIndicatorAction,\n          isShownIndicator,\n          isRemovingImport,\n          isDoneIndicatorAction\n        }}\n      >\n        {this.props.children}\n      </AppContext.Provider>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}