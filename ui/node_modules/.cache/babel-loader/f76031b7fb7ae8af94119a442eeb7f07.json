{"ast":null,"code":"import _toConsumableArray from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/forms/components/FieldsPreview.tsx\";\nimport SortableList from 'modules/common/components/SortableList';\nimport React from 'react';\nimport xss from 'xss';\nimport FieldPreview from './FieldPreview';\n\nvar FieldsPreview =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(FieldsPreview, _React$Component);\n\n  function FieldsPreview(props) {\n    var _this;\n\n    _classCallCheck(this, FieldsPreview);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FieldsPreview).call(this, props));\n\n    _this.onChangeFields = function (reOrderedFields) {\n      var fields = [];\n      var onChangeFieldsOrder = _this.props.onChangeFieldsOrder;\n      reOrderedFields.forEach(function (field, index) {\n        fields.push(_objectSpread({}, field, {\n          order: index\n        }));\n      });\n\n      _this.setState({\n        fields: fields\n      }, function () {\n        if (onChangeFieldsOrder) {\n          onChangeFieldsOrder(_this.state.fields || []);\n        }\n      });\n    };\n\n    _this.state = {\n      fields: _toConsumableArray(props.fields)\n    };\n    return _this;\n  }\n\n  _createClass(FieldsPreview, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var fields = this.props.fields;\n\n      if (fields !== prevProps.fields) {\n        this.setState({\n          fields: fields\n        });\n      }\n    }\n  }, {\n    key: \"renderFormDesc\",\n    value: function renderFormDesc() {\n      var formDesc = this.props.formDesc;\n\n      if (!formDesc) {\n        return null;\n      }\n\n      var formatted = formDesc.replace(/\\r?\\n/g, '<br />');\n      return React.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: xss(formatted)\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var child = function child(field) {\n        return React.createElement(FieldPreview, {\n          key: field._id,\n          onClick: _this2.props.onFieldClick,\n          field: field,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69\n          },\n          __self: this\n        });\n      };\n\n      return React.createElement(React.Fragment, null, this.renderFormDesc(), React.createElement(SortableList, {\n        child: child,\n        fields: this.state.fields || [],\n        onChangeFields: this.onChangeFields,\n        droppableId: \"form\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return FieldsPreview;\n}(React.Component);\n\nexport default FieldsPreview;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/forms/components/FieldsPreview.tsx"],"names":["SortableList","React","xss","FieldPreview","FieldsPreview","props","onChangeFields","reOrderedFields","fields","onChangeFieldsOrder","forEach","field","index","push","order","setState","state","prevProps","formDesc","formatted","replace","__html","child","_id","onFieldClick","renderFormDesc","Component"],"mappings":";;;;;;;;AAAA,OAAOA,YAAP,MAAyB,wCAAzB;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,GAAP,MAAgB,KAAhB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;;IAaMC,a;;;;;AACJ,yBAAYC,KAAZ,EAA0B;AAAA;;AAAA;;AACxB,uFAAMA,KAAN;;AADwB,UAgB1BC,cAhB0B,GAgBT,UAACC,eAAD,EAA+B;AAC9C,UAAMC,MAAgB,GAAG,EAAzB;AAD8C,UAGtCC,mBAHsC,GAGd,MAAKJ,KAHS,CAGtCI,mBAHsC;AAK9CF,MAAAA,eAAe,CAACG,OAAhB,CAAwB,UAACC,KAAD,EAAQC,KAAR,EAAkB;AACxCJ,QAAAA,MAAM,CAACK,IAAP,mBACKF,KADL;AAEEG,UAAAA,KAAK,EAAEF;AAFT;AAID,OALD;;AAOA,YAAKG,QAAL,CAAc;AAAEP,QAAAA,MAAM,EAANA;AAAF,OAAd,EAA0B,YAAM;AAC9B,YAAIC,mBAAJ,EAAyB;AACvBA,UAAAA,mBAAmB,CAAC,MAAKO,KAAL,CAAWR,MAAX,IAAqB,EAAtB,CAAnB;AACD;AACF,OAJD;AAKD,KAjCyB;;AAGxB,UAAKQ,KAAL,GAAa;AACXR,MAAAA,MAAM,qBAAMH,KAAK,CAACG,MAAZ;AADK,KAAb;AAHwB;AAMzB;;;;uCAEkBS,S,EAAkB;AAAA,UAC3BT,MAD2B,GAChB,KAAKH,KADW,CAC3BG,MAD2B;;AAGnC,UAAIA,MAAM,KAAKS,SAAS,CAACT,MAAzB,EAAiC;AAC/B,aAAKO,QAAL,CAAc;AAAEP,UAAAA,MAAM,EAANA;AAAF,SAAd;AACD;AACF;;;qCAqBgB;AAAA,UACPU,QADO,GACM,KAAKb,KADX,CACPa,QADO;;AAGf,UAAI,CAACA,QAAL,EAAe;AACb,eAAO,IAAP;AACD;;AAED,UAAMC,SAAS,GAAGD,QAAQ,CAACE,OAAT,CAAiB,QAAjB,EAA2B,QAA3B,CAAlB;AAEA,aAAO;AAAK,QAAA,uBAAuB,EAAE;AAAEC,UAAAA,MAAM,EAAEnB,GAAG,CAACiB,SAAD;AAAb,SAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACD;;;6BAEQ;AAAA;;AACP,UAAMG,KAAK,GAAG,SAARA,KAAQ,CAAAX,KAAK,EAAI;AACrB,eACE,oBAAC,YAAD;AACE,UAAA,GAAG,EAAEA,KAAK,CAACY,GADb;AAEE,UAAA,OAAO,EAAE,MAAI,CAAClB,KAAL,CAAWmB,YAFtB;AAGE,UAAA,KAAK,EAAEb,KAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAOD,OARD;;AAUA,aACE,0CACG,KAAKc,cAAL,EADH,EAGE,oBAAC,YAAD;AACE,QAAA,KAAK,EAAEH,KADT;AAEE,QAAA,MAAM,EAAE,KAAKN,KAAL,CAAWR,MAAX,IAAqB,EAF/B;AAGE,QAAA,cAAc,EAAE,KAAKF,cAHvB;AAIE,QAAA,WAAW,EAAC,MAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,CADF;AAYD;;;;EAvEyBL,KAAK,CAACyB,S;;AA0ElC,eAAetB,aAAf","sourcesContent":["import SortableList from 'modules/common/components/SortableList';\nimport { IField } from 'modules/settings/properties/types';\nimport React from 'react';\nimport xss from 'xss';\nimport FieldPreview from './FieldPreview';\n\ntype Props = {\n  fields: IField[];\n  formDesc?: string;\n  onFieldClick?: (field: IField) => void;\n  onChangeFieldsOrder?: (fields: IField[]) => void;\n};\n\ntype State = {\n  fields?: IField[];\n};\n\nclass FieldsPreview extends React.Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      fields: [...props.fields]\n    };\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    const { fields } = this.props;\n\n    if (fields !== prevProps.fields) {\n      this.setState({ fields });\n    }\n  }\n\n  onChangeFields = (reOrderedFields: IField[]) => {\n    const fields: IField[] = [];\n\n    const { onChangeFieldsOrder } = this.props;\n\n    reOrderedFields.forEach((field, index) => {\n      fields.push({\n        ...field,\n        order: index\n      });\n    });\n\n    this.setState({ fields }, () => {\n      if (onChangeFieldsOrder) {\n        onChangeFieldsOrder(this.state.fields || []);\n      }\n    });\n  };\n\n  renderFormDesc() {\n    const { formDesc } = this.props;\n\n    if (!formDesc) {\n      return null;\n    }\n\n    const formatted = formDesc.replace(/\\r?\\n/g, '<br />');\n\n    return <div dangerouslySetInnerHTML={{ __html: xss(formatted) }} />;\n  }\n\n  render() {\n    const child = field => {\n      return (\n        <FieldPreview\n          key={field._id}\n          onClick={this.props.onFieldClick}\n          field={field}\n        />\n      );\n    };\n\n    return (\n      <>\n        {this.renderFormDesc()}\n\n        <SortableList\n          child={child}\n          fields={this.state.fields || []}\n          onChangeFields={this.onChangeFields}\n          droppableId=\"form\"\n        />\n      </>\n    );\n  }\n}\n\nexport default FieldsPreview;\n"]},"metadata":{},"sourceType":"module"}