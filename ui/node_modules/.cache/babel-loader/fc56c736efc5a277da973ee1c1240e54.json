{"ast":null,"code":"import _objectSpread from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/tickets/components/TicketEditForm.tsx\";\nimport EditForm from 'modules/boards/components/editForm/EditForm';\nimport Left from 'modules/boards/components/editForm/Left';\nimport Sidebar from 'modules/boards/components/editForm/Sidebar';\nimport Top from 'modules/boards/components/editForm/Top';\nimport { FlexContent } from 'modules/boards/styles/item';\nimport FormGroup from 'modules/common/components/form/Group';\nimport ControlLabel from 'modules/common/components/form/Label';\nimport { __ } from 'modules/common/utils';\nimport PortableDeals from 'modules/deals/components/PortableDeals';\nimport { INTEGRATION_KINDS } from 'modules/settings/integrations/constants';\nimport { Capitalize } from 'modules/settings/permissions/styles';\nimport PortableTasks from 'modules/tasks/components/PortableTasks';\nimport React, { useEffect, useState } from 'react';\nimport Select from 'react-select-plus';\nexport default function TicketEditForm(props) {\n  var item = props.item;\n\n  var _useState = useState(item.source),\n      _useState2 = _slicedToArray(_useState, 2),\n      source = _useState2[0],\n      setSource = _useState2[1];\n\n  useEffect(function () {\n    setSource(item.source);\n  }, [item.source]);\n\n  function renderSidebarFields(saveItem) {\n    var sourceValues = INTEGRATION_KINDS.ALL.map(function (kind) {\n      return {\n        label: __(kind.text),\n        value: kind.value\n      };\n    });\n    sourceValues.push({\n      label: __('Other'),\n      value: 'other'\n    });\n\n    var sourceValueRenderer = function sourceValueRenderer(option) {\n      return React.createElement(Capitalize, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }, option.label);\n    };\n\n    var onSourceChange = function onSourceChange(option) {\n      var value = option ? option.value : '';\n      setSource(value);\n\n      if (saveItem) {\n        saveItem({\n          source: value\n        });\n      }\n    };\n\n    return React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 66\n      },\n      __self: this\n    }, React.createElement(ControlLabel, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, \"Source\"), React.createElement(Select, {\n      placeholder: __('Select a source'),\n      value: source,\n      options: sourceValues,\n      onChange: onSourceChange,\n      optionRenderer: sourceValueRenderer,\n      valueRenderer: sourceValueRenderer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }));\n  }\n\n  function renderItems() {\n    return React.createElement(React.Fragment, null, React.createElement(PortableDeals, {\n      mainType: \"ticket\",\n      mainTypeId: props.item._id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }), React.createElement(PortableTasks, {\n      mainType: \"ticket\",\n      mainTypeId: props.item._id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }));\n  }\n\n  function renderFormContent(_ref) {\n    var state = _ref.state,\n        copy = _ref.copy,\n        remove = _ref.remove,\n        saveItem = _ref.saveItem,\n        onChangeStage = _ref.onChangeStage;\n    var options = props.options,\n        onUpdate = props.onUpdate,\n        addItem = props.addItem,\n        sendToBoard = props.sendToBoard;\n\n    var renderSidebar = function renderSidebar() {\n      return renderSidebarFields(saveItem);\n    };\n\n    return React.createElement(React.Fragment, null, React.createElement(Top, {\n      options: options,\n      stageId: state.stageId,\n      item: item,\n      saveItem: saveItem,\n      onChangeStage: onChangeStage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }), React.createElement(FlexContent, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(Left, {\n      options: options,\n      saveItem: saveItem,\n      copyItem: copy,\n      removeItem: remove,\n      onUpdate: onUpdate,\n      item: item,\n      addItem: addItem,\n      sendToBoard: sendToBoard,\n      onChangeStage: onChangeStage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(Sidebar, {\n      options: options,\n      item: item,\n      sidebar: renderSidebar,\n      saveItem: saveItem,\n      renderItems: renderItems,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    })));\n  }\n\n  var extendedProps = _objectSpread({}, props, {\n    formContent: renderFormContent,\n    extraFields: {\n      source: source\n    }\n  });\n\n  return React.createElement(EditForm, Object.assign({}, extendedProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }));\n}","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/tickets/components/TicketEditForm.tsx"],"names":["EditForm","Left","Sidebar","Top","FlexContent","FormGroup","ControlLabel","__","PortableDeals","INTEGRATION_KINDS","Capitalize","PortableTasks","React","useEffect","useState","Select","TicketEditForm","props","item","source","setSource","renderSidebarFields","saveItem","sourceValues","ALL","map","kind","label","text","value","push","sourceValueRenderer","option","onSourceChange","renderItems","_id","renderFormContent","state","copy","remove","onChangeStage","options","onUpdate","addItem","sendToBoard","renderSidebar","stageId","extendedProps","formContent","extraFields"],"mappings":"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","sourcesContent":["import EditForm from 'modules/boards/components/editForm/EditForm';\nimport Left from 'modules/boards/components/editForm/Left';\nimport Sidebar from 'modules/boards/components/editForm/Sidebar';\nimport Top from 'modules/boards/components/editForm/Top';\nimport { FlexContent } from 'modules/boards/styles/item';\nimport { IEditFormContent, IOptions } from 'modules/boards/types';\nimport FormGroup from 'modules/common/components/form/Group';\nimport ControlLabel from 'modules/common/components/form/Label';\nimport { ISelectedOption } from 'modules/common/types';\nimport { __ } from 'modules/common/utils';\nimport PortableDeals from 'modules/deals/components/PortableDeals';\nimport { INTEGRATION_KINDS } from 'modules/settings/integrations/constants';\nimport { Capitalize } from 'modules/settings/permissions/styles';\nimport PortableTasks from 'modules/tasks/components/PortableTasks';\nimport React, { useEffect, useState } from 'react';\nimport Select from 'react-select-plus';\nimport { ITicket, ITicketParams } from '../types';\n\ntype Props = {\n  options: IOptions;\n  item: ITicket;\n  addItem: (doc: ITicketParams, callback: () => void, msg?: string) => void;\n  saveItem: (doc: ITicketParams, callback?: (item) => void) => void;\n  copyItem: (itemId: string, callback: (item) => void) => void;\n  onUpdate: (item, prevStageId?: string) => void;\n  removeItem: (itemId: string, callback: () => void) => void;\n  beforePopupClose: () => void;\n  sendToBoard?: (item: any) => void;\n};\n\nexport default function TicketEditForm(props: Props) {\n  const item = props.item;\n\n  const [source, setSource] = useState(item.source);\n\n  useEffect(() => {\n    setSource(item.source);\n  }, [item.source]);\n\n  function renderSidebarFields(saveItem) {\n    const sourceValues = INTEGRATION_KINDS.ALL.map(kind => ({\n      label: __(kind.text),\n      value: kind.value\n    }));\n\n    sourceValues.push({\n      label: __('Other'),\n      value: 'other'\n    });\n\n    const sourceValueRenderer = (option: ISelectedOption): React.ReactNode => (\n      <Capitalize>{option.label}</Capitalize>\n    );\n\n    const onSourceChange = option => {\n      const value = option ? option.value : '';\n\n      setSource(value);\n\n      if (saveItem) {\n        saveItem({ source: value });\n      }\n    };\n\n    return (\n      <FormGroup>\n        <ControlLabel>Source</ControlLabel>\n        <Select\n          placeholder={__('Select a source')}\n          value={source}\n          options={sourceValues}\n          onChange={onSourceChange}\n          optionRenderer={sourceValueRenderer}\n          valueRenderer={sourceValueRenderer}\n        />\n      </FormGroup>\n    );\n  }\n\n  function renderItems() {\n    return (\n      <>\n        <PortableDeals mainType=\"ticket\" mainTypeId={props.item._id} />\n        <PortableTasks mainType=\"ticket\" mainTypeId={props.item._id} />\n      </>\n    );\n  }\n\n  function renderFormContent({\n    state,\n    copy,\n    remove,\n    saveItem,\n    onChangeStage\n  }: IEditFormContent) {\n    const { options, onUpdate, addItem, sendToBoard } = props;\n\n    const renderSidebar = () => renderSidebarFields(saveItem);\n\n    return (\n      <>\n        <Top\n          options={options}\n          stageId={state.stageId}\n          item={item}\n          saveItem={saveItem}\n          onChangeStage={onChangeStage}\n        />\n\n        <FlexContent>\n          <Left\n            options={options}\n            saveItem={saveItem}\n            copyItem={copy}\n            removeItem={remove}\n            onUpdate={onUpdate}\n            item={item}\n            addItem={addItem}\n            sendToBoard={sendToBoard}\n            onChangeStage={onChangeStage}\n          />\n\n          <Sidebar\n            options={options}\n            item={item}\n            sidebar={renderSidebar}\n            saveItem={saveItem}\n            renderItems={renderItems}\n          />\n        </FlexContent>\n      </>\n    );\n  }\n\n  const extendedProps = {\n    ...props,\n    formContent: renderFormContent,\n    extraFields: { source }\n  };\n\n  return <EditForm {...extendedProps} />;\n}\n"]},"metadata":{},"sourceType":"module"}