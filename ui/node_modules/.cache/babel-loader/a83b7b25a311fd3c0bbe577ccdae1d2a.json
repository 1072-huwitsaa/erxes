{"ast":null,"code":"var _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/common/components/WithPermission.tsx\";\nimport { AppConsumer } from 'appContext';\nimport React from 'react';\nimport { can } from '../utils';\n\nvar WithPermission = function WithPermission(props) {\n  var action = props.action,\n      actions = props.actions,\n      children = props.children,\n      fallbackComponent = props.fallbackComponent;\n  return React.createElement(AppConsumer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 16\n    },\n    __self: this\n  }, function (_ref) {\n    var currentUser = _ref.currentUser;\n\n    if (!currentUser) {\n      return fallbackComponent || null;\n    } // check when an action is possible through multiple permissions\n\n\n    if (actions && actions.length > 0) {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = actions[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var a = _step.value;\n\n          if (can(a, currentUser)) {\n            return children;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n    }\n\n    if (!can(action, currentUser)) {\n      return fallbackComponent || null;\n    }\n\n    return children;\n  });\n};\n\nexport default WithPermission;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/common/components/WithPermission.tsx"],"names":["AppConsumer","React","can","WithPermission","props","action","actions","children","fallbackComponent","currentUser","length","a"],"mappings":";AAAA,SAASA,WAAT,QAA4B,YAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,GAAT,QAAoB,UAApB;;AASA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,KAAD,EAAkB;AAAA,MAC/BC,MAD+B,GACkBD,KADlB,CAC/BC,MAD+B;AAAA,MACvBC,OADuB,GACkBF,KADlB,CACvBE,OADuB;AAAA,MACdC,QADc,GACkBH,KADlB,CACdG,QADc;AAAA,MACJC,iBADI,GACkBJ,KADlB,CACJI,iBADI;AAGvC,SACE,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG,gBAAqB;AAAA,QAAlBC,WAAkB,QAAlBA,WAAkB;;AACpB,QAAI,CAACA,WAAL,EAAkB;AAChB,aAAOD,iBAAiB,IAAI,IAA5B;AACD,KAHmB,CAKpB;;;AACA,QAAIF,OAAO,IAAIA,OAAO,CAACI,MAAR,GAAiB,CAAhC,EAAmC;AAAA;AAAA;AAAA;;AAAA;AACjC,6BAAgBJ,OAAhB,8HAAyB;AAAA,cAAdK,CAAc;;AACvB,cAAIT,GAAG,CAACS,CAAD,EAAIF,WAAJ,CAAP,EAAyB;AACvB,mBAAOF,QAAP;AACD;AACF;AALgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMlC;;AAED,QAAI,CAACL,GAAG,CAACG,MAAD,EAASI,WAAT,CAAR,EAA+B;AAC7B,aAAOD,iBAAiB,IAAI,IAA5B;AACD;;AAED,WAAOD,QAAP;AACD,GApBH,CADF;AAwBD,CA3BD;;AA6BA,eAAeJ,cAAf","sourcesContent":["import { AppConsumer } from 'appContext';\nimport React from 'react';\nimport { can } from '../utils';\n\ntype Props = {\n  action: string;\n  children: React.ReactNode;\n  fallbackComponent?: React.ReactNode;\n  actions?: string[];\n};\n\nconst WithPermission = (props: Props) => {\n  const { action, actions, children, fallbackComponent } = props;\n\n  return (\n    <AppConsumer>\n      {({ currentUser }) => {\n        if (!currentUser) {\n          return fallbackComponent || null;\n        }\n\n        // check when an action is possible through multiple permissions\n        if (actions && actions.length > 0) {\n          for (const a of actions) {\n            if (can(a, currentUser)) {\n              return children;\n            }\n          }\n        }\n\n        if (!can(action, currentUser)) {\n          return fallbackComponent || null;\n        }\n\n        return children;\n      }}\n    </AppConsumer>\n  );\n};\n\nexport default WithPermission;\n"]},"metadata":{},"sourceType":"module"}