{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/deals/components/DealItem.tsx\";\nimport dayjs from 'dayjs';\nimport Assignees from 'modules/boards/components/Assignees';\nimport Details from 'modules/boards/components/Details';\nimport DueDateLabel from 'modules/boards/components/DueDateLabel';\nimport Labels from 'modules/boards/components/label/Labels';\nimport EditForm from 'modules/boards/containers/editForm/EditForm';\nimport { ItemContainer, ItemDate } from 'modules/boards/styles/common';\nimport { Footer, PriceContainer, Right, Status } from 'modules/boards/styles/item';\nimport { Content } from 'modules/boards/styles/stage';\nimport { renderAmount, renderPriority } from 'modules/boards/utils';\nimport Icon from 'erxes-common-ui/lib/components/icon';\nimport { colors } from 'modules/common/styles';\nimport { __ } from 'modules/common/utils';\nimport React from 'react';\n\nvar DealItem =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(DealItem, _React$PureComponent);\n\n  function DealItem() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, DealItem);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(DealItem)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.renderForm = function () {\n      var _this$props = _this.props,\n          stageId = _this$props.stageId,\n          item = _this$props.item,\n          isFormVisible = _this$props.isFormVisible;\n\n      if (!isFormVisible) {\n        return null;\n      }\n\n      return React.createElement(EditForm, Object.assign({}, _this.props, {\n        stageId: stageId || item.stageId,\n        itemId: item._id,\n        hideHeader: true,\n        isPopupVisible: isFormVisible,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      }));\n    };\n\n    return _this;\n  }\n\n  _createClass(DealItem, [{\n    key: \"renderDate\",\n    value: function renderDate(date) {\n      if (!date) {\n        return null;\n      }\n\n      return React.createElement(ItemDate, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }, dayjs(date).format('lll'));\n    }\n  }, {\n    key: \"renderStatusLabel\",\n    value: function renderStatusLabel(text, color) {\n      return React.createElement(Status, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        style: {\n          backgroundColor: color\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }, __(text)));\n    }\n  }, {\n    key: \"renderStatus\",\n    value: function renderStatus(stage) {\n      if (!stage) {\n        return null;\n      }\n\n      if (stage.probability === 'Lost') {\n        return this.renderStatusLabel('Lost', colors.colorCoreRed);\n      }\n\n      if (stage.probability === 'Won') {\n        return this.renderStatusLabel('Won', colors.colorCoreGreen);\n      }\n\n      return this.renderStatusLabel('In Progress', colors.colorCoreBlue);\n    }\n  }, {\n    key: \"renderContent\",\n    value: function renderContent() {\n      var item = this.props.item;\n      var products = (item.products || []).filter(function (p) {\n        return p.tickUsed;\n      }).map(function (p) {\n        return p.product;\n      });\n      var exProducts = (item.products || []).filter(function (p) {\n        return !p.tickUsed;\n      }).map(function (p) {\n        return p.product;\n      });\n      var customers = item.customers,\n          companies = item.companies,\n          closeDate = item.closeDate,\n          isComplete = item.isComplete;\n      return React.createElement(React.Fragment, null, React.createElement(\"h5\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }, renderPriority(item.priority), item.name), React.createElement(Details, {\n        color: \"#63D2D6\",\n        items: products,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }), React.createElement(Details, {\n        color: \"#b49cf1\",\n        items: exProducts,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }), React.createElement(Details, {\n        color: \"#F7CE53\",\n        items: customers || [],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      }), React.createElement(Details, {\n        color: \"#EA475D\",\n        items: companies || [],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }), React.createElement(PriceContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, renderAmount(item.amount), React.createElement(Right, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(Assignees, {\n        users: item.assignedUsers,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }))), React.createElement(DueDateLabel, {\n        closeDate: closeDate,\n        isComplete: isComplete,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }), React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, item.isWatched ? React.createElement(Icon, {\n        icon: \"eye\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }) : __('Last updated'), React.createElement(Right, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, this.renderDate(item.modifiedAt))));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          item = _this$props2.item,\n          portable = _this$props2.portable,\n          onClick = _this$props2.onClick;\n\n      if (portable) {\n        return React.createElement(React.Fragment, null, React.createElement(ItemContainer, {\n          onClick: onClick,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, this.renderStatus(item.stage), React.createElement(Content, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }, this.renderContent())), this.renderForm());\n      }\n\n      return React.createElement(React.Fragment, null, React.createElement(Labels, {\n        labels: item.labels,\n        indicator: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }), React.createElement(Content, {\n        onClick: onClick,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, this.renderContent()), this.renderForm());\n    }\n  }]);\n\n  return DealItem;\n}(React.PureComponent);\n\nexport default DealItem;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/deals/components/DealItem.tsx"],"names":["dayjs","Assignees","Details","DueDateLabel","Labels","EditForm","ItemContainer","ItemDate","Footer","PriceContainer","Right","Status","Content","renderAmount","renderPriority","Icon","colors","__","React","DealItem","renderForm","props","stageId","item","isFormVisible","_id","date","format","text","color","backgroundColor","stage","probability","renderStatusLabel","colorCoreRed","colorCoreGreen","colorCoreBlue","products","filter","p","tickUsed","map","product","exProducts","customers","companies","closeDate","isComplete","priority","name","amount","assignedUsers","isWatched","renderDate","modifiedAt","portable","onClick","renderStatus","renderContent","labels","PureComponent"],"mappings":"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","sourcesContent":["import dayjs from 'dayjs';\nimport Assignees from 'modules/boards/components/Assignees';\nimport Details from 'modules/boards/components/Details';\nimport DueDateLabel from 'modules/boards/components/DueDateLabel';\nimport Labels from 'modules/boards/components/label/Labels';\nimport EditForm from 'modules/boards/containers/editForm/EditForm';\nimport { ItemContainer, ItemDate } from 'modules/boards/styles/common';\nimport {\n  Footer,\n  PriceContainer,\n  Right,\n  Status\n} from 'modules/boards/styles/item';\nimport { Content } from 'modules/boards/styles/stage';\nimport { IOptions } from 'modules/boards/types';\nimport { renderAmount, renderPriority } from 'modules/boards/utils';\nimport Icon from 'erxes-common-ui/lib/components/icon';\nimport { colors } from 'modules/common/styles';\nimport { __ } from 'modules/common/utils';\nimport React from 'react';\nimport { IDeal } from '../types';\n\ntype Props = {\n  stageId?: string;\n  item: IDeal;\n  beforePopupClose?: () => void;\n  onClick?: () => void;\n  options?: IOptions;\n  isFormVisible?: boolean;\n  portable?: boolean;\n  onAdd?: (stageId: string, item: IDeal) => void;\n  onRemove?: (dealId: string, stageId: string) => void;\n  onUpdate?: (item: IDeal) => void;\n};\n\nclass DealItem extends React.PureComponent<Props> {\n  renderForm = () => {\n    const { stageId, item, isFormVisible } = this.props;\n\n    if (!isFormVisible) {\n      return null;\n    }\n\n    return (\n      <EditForm\n        {...this.props}\n        stageId={stageId || item.stageId}\n        itemId={item._id}\n        hideHeader={true}\n        isPopupVisible={isFormVisible}\n      />\n    );\n  };\n\n  renderDate(date) {\n    if (!date) {\n      return null;\n    }\n\n    return <ItemDate>{dayjs(date).format('lll')}</ItemDate>;\n  }\n\n  renderStatusLabel(text, color) {\n    return (\n      <Status>\n        <span style={{ backgroundColor: color }}>{__(text)}</span>\n      </Status>\n    );\n  }\n\n  renderStatus(stage) {\n    if (!stage) {\n      return null;\n    }\n\n    if (stage.probability === 'Lost') {\n      return this.renderStatusLabel('Lost', colors.colorCoreRed);\n    }\n\n    if (stage.probability === 'Won') {\n      return this.renderStatusLabel('Won', colors.colorCoreGreen);\n    }\n\n    return this.renderStatusLabel('In Progress', colors.colorCoreBlue);\n  }\n\n  renderContent() {\n    const { item } = this.props;\n\n    const products = (item.products || [])\n      .filter(p => p.tickUsed)\n      .map(p => p.product);\n\n    const exProducts = (item.products || [])\n      .filter(p => !p.tickUsed)\n      .map(p => p.product);\n\n    const { customers, companies, closeDate, isComplete } = item;\n\n    return (\n      <>\n        <h5>\n          {renderPriority(item.priority)}\n          {item.name}\n        </h5>\n\n        <Details color=\"#63D2D6\" items={products} />\n        <Details color=\"#b49cf1\" items={exProducts} />\n        <Details color=\"#F7CE53\" items={customers || []} />\n        <Details color=\"#EA475D\" items={companies || []} />\n\n        <PriceContainer>\n          {renderAmount(item.amount)}\n\n          <Right>\n            <Assignees users={item.assignedUsers} />\n          </Right>\n        </PriceContainer>\n\n        <DueDateLabel closeDate={closeDate} isComplete={isComplete} />\n\n        <Footer>\n          {item.isWatched ? <Icon icon=\"eye\" /> : __('Last updated')}\n          <Right>{this.renderDate(item.modifiedAt)}</Right>\n        </Footer>\n      </>\n    );\n  }\n\n  render() {\n    const { item, portable, onClick } = this.props;\n\n    if (portable) {\n      return (\n        <>\n          <ItemContainer onClick={onClick}>\n            {this.renderStatus(item.stage)}\n            <Content>{this.renderContent()}</Content>\n          </ItemContainer>\n          {this.renderForm()}\n        </>\n      );\n    }\n\n    return (\n      <>\n        <Labels labels={item.labels} indicator={true} />\n        <Content onClick={onClick}>{this.renderContent()}</Content>\n        {this.renderForm()}\n      </>\n    );\n  }\n}\n\nexport default DealItem;\n"]},"metadata":{},"sourceType":"module"}