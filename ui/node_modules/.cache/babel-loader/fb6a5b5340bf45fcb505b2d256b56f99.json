{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _taggedTemplateLiteral from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/internalNotes/components/Form.tsx\";\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  position: relative;\\n\\n  > .cke_chrome {\\n    border-bottom: 0;\\n    border-left: 0;\\n    border-right: 0;\\n  }\\n\\n  .cke_bottom {\\n    position: absolute;\\n    bottom: 0;\\n    right: 0;\\n    left: 0;\\n  }\\n\\n  .cke_toolgroup {\\n    border: 0;\\n    margin-left: 3px;\\n  }\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  padding: 0px 15px 37px 15px;\\n  text-align: right;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport Button from 'erxes-common-ui/lib/components/button';\nimport { SmallLoader } from 'modules/common/components/ButtonMutate';\nimport { getMentionedUserIds } from 'modules/common/components/EditorCK';\nimport EditorCK from 'modules/common/containers/EditorCK';\nimport React from 'react';\nimport styled from 'styled-components';\nexport var EditorActions = styled.div(_templateObject());\nexport var EditorWrapper = styled.div(_templateObject2());\n\nvar Form =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Form, _React$PureComponent);\n\n  function Form(props) {\n    var _this;\n\n    _classCallCheck(this, Form);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Form).call(this, props));\n\n    _this.clearContent = function () {\n      _this.setState({\n        content: ''\n      });\n\n      var _this$props = _this.props,\n          contentType = _this$props.contentType,\n          contentTypeId = _this$props.contentTypeId;\n      var editorName = \"\".concat(contentType, \"_note_\").concat(contentTypeId);\n      localStorage.removeItem(editorName);\n    };\n\n    _this.onSend = function () {\n      var content = _this.state.content;\n      var callback = _this.props.callback;\n      var mentionedUserIds = getMentionedUserIds(content);\n\n      _this.props.save({\n        content: content,\n        mentionedUserIds: mentionedUserIds\n      }, function () {\n        callback ? callback() : _this.clearContent();\n      });\n    };\n\n    _this.onEditorChange = function (e) {\n      _this.setState({\n        content: e.editor.getData()\n      });\n    };\n\n    _this.state = {\n      content: props.content || ''\n    };\n    return _this;\n  }\n\n  _createClass(Form, [{\n    key: \"renderFooter\",\n    value: function renderFooter() {\n      var _this$props2 = this.props,\n          isActionLoading = _this$props2.isActionLoading,\n          content = _this$props2.content,\n          callback = _this$props2.callback;\n\n      if (!this.state.content) {\n        return null;\n      }\n\n      return React.createElement(EditorActions, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, content && React.createElement(Button, {\n        icon: \"cancel-1\",\n        btnStyle: \"simple\",\n        size: \"small\",\n        onClick: callback,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, \"Cancel\"), React.createElement(Button, {\n        onClick: this.clearContent,\n        btnStyle: \"warning\",\n        size: \"small\",\n        icon: \"eraser-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, \"Discard\"), React.createElement(Button, {\n        disabled: isActionLoading,\n        onClick: this.onSend,\n        btnStyle: \"success\",\n        size: \"small\",\n        icon: isActionLoading ? undefined : 'message',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      }, isActionLoading && React.createElement(SmallLoader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }), \"Save\"));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          contentType = _this$props3.contentType,\n          contentTypeId = _this$props3.contentTypeId;\n      return React.createElement(EditorWrapper, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(EditorCK, {\n        onCtrlEnter: this.onSend,\n        showMentions: true,\n        content: this.state.content,\n        onChange: this.onEditorChange,\n        height: 150,\n        name: \"\".concat(contentType, \"_note_\").concat(contentTypeId),\n        toolbar: [{\n          name: 'basicstyles',\n          items: ['Bold', 'Italic', 'NumberedList', 'BulletedList', 'Link', 'Unlink', '-', 'Image', 'EmojiPanel']\n        }],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }), this.renderFooter());\n    }\n  }]);\n\n  return Form;\n}(React.PureComponent);\n\nexport default Form;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/internalNotes/components/Form.tsx"],"names":["Button","SmallLoader","getMentionedUserIds","EditorCK","React","styled","EditorActions","div","EditorWrapper","Form","props","clearContent","setState","content","contentType","contentTypeId","editorName","localStorage","removeItem","onSend","state","callback","mentionedUserIds","save","onEditorChange","e","editor","getData","isActionLoading","undefined","name","items","renderFooter","PureComponent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,MAAP,MAAmB,uCAAnB;AACA,SAASC,WAAT,QAA4B,wCAA5B;AACA,SAASC,mBAAT,QAAoC,oCAApC;AACA,OAAOC,QAAP,MAAqB,oCAArB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AAEA,OAAO,IAAMC,aAAa,GAAGD,MAAM,CAACE,GAAV,mBAAnB;AAKP,OAAO,IAAMC,aAAa,GAAGH,MAAM,CAACE,GAAV,oBAAnB;;IAmCDE,I;;;;;AACJ,gBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8EAAMA,KAAN;;AADiB,UAQnBC,YARmB,GAQJ,YAAM;AACnB,YAAKC,QAAL,CAAc;AAAEC,QAAAA,OAAO,EAAE;AAAX,OAAd;;AADmB,wBAGoB,MAAKH,KAHzB;AAAA,UAGXI,WAHW,eAGXA,WAHW;AAAA,UAGEC,aAHF,eAGEA,aAHF;AAInB,UAAMC,UAAU,aAAMF,WAAN,mBAA0BC,aAA1B,CAAhB;AAEAE,MAAAA,YAAY,CAACC,UAAb,CAAwBF,UAAxB;AACD,KAfkB;;AAAA,UAiBnBG,MAjBmB,GAiBV,YAAM;AAAA,UACLN,OADK,GACO,MAAKO,KADZ,CACLP,OADK;AAAA,UAELQ,QAFK,GAEQ,MAAKX,KAFb,CAELW,QAFK;AAIb,UAAMC,gBAAgB,GAAGpB,mBAAmB,CAACW,OAAD,CAA5C;;AAEA,YAAKH,KAAL,CAAWa,IAAX,CAAgB;AAAEV,QAAAA,OAAO,EAAPA,OAAF;AAAWS,QAAAA,gBAAgB,EAAhBA;AAAX,OAAhB,EAA+C,YAAM;AACnDD,QAAAA,QAAQ,GAAGA,QAAQ,EAAX,GAAgB,MAAKV,YAAL,EAAxB;AACD,OAFD;AAGD,KA1BkB;;AAAA,UAsEnBa,cAtEmB,GAsEF,UAAAC,CAAC,EAAI;AACpB,YAAKb,QAAL,CAAc;AACZC,QAAAA,OAAO,EAAEY,CAAC,CAACC,MAAF,CAASC,OAAT;AADG,OAAd;AAGD,KA1EkB;;AAGjB,UAAKP,KAAL,GAAa;AACXP,MAAAA,OAAO,EAAEH,KAAK,CAACG,OAAN,IAAiB;AADf,KAAb;AAHiB;AAMlB;;;;mCAsBc;AAAA,yBACkC,KAAKH,KADvC;AAAA,UACLkB,eADK,gBACLA,eADK;AAAA,UACYf,OADZ,gBACYA,OADZ;AAAA,UACqBQ,QADrB,gBACqBA,QADrB;;AAGb,UAAI,CAAC,KAAKD,KAAL,CAAWP,OAAhB,EAAyB;AACvB,eAAO,IAAP;AACD;;AAED,aACE,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGA,OAAO,IACN,oBAAC,MAAD;AACE,QAAA,IAAI,EAAC,UADP;AAEE,QAAA,QAAQ,EAAC,QAFX;AAGE,QAAA,IAAI,EAAC,OAHP;AAIE,QAAA,OAAO,EAAEQ,QAJX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAFJ,EAWE,oBAAC,MAAD;AACE,QAAA,OAAO,EAAE,KAAKV,YADhB;AAEE,QAAA,QAAQ,EAAC,SAFX;AAGE,QAAA,IAAI,EAAC,OAHP;AAIE,QAAA,IAAI,EAAC,UAJP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAXF,EAoBE,oBAAC,MAAD;AACE,QAAA,QAAQ,EAAEiB,eADZ;AAEE,QAAA,OAAO,EAAE,KAAKT,MAFhB;AAGE,QAAA,QAAQ,EAAC,SAHX;AAIE,QAAA,IAAI,EAAC,OAJP;AAKE,QAAA,IAAI,EAAES,eAAe,GAAGC,SAAH,GAAe,SALtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAOGD,eAAe,IAAI,oBAAC,WAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAPtB,SApBF,CADF;AAiCD;;;6BAQQ;AAAA,yBACgC,KAAKlB,KADrC;AAAA,UACCI,WADD,gBACCA,WADD;AAAA,UACcC,aADd,gBACcA,aADd;AAGP,aACE,oBAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,QAAD;AACE,QAAA,WAAW,EAAE,KAAKI,MADpB;AAEE,QAAA,YAAY,EAAE,IAFhB;AAGE,QAAA,OAAO,EAAE,KAAKC,KAAL,CAAWP,OAHtB;AAIE,QAAA,QAAQ,EAAE,KAAKW,cAJjB;AAKE,QAAA,MAAM,EAAE,GALV;AAME,QAAA,IAAI,YAAKV,WAAL,mBAAyBC,aAAzB,CANN;AAOE,QAAA,OAAO,EAAE,CACP;AACEe,UAAAA,IAAI,EAAE,aADR;AAEEC,UAAAA,KAAK,EAAE,CACL,MADK,EAEL,QAFK,EAGL,cAHK,EAIL,cAJK,EAKL,MALK,EAML,QANK,EAOL,GAPK,EAQL,OARK,EASL,YATK;AAFT,SADO,CAPX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,EA0BG,KAAKC,YAAL,EA1BH,CADF;AA8BD;;;;EA9GgB5B,KAAK,CAAC6B,a;;AAiHzB,eAAexB,IAAf","sourcesContent":["import Button from 'erxes-common-ui/lib/components/button';\nimport { SmallLoader } from 'modules/common/components/ButtonMutate';\nimport { getMentionedUserIds } from 'modules/common/components/EditorCK';\nimport EditorCK from 'modules/common/containers/EditorCK';\nimport React from 'react';\nimport styled from 'styled-components';\n\nexport const EditorActions = styled.div`\n  padding: 0px 15px 37px 15px;\n  text-align: right;\n`;\n\nexport const EditorWrapper = styled.div`\n  position: relative;\n\n  > .cke_chrome {\n    border-bottom: 0;\n    border-left: 0;\n    border-right: 0;\n  }\n\n  .cke_bottom {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    left: 0;\n  }\n\n  .cke_toolgroup {\n    border: 0;\n    margin-left: 3px;\n  }\n`;\n\ntype Prop = {\n  save: (variables, callback: () => void) => void;\n  isActionLoading: boolean;\n  content?: string;\n  callback?: () => void;\n  contentType: string;\n  contentTypeId: string;\n};\n\ntype State = {\n  content: string;\n};\n\nclass Form extends React.PureComponent<Prop, State> {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      content: props.content || ''\n    };\n  }\n\n  clearContent = () => {\n    this.setState({ content: '' });\n\n    const { contentType, contentTypeId } = this.props;\n    const editorName = `${contentType}_note_${contentTypeId}`;\n\n    localStorage.removeItem(editorName);\n  };\n\n  onSend = () => {\n    const { content } = this.state;\n    const { callback } = this.props;\n\n    const mentionedUserIds = getMentionedUserIds(content);\n\n    this.props.save({ content, mentionedUserIds }, () => {\n      callback ? callback() : this.clearContent();\n    });\n  };\n\n  renderFooter() {\n    const { isActionLoading, content, callback } = this.props;\n\n    if (!this.state.content) {\n      return null;\n    }\n\n    return (\n      <EditorActions>\n        {content && (\n          <Button\n            icon=\"cancel-1\"\n            btnStyle=\"simple\"\n            size=\"small\"\n            onClick={callback}\n          >\n            Cancel\n          </Button>\n        )}\n        <Button\n          onClick={this.clearContent}\n          btnStyle=\"warning\"\n          size=\"small\"\n          icon=\"eraser-1\"\n        >\n          Discard\n        </Button>\n\n        <Button\n          disabled={isActionLoading}\n          onClick={this.onSend}\n          btnStyle=\"success\"\n          size=\"small\"\n          icon={isActionLoading ? undefined : 'message'}\n        >\n          {isActionLoading && <SmallLoader />}\n          Save\n        </Button>\n      </EditorActions>\n    );\n  }\n\n  onEditorChange = e => {\n    this.setState({\n      content: e.editor.getData()\n    });\n  };\n\n  render() {\n    const { contentType, contentTypeId } = this.props;\n\n    return (\n      <EditorWrapper>\n        <EditorCK\n          onCtrlEnter={this.onSend}\n          showMentions={true}\n          content={this.state.content}\n          onChange={this.onEditorChange}\n          height={150}\n          name={`${contentType}_note_${contentTypeId}`}\n          toolbar={[\n            {\n              name: 'basicstyles',\n              items: [\n                'Bold',\n                'Italic',\n                'NumberedList',\n                'BulletedList',\n                'Link',\n                'Unlink',\n                '-',\n                'Image',\n                'EmojiPanel'\n              ]\n            }\n          ]}\n        />\n\n        {this.renderFooter()}\n      </EditorWrapper>\n    );\n  }\n}\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}