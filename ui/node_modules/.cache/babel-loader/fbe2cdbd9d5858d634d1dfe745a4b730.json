{"ast":null,"code":"import _objectSpread from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _defineProperty from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/growthHacks/components/GrowthHackEditForm.tsx\";\nimport DueDateChanger from 'modules/boards/components/DueDateChanger';\nimport EditForm from 'modules/boards/components/editForm/EditForm';\nimport { FlexContent, LeftContainer } from 'modules/boards/styles/item';\nimport React from 'react';\nimport { Left, StageForm, Top } from './editForm/';\nimport Actions from './editForm/Actions';\nimport Score from './Score';\nvar reactiveFields = ['priority', 'hackStages', 'labels'];\n\nvar GrowthHackEditForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(GrowthHackEditForm, _React$Component);\n\n  function GrowthHackEditForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, GrowthHackEditForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(GrowthHackEditForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.onChangeExtraField = function (name, value) {\n      _this.setState(_defineProperty({}, name, value), function () {\n        if (reactiveFields.includes(name)) {\n          _this.props.saveItem(_defineProperty({}, name, value), function (updatedItem) {\n            _this.props.onUpdate(updatedItem);\n          });\n        }\n      });\n    };\n\n    _this.renderDueDate = function (closeDate, onDateChange) {\n      if (!closeDate) {\n        return null;\n      }\n\n      return React.createElement(DueDateChanger, {\n        isWarned: true,\n        value: closeDate,\n        onChange: onDateChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      });\n    };\n\n    _this.renderScore = function () {\n      var _this$props = _this.props,\n          saveItem = _this$props.saveItem,\n          item = _this$props.item;\n\n      var onChange = function onChange(e) {\n        var value = Number(e.target.value);\n        var confirmedValue = value > 10 ? 10 : value;\n\n        var changedValue = _defineProperty({}, e.target.name, confirmedValue);\n\n        _this.setState(changedValue);\n\n        saveItem(changedValue, function (updatedItem) {\n          _this.props.onUpdate(updatedItem);\n        });\n      };\n\n      return React.createElement(Score, {\n        reach: item.reach || 0,\n        impact: item.impact || 0,\n        confidence: item.confidence || 0,\n        ease: item.ease || 0,\n        onChange: onChange,\n        scoringType: item.scoringType || 'ice',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      });\n    };\n\n    _this.renderFormContent = function (_ref) {\n      var copy = _ref.copy,\n          remove = _ref.remove,\n          saveItem = _ref.saveItem,\n          onChangeStage = _ref.onChangeStage;\n      var _this$props2 = _this.props,\n          item = _this$props2.item,\n          options = _this$props2.options,\n          saveFormSubmission = _this$props2.saveFormSubmission,\n          onUpdate = _this$props2.onUpdate,\n          addItem = _this$props2.addItem,\n          sendToBoard = _this$props2.sendToBoard;\n\n      var dateOnChange = function dateOnChange(date) {\n        return saveItem({\n          closeDate: date\n        });\n      };\n\n      return React.createElement(React.Fragment, null, React.createElement(Top, {\n        options: options,\n        item: item,\n        saveItem: saveItem,\n        dueDate: _this.renderDueDate(item.closeDate, dateOnChange),\n        score: _this.renderScore,\n        onChangeStage: onChangeStage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108\n        },\n        __self: this\n      }), React.createElement(FlexContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(LeftContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(Actions, {\n        onChangeField: _this.onChangeExtraField,\n        dateOnChange: dateOnChange,\n        item: item,\n        options: options,\n        copy: copy,\n        removeItem: remove,\n        onUpdate: onUpdate,\n        sendToBoard: sendToBoard,\n        saveItem: saveItem,\n        onChangeStage: onChangeStage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }), React.createElement(Left, {\n        type: options.type,\n        item: item,\n        saveItem: saveItem,\n        options: options,\n        addItem: addItem,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      })), React.createElement(StageForm, {\n        item: item,\n        onChangeExtraField: _this.onChangeExtraField,\n        save: saveFormSubmission,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      })));\n    };\n\n    return _this;\n  }\n\n  _createClass(GrowthHackEditForm, [{\n    key: \"render\",\n    value: function render() {\n      var extendedProps = _objectSpread({}, this.props, {\n        formContent: this.renderFormContent,\n        extraFields: this.state\n      });\n\n      return React.createElement(EditForm, Object.assign({}, extendedProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return GrowthHackEditForm;\n}(React.Component);\n\nexport { GrowthHackEditForm as default };","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/growthHacks/components/GrowthHackEditForm.tsx"],"names":["DueDateChanger","EditForm","FlexContent","LeftContainer","React","Left","StageForm","Top","Actions","Score","reactiveFields","GrowthHackEditForm","onChangeExtraField","name","value","setState","includes","props","saveItem","updatedItem","onUpdate","renderDueDate","closeDate","onDateChange","renderScore","item","onChange","e","Number","target","confirmedValue","changedValue","reach","impact","confidence","ease","scoringType","renderFormContent","copy","remove","onChangeStage","options","saveFormSubmission","addItem","sendToBoard","dateOnChange","date","type","extendedProps","formContent","extraFields","state","Component"],"mappings":"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","sourcesContent":["import { IUser } from 'modules/auth/types';\nimport DueDateChanger from 'modules/boards/components/DueDateChanger';\nimport EditForm from 'modules/boards/components/editForm/EditForm';\nimport { FlexContent, LeftContainer } from 'modules/boards/styles/item';\nimport { IEditFormContent, IOptions } from 'modules/boards/types';\nimport { IFormSubmission } from 'modules/forms/types';\nimport React from 'react';\nimport { GrowthHackFieldName, IGrowthHack, IGrowthHackParams } from '../types';\nimport { Left, StageForm, Top } from './editForm/';\nimport Actions from './editForm/Actions';\nimport Score from './Score';\n\nconst reactiveFields = ['priority', 'hackStages', 'labels'];\n\ntype Props = {\n  options: IOptions;\n  item: IGrowthHack;\n  users: IUser[];\n  addItem: (doc: IGrowthHackParams, callback: () => void) => void;\n  copyItem: (itemId: string, callback: () => void) => void;\n  saveFormSubmission: (doc: IFormSubmission) => void;\n  saveItem: (doc: IGrowthHackParams, callback?: (item) => void) => void;\n  onUpdate: (item, prevStageId?: string) => void;\n  removeItem: (itemId: string, callback: () => void) => void;\n  beforePopupClose: () => void;\n  sendToBoard?: (item: any) => void;\n};\n\nexport default class GrowthHackEditForm extends React.Component<Props> {\n  onChangeExtraField = <T extends keyof IGrowthHack>(\n    name: T,\n    value: IGrowthHack[GrowthHackFieldName]\n  ) => {\n    this.setState(\n      { [name]: value } as Pick<IGrowthHack, keyof IGrowthHack>,\n      () => {\n        if (reactiveFields.includes(name)) {\n          this.props.saveItem({ [name]: value }, updatedItem => {\n            this.props.onUpdate(updatedItem);\n          });\n        }\n      }\n    );\n  };\n\n  renderDueDate = (closeDate, onDateChange: (date) => void) => {\n    if (!closeDate) {\n      return null;\n    }\n\n    return (\n      <DueDateChanger\n        isWarned={true}\n        value={closeDate}\n        onChange={onDateChange}\n      />\n    );\n  };\n\n  renderScore = () => {\n    const { saveItem, item } = this.props;\n\n    const onChange = e => {\n      const value = Number((e.target as HTMLInputElement).value);\n\n      const confirmedValue = value > 10 ? 10 : value;\n\n      const changedValue = { [e.target.name]: confirmedValue };\n\n      this.setState(changedValue as Pick<IGrowthHack, keyof IGrowthHack>);\n\n      saveItem(changedValue, updatedItem => {\n        this.props.onUpdate(updatedItem);\n      });\n    };\n\n    return (\n      <Score\n        reach={item.reach || 0}\n        impact={item.impact || 0}\n        confidence={item.confidence || 0}\n        ease={item.ease || 0}\n        onChange={onChange}\n        scoringType={item.scoringType || 'ice'}\n      />\n    );\n  };\n\n  renderFormContent = ({\n    copy,\n    remove,\n    saveItem,\n    onChangeStage\n  }: IEditFormContent) => {\n    const {\n      item,\n      options,\n      saveFormSubmission,\n      onUpdate,\n      addItem,\n      sendToBoard\n    } = this.props;\n\n    const dateOnChange = date => saveItem({ closeDate: date });\n\n    return (\n      <>\n        <Top\n          options={options}\n          item={item}\n          saveItem={saveItem}\n          dueDate={this.renderDueDate(item.closeDate, dateOnChange)}\n          score={this.renderScore}\n          onChangeStage={onChangeStage}\n        />\n\n        <FlexContent>\n          <LeftContainer>\n            <Actions\n              onChangeField={this.onChangeExtraField}\n              dateOnChange={dateOnChange}\n              item={item}\n              options={options}\n              copy={copy}\n              removeItem={remove}\n              onUpdate={onUpdate}\n              sendToBoard={sendToBoard}\n              saveItem={saveItem}\n              onChangeStage={onChangeStage}\n            />\n            <Left\n              type={options.type}\n              item={item}\n              saveItem={saveItem}\n              options={options}\n              addItem={addItem}\n            />\n          </LeftContainer>\n\n          <StageForm\n            item={item}\n            onChangeExtraField={this.onChangeExtraField}\n            save={saveFormSubmission}\n          />\n        </FlexContent>\n      </>\n    );\n  };\n\n  render() {\n    const extendedProps = {\n      ...this.props,\n      formContent: this.renderFormContent,\n      extraFields: this.state\n    };\n\n    return <EditForm {...extendedProps} />;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}