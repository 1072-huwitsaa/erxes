{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/settings/growthHacks/components/Stages.tsx\";\nimport Icon from 'erxes-common-ui/lib/components/icon';\nimport SortableList from 'modules/common/components/SortableList';\nimport { __ } from 'modules/common/utils';\nimport { StageList } from 'modules/settings/boards/styles';\nimport FormBuilder from 'modules/settings/growthHacks/components/FormBuilder';\nimport { LinkButton } from 'modules/settings/team/styles';\nimport React from 'react';\nimport StageItem from './StageItem';\n\nvar Stages =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Stages, _React$Component);\n\n  function Stages(props) {\n    var _this;\n\n    _classCallCheck(this, Stages);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Stages).call(this, props));\n\n    _this.onChange = function (stageId, name, value) {\n      var _this$props = _this.props,\n          stages = _this$props.stages,\n          onChangeStages = _this$props.onChangeStages;\n      var stage = stages.find(function (s) {\n        return s._id === stageId;\n      });\n      stage[name] = value;\n      onChangeStages(stages);\n    };\n\n    _this.add = function () {\n      var _this$props2 = _this.props,\n          stages = _this$props2.stages,\n          onChangeStages = _this$props2.onChangeStages;\n      stages.push({\n        _id: Math.random().toString(),\n        name: ''\n      });\n      onChangeStages(stages);\n    };\n\n    _this.remove = function (stageId) {\n      var _this$props3 = _this.props,\n          stages = _this$props3.stages,\n          onChangeStages = _this$props3.onChangeStages;\n      var remainedStages = stages.filter(function (stage) {\n        return stage._id !== stageId;\n      });\n      onChangeStages(remainedStages);\n    };\n\n    _this.onStageInputKeyPress = function (e) {\n      if (e.key === 'Enter') {\n        _this.add();\n\n        e.preventDefault();\n      }\n    };\n\n    _this.onItemClick = function (stage) {\n      _this.setState({\n        isDragDisabled: true,\n        currentStage: stage\n      });\n    };\n\n    _this.onItemModalHide = function () {\n      _this.setState({\n        isDragDisabled: false,\n        currentStage: undefined\n      });\n    };\n\n    _this.state = {\n      isDragDisabled: false,\n      currentStage: undefined\n    };\n    return _this;\n  }\n\n  _createClass(Stages, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.stages.length === 0) {\n        this.add();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          isDragDisabled = _this$state.isDragDisabled,\n          currentStage = _this$state.currentStage;\n\n      var child = function child(stage) {\n        return React.createElement(StageItem, {\n          stage: stage,\n          onChange: _this2.onChange,\n          onClick: _this2.onItemClick,\n          remove: _this2.remove,\n          onKeyPress: _this2.onStageInputKeyPress,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79\n          },\n          __self: this\n        });\n      };\n\n      return React.createElement(StageList, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(SortableList, {\n        fields: this.props.stages,\n        child: child,\n        onChangeFields: this.props.onChangeStages,\n        isModal: true,\n        isDragDisabled: isDragDisabled,\n        droppableId: \"stages\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }), React.createElement(LinkButton, {\n        onClick: this.add,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        icon: \"plus-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }), \" \", __('Add another stage')), currentStage && React.createElement(FormBuilder, {\n        stage: currentStage,\n        onHide: this.onItemModalHide,\n        onChange: this.onChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Stages;\n}(React.Component);\n\nexport default Stages;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/settings/growthHacks/components/Stages.tsx"],"names":["Icon","SortableList","__","StageList","FormBuilder","LinkButton","React","StageItem","Stages","props","onChange","stageId","name","value","stages","onChangeStages","stage","find","s","_id","add","push","Math","random","toString","remove","remainedStages","filter","onStageInputKeyPress","e","key","preventDefault","onItemClick","setState","isDragDisabled","currentStage","onItemModalHide","undefined","state","length","child","Component"],"mappings":"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","sourcesContent":["import { IStage } from 'modules/boards/types';\nimport Icon from 'erxes-common-ui/lib/components/icon';\nimport SortableList from 'modules/common/components/SortableList';\nimport { __ } from 'modules/common/utils';\nimport { StageList } from 'modules/settings/boards/styles';\nimport FormBuilder from 'modules/settings/growthHacks/components/FormBuilder';\nimport { LinkButton } from 'modules/settings/team/styles';\nimport React from 'react';\nimport StageItem from './StageItem';\n\ntype Props = {\n  onChangeStages: (stages: IStage[]) => void;\n  stages: any;\n};\n\nclass Stages extends React.Component<\n  Props,\n  { isDragDisabled: boolean; currentStage?: IStage }\n> {\n  constructor(props: Props) {\n    super(props);\n\n    this.state = { isDragDisabled: false, currentStage: undefined };\n  }\n\n  componentDidMount() {\n    if (this.props.stages.length === 0) {\n      this.add();\n    }\n  }\n\n  onChange = (stageId: string, name: string, value: string) => {\n    const { stages, onChangeStages } = this.props;\n\n    const stage = stages.find(s => s._id === stageId);\n    stage[name] = value;\n\n    onChangeStages(stages);\n  };\n\n  add = () => {\n    const { stages, onChangeStages } = this.props;\n\n    stages.push({\n      _id: Math.random().toString(),\n      name: ''\n    });\n\n    onChangeStages(stages);\n  };\n\n  remove = stageId => {\n    const { stages, onChangeStages } = this.props;\n\n    const remainedStages = stages.filter(stage => stage._id !== stageId);\n\n    onChangeStages(remainedStages);\n  };\n\n  onStageInputKeyPress = e => {\n    if (e.key === 'Enter') {\n      this.add();\n      e.preventDefault();\n    }\n  };\n\n  onItemClick = (stage: IStage) => {\n    this.setState({ isDragDisabled: true, currentStage: stage });\n  };\n\n  onItemModalHide = () => {\n    this.setState({ isDragDisabled: false, currentStage: undefined });\n  };\n\n  render() {\n    const { isDragDisabled, currentStage } = this.state;\n\n    const child = stage => (\n      <StageItem\n        stage={stage}\n        onChange={this.onChange}\n        onClick={this.onItemClick}\n        remove={this.remove}\n        onKeyPress={this.onStageInputKeyPress}\n      />\n    );\n\n    return (\n      <StageList>\n        <SortableList\n          fields={this.props.stages}\n          child={child}\n          onChangeFields={this.props.onChangeStages}\n          isModal={true}\n          isDragDisabled={isDragDisabled}\n          droppableId=\"stages\"\n        />\n\n        <LinkButton onClick={this.add}>\n          <Icon icon=\"plus-1\" /> {__('Add another stage')}\n        </LinkButton>\n\n        {currentStage && (\n          <FormBuilder\n            stage={currentStage}\n            onHide={this.onItemModalHide}\n            onChange={this.onChange}\n          />\n        )}\n      </StageList>\n    );\n  }\n}\n\nexport default Stages;\n"]},"metadata":{},"sourceType":"module"}