{"ast":null,"code":"import _defineProperty from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/boards/components/portable/AddForm.tsx\";\nimport Button from \"erxes-common-ui/lib/components/button\";\nimport FormControl from \"modules/common/components/form/Control\";\nimport ControlLabel from \"modules/common/components/form/Label\";\nimport { Alert } from \"modules/common/utils\";\nimport React from \"react\";\nimport BoardSelect from \"../../containers/BoardSelect\";\nimport { FormFooter, HeaderContent, HeaderRow } from \"../../styles/item\";\nimport { invalidateCache } from \"../../utils\";\n\nvar AddForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AddForm, _React$Component);\n\n  function AddForm(props) {\n    var _this;\n\n    _classCallCheck(this, AddForm);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddForm).call(this, props));\n\n    _this.onChangeField = function (name, value) {\n      _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.save = function (e) {\n      e.preventDefault();\n      var _this$state = _this.state,\n          stageId = _this$state.stageId,\n          name = _this$state.name;\n      var _this$props = _this.props,\n          saveItem = _this$props.saveItem,\n          closeModal = _this$props.closeModal,\n          callback = _this$props.callback;\n\n      if (!stageId) {\n        return Alert.error(\"No stage\");\n      }\n\n      if (!name) {\n        return Alert.error(\"Enter name\");\n      }\n\n      var doc = {\n        name: name,\n        stageId: stageId\n      }; // before save, disable save button\n\n      _this.setState({\n        disabled: true\n      });\n\n      saveItem(doc, function (item) {\n        // after save, enable save button\n        _this.setState({\n          disabled: false\n        });\n\n        localStorage.removeItem(\"\".concat(_this.props.options.type, \"Name\"));\n        closeModal();\n\n        if (callback) {\n          callback(item);\n        }\n\n        invalidateCache();\n      });\n    };\n\n    _this.onChangeName = function (e) {\n      var name = e.target.value;\n\n      _this.onChangeField(\"name\", name);\n\n      localStorage.setItem(\"\".concat(_this.props.options.type, \"Name\"), name);\n    };\n\n    _this.state = {\n      disabled: false,\n      boardId: props.boardId || \"\",\n      pipelineId: props.pipelineId || \"\",\n      stageId: props.stageId || \"\",\n      name: localStorage.getItem(\"\".concat(props.options.type, \"Name\")) || \"\"\n    };\n    return _this;\n  }\n\n  _createClass(AddForm, [{\n    key: \"renderSelect\",\n    value: function renderSelect() {\n      var _this2 = this;\n\n      var _this$props2 = this.props,\n          showSelect = _this$props2.showSelect,\n          options = _this$props2.options;\n\n      if (!showSelect) {\n        return null;\n      }\n\n      var _this$state2 = this.state,\n          stageId = _this$state2.stageId,\n          pipelineId = _this$state2.pipelineId,\n          boardId = _this$state2.boardId;\n\n      var stgIdOnChange = function stgIdOnChange(stgId) {\n        return _this2.onChangeField(\"stageId\", stgId);\n      };\n\n      var plIdOnChange = function plIdOnChange(plId) {\n        return _this2.onChangeField(\"pipelineId\", plId);\n      };\n\n      var brIdOnChange = function brIdOnChange(brId) {\n        return _this2.onChangeField(\"boardId\", brId);\n      };\n\n      return React.createElement(BoardSelect, {\n        type: options.type,\n        stageId: stageId,\n        pipelineId: pipelineId,\n        boardId: boardId,\n        onChangeStage: stgIdOnChange,\n        onChangePipeline: plIdOnChange,\n        onChangeBoard: brIdOnChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"form\", {\n        onSubmit: this.save,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, this.renderSelect(), React.createElement(HeaderRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(HeaderContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(ControlLabel, {\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, \"Name\"), React.createElement(FormControl, {\n        value: this.state.name,\n        autoFocus: true,\n        onChange: this.onChangeName,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }))), React.createElement(FormFooter, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(Button, {\n        btnStyle: \"simple\",\n        onClick: this.props.closeModal,\n        icon: \"times-circle\",\n        uppercase: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"Close\"), React.createElement(Button, {\n        disabled: this.state.disabled,\n        btnStyle: \"success\",\n        icon: \"check-circle\",\n        type: \"submit\",\n        uppercase: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, \"Save\")));\n    }\n  }]);\n\n  return AddForm;\n}(React.Component);\n\nexport default AddForm;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/boards/components/portable/AddForm.tsx"],"names":["Button","FormControl","ControlLabel","Alert","React","BoardSelect","FormFooter","HeaderContent","HeaderRow","invalidateCache","AddForm","props","onChangeField","name","value","setState","save","e","preventDefault","state","stageId","saveItem","closeModal","callback","error","doc","disabled","item","localStorage","removeItem","options","type","onChangeName","target","setItem","boardId","pipelineId","getItem","showSelect","stgIdOnChange","stgId","plIdOnChange","plId","brIdOnChange","brId","renderSelect","Component"],"mappings":"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","sourcesContent":["import Button from \"erxes-common-ui/lib/components/button\";\nimport FormControl from \"modules/common/components/form/Control\";\nimport ControlLabel from \"modules/common/components/form/Label\";\nimport { Alert } from \"modules/common/utils\";\nimport React from \"react\";\nimport BoardSelect from \"../../containers/BoardSelect\";\nimport { FormFooter, HeaderContent, HeaderRow } from \"../../styles/item\";\nimport { IItem, IItemParams, IOptions } from \"../../types\";\nimport { invalidateCache } from \"../../utils\";\n\ntype Props = {\n  options: IOptions;\n  boardId?: string;\n  pipelineId?: string;\n  stageId?: string;\n  saveItem: (doc: IItemParams, callback: (item: IItem) => void) => void;\n  showSelect?: boolean;\n  closeModal: () => void;\n  callback?: (item?: IItem) => void;\n};\n\ntype State = {\n  stageId: string;\n  name: string;\n  disabled: boolean;\n  boardId: string;\n  pipelineId: string;\n};\n\nclass AddForm extends React.Component<Props, State> {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      disabled: false,\n      boardId: props.boardId || \"\",\n      pipelineId: props.pipelineId || \"\",\n      stageId: props.stageId || \"\",\n      name: localStorage.getItem(`${props.options.type}Name`) || \"\",\n    };\n  }\n\n  onChangeField = <T extends keyof State>(name: T, value: State[T]) => {\n    this.setState(({ [name]: value } as unknown) as Pick<State, keyof State>);\n  };\n\n  save = (e) => {\n    e.preventDefault();\n\n    const { stageId, name } = this.state;\n    const { saveItem, closeModal, callback } = this.props;\n\n    if (!stageId) {\n      return Alert.error(\"No stage\");\n    }\n\n    if (!name) {\n      return Alert.error(\"Enter name\");\n    }\n\n    const doc = {\n      name,\n      stageId,\n    };\n\n    // before save, disable save button\n    this.setState({ disabled: true });\n\n    saveItem(doc, (item: IItem) => {\n      // after save, enable save button\n      this.setState({ disabled: false });\n\n      localStorage.removeItem(`${this.props.options.type}Name`);\n\n      closeModal();\n\n      if (callback) {\n        callback(item);\n      }\n\n      invalidateCache();\n    });\n  };\n\n  renderSelect() {\n    const { showSelect, options } = this.props;\n\n    if (!showSelect) {\n      return null;\n    }\n\n    const { stageId, pipelineId, boardId } = this.state;\n\n    const stgIdOnChange = (stgId) => this.onChangeField(\"stageId\", stgId);\n    const plIdOnChange = (plId) => this.onChangeField(\"pipelineId\", plId);\n    const brIdOnChange = (brId) => this.onChangeField(\"boardId\", brId);\n\n    return (\n      <BoardSelect\n        type={options.type}\n        stageId={stageId}\n        pipelineId={pipelineId}\n        boardId={boardId}\n        onChangeStage={stgIdOnChange}\n        onChangePipeline={plIdOnChange}\n        onChangeBoard={brIdOnChange}\n      />\n    );\n  }\n\n  onChangeName = (e) => {\n    const name = (e.target as HTMLInputElement).value;\n\n    this.onChangeField(\"name\", name);\n\n    localStorage.setItem(`${this.props.options.type}Name`, name);\n  };\n\n  render() {\n    return (\n      <form onSubmit={this.save}>\n        {this.renderSelect()}\n\n        <HeaderRow>\n          <HeaderContent>\n            <ControlLabel required={true}>Name</ControlLabel>\n            <FormControl\n              value={this.state.name}\n              autoFocus={true}\n              onChange={this.onChangeName}\n            />\n          </HeaderContent>\n        </HeaderRow>\n\n        <FormFooter>\n          <Button\n            btnStyle=\"simple\"\n            onClick={this.props.closeModal}\n            icon=\"times-circle\"\n            uppercase={false}\n          >\n            Close\n          </Button>\n\n          <Button\n            disabled={this.state.disabled}\n            btnStyle=\"success\"\n            icon=\"check-circle\"\n            type=\"submit\"\n            uppercase={false}\n          >\n            Save\n          </Button>\n        </FormFooter>\n      </form>\n    );\n  }\n}\n\nexport default AddForm;\n"]},"metadata":{},"sourceType":"module"}