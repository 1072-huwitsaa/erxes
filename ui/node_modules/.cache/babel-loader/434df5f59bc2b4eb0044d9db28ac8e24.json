{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/boards/components/stage/Item.tsx\";\nimport routerUtils from 'modules/common/utils/router';\nimport queryString from 'query-string';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\n\nvar Item =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Item, _React$PureComponent);\n\n  function Item(props) {\n    var _this;\n\n    _classCallCheck(this, Item);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Item).call(this, props));\n    _this.unlisten = void 0;\n\n    _this.beforePopupClose = function (afterPopupClose) {\n      var _this$props = _this.props,\n          beforePopupClose = _this$props.beforePopupClose,\n          history = _this$props.history;\n\n      _this.setState({\n        isFormVisible: false\n      }, function () {\n        var itemIdQueryParam = routerUtils.getParam(history, 'itemId');\n\n        if (itemIdQueryParam) {\n          routerUtils.removeParams(history, 'itemId');\n        }\n\n        if (beforePopupClose) {\n          beforePopupClose();\n        }\n\n        if (afterPopupClose) {\n          afterPopupClose();\n        }\n      });\n    };\n\n    var item = props.item,\n        _history = props.history;\n\n    var _itemIdQueryParam = routerUtils.getParam(_history, 'itemId');\n\n    var isFormVisible = false;\n\n    if (_itemIdQueryParam === item._id) {\n      isFormVisible = true;\n    }\n\n    _this.state = {\n      isFormVisible: isFormVisible\n    };\n    return _this;\n  }\n\n  _createClass(Item, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.unlisten = this.props.history.listen(function (location) {\n        var queryParams = queryString.parse(location.search);\n\n        if (queryParams.itemId === _this2.props.item._id) {\n          return _this2.setState({\n            isFormVisible: true\n          });\n        }\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.unlisten) {\n        this.unlisten();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var options = this.props.options;\n      var ItemComponent = options.Item;\n      return React.createElement(ItemComponent, Object.assign({}, this.props, {\n        beforePopupClose: this.beforePopupClose,\n        isFormVisible: this.state.isFormVisible,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Item;\n}(React.PureComponent);\n\nexport default withRouter(Item);","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/boards/components/stage/Item.tsx"],"names":["routerUtils","queryString","React","withRouter","Item","props","unlisten","beforePopupClose","afterPopupClose","history","setState","isFormVisible","itemIdQueryParam","getParam","removeParams","item","_id","state","listen","location","queryParams","parse","search","itemId","options","ItemComponent","PureComponent"],"mappings":";;;;;;AAEA,OAAOA,WAAP,MAAwB,6BAAxB;AAGA,OAAOC,WAAP,MAAwB,cAAxB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,UAAT,QAA2B,kBAA3B;;IAUMC,I;;;;;AAGJ,gBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,8EAAMA,KAAN;AADiB,UAFnBC,QAEmB;;AAAA,UAkCnBC,gBAlCmB,GAkCA,UAACC,eAAD,EAAkC;AAAA,wBACb,MAAKH,KADQ;AAAA,UAC3CE,gBAD2C,eAC3CA,gBAD2C;AAAA,UACzBE,OADyB,eACzBA,OADyB;;AAGnD,YAAKC,QAAL,CAAc;AAAEC,QAAAA,aAAa,EAAE;AAAjB,OAAd,EAAwC,YAAM;AAC5C,YAAMC,gBAAgB,GAAGZ,WAAW,CAACa,QAAZ,CAAqBJ,OAArB,EAA8B,QAA9B,CAAzB;;AAEA,YAAIG,gBAAJ,EAAsB;AACpBZ,UAAAA,WAAW,CAACc,YAAZ,CAAyBL,OAAzB,EAAkC,QAAlC;AACD;;AAED,YAAIF,gBAAJ,EAAsB;AACpBA,UAAAA,gBAAgB;AACjB;;AAED,YAAIC,eAAJ,EAAqB;AACnBA,UAAAA,eAAe;AAChB;AACF,OAdD;AAeD,KApDkB;;AAAA,QAGTO,IAHS,GAGSV,KAHT,CAGTU,IAHS;AAAA,QAGHN,QAHG,GAGSJ,KAHT,CAGHI,OAHG;;AAKjB,QAAMG,iBAAgB,GAAGZ,WAAW,CAACa,QAAZ,CAAqBJ,QAArB,EAA8B,QAA9B,CAAzB;;AAEA,QAAIE,aAAa,GAAG,KAApB;;AAEA,QAAIC,iBAAgB,KAAKG,IAAI,CAACC,GAA9B,EAAmC;AACjCL,MAAAA,aAAa,GAAG,IAAhB;AACD;;AAED,UAAKM,KAAL,GAAa;AACXN,MAAAA,aAAa,EAAbA;AADW,KAAb;AAbiB;AAgBlB;;;;wCAEmB;AAAA;;AAClB,WAAKL,QAAL,GAAgB,KAAKD,KAAL,CAAWI,OAAX,CAAmBS,MAAnB,CAA0B,UAAAC,QAAQ,EAAI;AACpD,YAAMC,WAAW,GAAGnB,WAAW,CAACoB,KAAZ,CAAkBF,QAAQ,CAACG,MAA3B,CAApB;;AAEA,YAAIF,WAAW,CAACG,MAAZ,KAAuB,MAAI,CAAClB,KAAL,CAAWU,IAAX,CAAgBC,GAA3C,EAAgD;AAC9C,iBAAO,MAAI,CAACN,QAAL,CAAc;AAAEC,YAAAA,aAAa,EAAE;AAAjB,WAAd,CAAP;AACD;AACF,OANe,CAAhB;AAOD;;;2CAEsB;AACrB,UAAI,KAAKL,QAAT,EAAmB;AACjB,aAAKA,QAAL;AACD;AACF;;;6BAsBQ;AAAA,UACCkB,OADD,GACa,KAAKnB,KADlB,CACCmB,OADD;AAGP,UAAMC,aAAa,GAAGD,OAAO,CAACpB,IAA9B;AAEA,aACE,oBAAC,aAAD,oBACM,KAAKC,KADX;AAEE,QAAA,gBAAgB,EAAE,KAAKE,gBAFzB;AAGE,QAAA,aAAa,EAAE,KAAKU,KAAL,CAAWN,aAH5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SADF;AAOD;;;;EArEgBT,KAAK,CAACwB,a;;AAwEzB,eAAevB,UAAU,CAAQC,IAAR,CAAzB","sourcesContent":["import { IItem, IOptions } from 'modules/boards/types';\nimport { IRouterProps } from 'modules/common/types';\nimport routerUtils from 'modules/common/utils/router';\nimport { IDeal } from 'modules/deals/types';\nimport { ITicket } from 'modules/tickets/types';\nimport queryString from 'query-string';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\n\ntype Props = {\n  stageId?: string;\n  item: IDeal | IItem | ITicket;\n  beforePopupClose?: () => void;\n  onClick?: () => void;\n  options: IOptions;\n} & IRouterProps;\n\nclass Item extends React.PureComponent<Props, { isFormVisible: boolean }> {\n  unlisten?: () => void;\n\n  constructor(props) {\n    super(props);\n\n    const { item, history } = props;\n\n    const itemIdQueryParam = routerUtils.getParam(history, 'itemId');\n\n    let isFormVisible = false;\n\n    if (itemIdQueryParam === item._id) {\n      isFormVisible = true;\n    }\n\n    this.state = {\n      isFormVisible\n    };\n  }\n\n  componentDidMount() {\n    this.unlisten = this.props.history.listen(location => {\n      const queryParams = queryString.parse(location.search);\n\n      if (queryParams.itemId === this.props.item._id) {\n        return this.setState({ isFormVisible: true });\n      }\n    });\n  }\n\n  componentWillUnmount() {\n    if (this.unlisten) {\n      this.unlisten();\n    }\n  }\n\n  beforePopupClose = (afterPopupClose?: () => void) => {\n    const { beforePopupClose, history } = this.props;\n\n    this.setState({ isFormVisible: false }, () => {\n      const itemIdQueryParam = routerUtils.getParam(history, 'itemId');\n\n      if (itemIdQueryParam) {\n        routerUtils.removeParams(history, 'itemId');\n      }\n\n      if (beforePopupClose) {\n        beforePopupClose();\n      }\n\n      if (afterPopupClose) {\n        afterPopupClose();\n      }\n    });\n  };\n\n  render() {\n    const { options } = this.props;\n\n    const ItemComponent = options.Item;\n\n    return (\n      <ItemComponent\n        {...this.props}\n        beforePopupClose={this.beforePopupClose}\n        isFormVisible={this.state.isFormVisible}\n      />\n    );\n  }\n}\n\nexport default withRouter<Props>(Item);\n"]},"metadata":{},"sourceType":"module"}