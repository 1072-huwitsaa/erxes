{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/layout/components/MainLayout.tsx\";\nimport asyncComponent from 'modules/common/components/AsyncComponent';\nimport { bustIframe } from 'modules/common/utils';\nimport { NotifProvider } from 'modules/notifications/context';\nimport Robot from 'modules/robot/containers/Robot';\nimport ImportIndicator from 'modules/settings/importHistory/containers/ImportIndicator';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport Navigation from '../containers/Navigation';\nimport { Layout, MainWrapper } from '../styles';\nimport DetectBrowser from './DetectBrowser';\nvar MainBar = asyncComponent(function () {\n  return import(\n  /* webpackChunkName: \"MainBar\" */\n  'modules/layout/components/MainBar');\n});\n\nvar MainLayout =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(MainLayout, _React$Component);\n\n  function MainLayout() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MainLayout);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MainLayout)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.getLastImport = function () {\n      return localStorage.getItem('erxes_import_data') || '';\n    };\n\n    _this.renderBackgroundProccess = function () {\n      var _this$props = _this.props,\n          isShownIndicator = _this$props.isShownIndicator,\n          closeLoadingBar = _this$props.closeLoadingBar;\n\n      if (isShownIndicator) {\n        return React.createElement(ImportIndicator, {\n          id: _this.getLastImport(),\n          close: closeLoadingBar,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 70\n          },\n          __self: this\n        });\n      }\n\n      return null;\n    };\n\n    return _this;\n  }\n\n  _createClass(MainLayout, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props2 = this.props,\n          history = _this$props2.history,\n          currentUser = _this$props2.currentUser;\n\n      if (history.location.pathname !== '/reset-password' && !currentUser) {\n        history.push('/sign-in');\n      } // if (currentUser && process.env.NODE_ENV === 'production') {\n\n\n      if (currentUser) {\n        // Wootric code\n        window.wootricSettings = {\n          email: currentUser.email,\n          // Required to uniquely identify a user. Email is recommended but this can be any unique identifier.\n          created_at: Math.floor((currentUser.createdAt ? new Date(currentUser.createdAt) : new Date()).getTime() / 1000),\n          account_token: 'NPS-477ee032' // This is your unique account token.\n\n        };\n        var wootricScript = document.createElement('script');\n        wootricScript.src = 'https://cdn.wootric.com/wootric-sdk.js';\n        document.head.appendChild(wootricScript);\n\n        wootricScript.onload = function () {\n          window.wootric('run');\n        };\n      } // end currentUser checking\n      // click-jack attack defense\n\n\n      bustIframe();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props3 = this.props,\n          currentUser = _this$props3.currentUser,\n          children = _this$props3.children,\n          isShownIndicator = _this$props3.isShownIndicator,\n          history = _this$props3.history;\n\n      if (history.location.pathname === '/videoCall') {\n        return children;\n      }\n\n      return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        id: \"anti-clickjack\",\n        style: {\n          display: 'none'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }), this.renderBackgroundProccess(), React.createElement(Layout, {\n        isSqueezed: isShownIndicator,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, currentUser && React.createElement(Navigation, {\n        currentUser: currentUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }), React.createElement(MainWrapper, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, React.createElement(NotifProvider, {\n        currentUser: currentUser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }, React.createElement(MainBar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      })), children), React.createElement(DetectBrowser, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98\n        },\n        __self: this\n      })), React.createElement(Robot, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return MainLayout;\n}(React.Component);\n\nexport default withRouter(MainLayout);","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/layout/components/MainLayout.tsx"],"names":["asyncComponent","bustIframe","NotifProvider","Robot","ImportIndicator","React","withRouter","Navigation","Layout","MainWrapper","DetectBrowser","MainBar","MainLayout","getLastImport","localStorage","getItem","renderBackgroundProccess","props","isShownIndicator","closeLoadingBar","history","currentUser","location","pathname","push","window","wootricSettings","email","created_at","Math","floor","createdAt","Date","getTime","account_token","wootricScript","document","createElement","src","head","appendChild","onload","wootric","children","display","Component"],"mappings":"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","sourcesContent":["import { IUser } from 'modules/auth/types';\nimport asyncComponent from 'modules/common/components/AsyncComponent';\nimport { IRouterProps } from 'modules/common/types';\nimport { bustIframe } from 'modules/common/utils';\nimport { NotifProvider } from 'modules/notifications/context';\nimport Robot from 'modules/robot/containers/Robot';\nimport ImportIndicator from 'modules/settings/importHistory/containers/ImportIndicator';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport Navigation from '../containers/Navigation';\nimport { Layout, MainWrapper } from '../styles';\nimport DetectBrowser from './DetectBrowser';\n\nconst MainBar = asyncComponent(() =>\n  import(/* webpackChunkName: \"MainBar\" */ 'modules/layout/components/MainBar')\n);\n\ninterface IProps extends IRouterProps {\n  currentUser?: IUser;\n  children: React.ReactNode;\n  isShownIndicator: boolean;\n  closeLoadingBar: () => void;\n}\n\nclass MainLayout extends React.Component<IProps> {\n  componentDidMount() {\n    const { history, currentUser } = this.props;\n\n    if (history.location.pathname !== '/reset-password' && !currentUser) {\n      history.push('/sign-in');\n    }\n\n    // if (currentUser && process.env.NODE_ENV === 'production') {\n    if (currentUser) {\n      // Wootric code\n      (window as any).wootricSettings = {\n        email: currentUser.email, // Required to uniquely identify a user. Email is recommended but this can be any unique identifier.\n        created_at: Math.floor(\n          (currentUser.createdAt\n            ? new Date(currentUser.createdAt)\n            : new Date()\n          ).getTime() / 1000\n        ),\n        account_token: 'NPS-477ee032' // This is your unique account token.\n      };\n\n      const wootricScript = document.createElement('script');\n      wootricScript.src = 'https://cdn.wootric.com/wootric-sdk.js';\n\n      document.head.appendChild(wootricScript);\n\n      wootricScript.onload = () => {\n        (window as any).wootric('run');\n      };\n    } // end currentUser checking\n\n    // click-jack attack defense\n    bustIframe();\n  }\n\n  getLastImport = () => {\n    return localStorage.getItem('erxes_import_data') || '';\n  };\n\n  renderBackgroundProccess = () => {\n    const { isShownIndicator, closeLoadingBar } = this.props;\n\n    if (isShownIndicator) {\n      return (\n        <ImportIndicator id={this.getLastImport()} close={closeLoadingBar} />\n      );\n    }\n\n    return null;\n  };\n\n  render() {\n    const { currentUser, children, isShownIndicator, history } = this.props;\n\n    if (history.location.pathname === '/videoCall') {\n      return children;\n    }\n\n    return (\n      <>\n        <div id=\"anti-clickjack\" style={{ display: 'none' }} />\n        {this.renderBackgroundProccess()}\n        <Layout isSqueezed={isShownIndicator}>\n          {currentUser && <Navigation currentUser={currentUser} />}\n\n          <MainWrapper>\n            <NotifProvider currentUser={currentUser}>\n              <MainBar />\n            </NotifProvider>\n\n            {children}\n          </MainWrapper>\n          <DetectBrowser />\n        </Layout>\n        <Robot />\n      </>\n    );\n  }\n}\n\nexport default withRouter<IProps>(MainLayout);\n"]},"metadata":{},"sourceType":"module"}