{"ast":null,"code":"import _defineProperty from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/boards/components/RightMenu.tsx\";\nimport Button from \"erxes-common-ui/lib/components/button\";\nimport Icon from \"erxes-common-ui/lib/components/icon\";\nimport { FormControl } from \"modules/common/components/form\";\nimport { Tabs, TabTitle } from \"modules/common/components/tabs\";\nimport { __ } from \"modules/common/utils\";\nimport SelectTeamMembers from \"modules/settings/team/containers/SelectTeamMembers\";\nimport React from \"react\";\nimport Select from \"react-select-plus\";\nimport RTG from \"react-transition-group\";\nimport { PRIORITIES } from \"../constants\";\nimport { FilterBox, FilterButton, MenuFooter, RightMenuContainer, TabContent } from \"../styles/rightMenu\";\nimport Archive from \"./Archive\";\nimport SelectLabel from \"./label/SelectLabel\";\n\nvar RightMenu =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RightMenu, _React$Component);\n\n  function RightMenu(props) {\n    var _this;\n\n    _classCallCheck(this, RightMenu);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(RightMenu).call(this, props));\n    _this.wrapperRef = void 0;\n\n    _this.handleClickOutside = function (event) {\n      if (_this.wrapperRef && !_this.wrapperRef.contains(event.target) && _this.state.currentTab === \"Filter\") {\n        _this.setState({\n          showMenu: false\n        });\n      }\n    };\n\n    _this.toggleMenu = function () {\n      _this.setState({\n        showMenu: !_this.state.showMenu\n      });\n    };\n\n    _this.onSearch = function (e) {\n      if (e.key === \"Enter\") {\n        var target = e.currentTarget;\n\n        _this.props.onSearch(target.value || \"\");\n      }\n    };\n\n    _this.onChange = function (name, value) {\n      _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.state = {\n      currentTab: \"Filter\",\n      showMenu: false\n    };\n    _this.setWrapperRef = _this.setWrapperRef.bind(_assertThisInitialized(_this));\n    _this.handleClickOutside = _this.handleClickOutside.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(RightMenu, [{\n    key: \"setWrapperRef\",\n    value: function setWrapperRef(node) {\n      this.wrapperRef = node;\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      document.addEventListener(\"click\", this.handleClickOutside, true);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"click\", this.handleClickOutside, true);\n    }\n  }, {\n    key: \"renderDates\",\n    value: function renderDates() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          queryParams = _this$props.queryParams,\n          link = _this$props.link;\n\n      if (link.includes(\"calendar\")) {\n        return null;\n      }\n\n      var onSelect = this.props.onSelect;\n\n      var renderLink = function renderLink(label, name) {\n        var selected = queryParams.closeDateType === name;\n        return React.createElement(FilterButton, {\n          selected: selected,\n          onClick: onSelect.bind(_this2, name, \"closeDateType\"),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, __(label), selected && React.createElement(Icon, {\n          icon: \"check-1\",\n          size: 14,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 112\n          },\n          __self: this\n        }));\n      };\n\n      return React.createElement(React.Fragment, null, renderLink(\"Due to the next day\", \"nextDay\"), renderLink(\"Due in the next week\", \"nextWeek\"), renderLink(\"Due in the next month\", \"nextMonth\"), renderLink(\"Has no close date\", \"noCloseDate\"), renderLink(\"Overdue\", \"overdue\"));\n    }\n  }, {\n    key: \"renderFilter\",\n    value: function renderFilter() {\n      var _this$props2 = this.props,\n          queryParams = _this$props2.queryParams,\n          onSelect = _this$props2.onSelect,\n          extraFilter = _this$props2.extraFilter;\n      var priorityValues = PRIORITIES.map(function (p) {\n        return {\n          label: p,\n          value: p\n        };\n      });\n      var priorities = queryParams ? queryParams.priority : [];\n\n      var onPrioritySelect = function onPrioritySelect(ops) {\n        return onSelect(ops.map(function (option) {\n          return option.value;\n        }), \"priority\");\n      };\n\n      return React.createElement(FilterBox, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(FormControl, {\n        defaultValue: queryParams.search,\n        placeholder: __(\"Search ...\"),\n        onKeyPress: this.onSearch,\n        autoFocus: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }), React.createElement(SelectTeamMembers, {\n        label: \"Filter by created members\",\n        name: \"userIds\",\n        queryParams: queryParams,\n        onSelect: onSelect,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }), React.createElement(Select, {\n        placeholder: \"Filter by priority\",\n        value: priorities,\n        options: priorityValues,\n        name: \"priority\",\n        onChange: onPrioritySelect,\n        multi: true,\n        loadingPlaceholder: __(\"Loading...\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }), React.createElement(SelectTeamMembers, {\n        label: \"Filter by team members\",\n        name: \"assignedUserIds\",\n        queryParams: queryParams,\n        onSelect: onSelect,\n        customOption: {\n          value: \"\",\n          label: \"Assigned to no one\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }), React.createElement(SelectLabel, {\n        queryParams: queryParams,\n        name: \"labelIds\",\n        onSelect: onSelect,\n        filterParams: {\n          pipelineId: queryParams.pipelineId\n        },\n        multi: true,\n        customOption: {\n          value: \"\",\n          label: \"No label chosen\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }), extraFilter, this.renderDates());\n    }\n  }, {\n    key: \"renderTabContent\",\n    value: function renderTabContent() {\n      if (this.state.currentTab === \"Filter\") {\n        var _this$props3 = this.props,\n            isFiltered = _this$props3.isFiltered,\n            clearFilter = _this$props3.clearFilter;\n        return React.createElement(React.Fragment, null, React.createElement(TabContent, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194\n          },\n          __self: this\n        }, this.renderFilter()), isFiltered && React.createElement(MenuFooter, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196\n          },\n          __self: this\n        }, React.createElement(Button, {\n          block: true,\n          btnStyle: \"warning\",\n          uppercase: false,\n          onClick: clearFilter,\n          icon: \"times-circle\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197\n          },\n          __self: this\n        }, __(\"Clear Filter\"))));\n      }\n\n      var _this$props4 = this.props,\n          queryParams = _this$props4.queryParams,\n          options = _this$props4.options;\n      return React.createElement(TabContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 215\n        },\n        __self: this\n      }, React.createElement(Archive, {\n        queryParams: queryParams,\n        options: options,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var tabOnClick = function tabOnClick(name) {\n        _this3.onChange(\"currentTab\", name);\n      };\n\n      var _this$state = this.state,\n          currentTab = _this$state.currentTab,\n          showMenu = _this$state.showMenu;\n      var isFiltered = this.props.isFiltered;\n      return React.createElement(\"div\", {\n        ref: this.setWrapperRef,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 230\n        },\n        __self: this\n      }, isFiltered && React.createElement(Button, {\n        btnStyle: \"warning\",\n        icon: \"times-circle\",\n        uppercase: false,\n        onClick: this.props.clearFilter,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232\n        },\n        __self: this\n      }, __(\"Clear Filter\")), React.createElement(Button, {\n        btnStyle: \"simple\",\n        uppercase: false,\n        icon: \"bars\",\n        onClick: this.toggleMenu,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 241\n        },\n        __self: this\n      }, showMenu ? __(\"Hide Menu\") : __(\"Show Menu\")), React.createElement(RTG.CSSTransition, {\n        in: this.state.showMenu,\n        timeout: 300,\n        classNames: \"slide-in-right\",\n        unmountOnExit: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(RightMenuContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256\n        },\n        __self: this\n      }, React.createElement(Tabs, {\n        full: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }, React.createElement(TabTitle, {\n        className: currentTab === \"Filter\" ? \"active\" : \"\",\n        onClick: tabOnClick.bind(this, \"Filter\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258\n        },\n        __self: this\n      }, __(\"Filter\")), React.createElement(TabTitle, {\n        className: currentTab === \"Archived items\" ? \"active\" : \"\",\n        onClick: tabOnClick.bind(this, \"Archived items\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, __(\"Archived items\"))), this.renderTabContent())));\n    }\n  }]);\n\n  return RightMenu;\n}(React.Component);\n\nexport { RightMenu as default };","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/boards/components/RightMenu.tsx"],"names":["Button","Icon","FormControl","Tabs","TabTitle","__","SelectTeamMembers","React","Select","RTG","PRIORITIES","FilterBox","FilterButton","MenuFooter","RightMenuContainer","TabContent","Archive","SelectLabel","RightMenu","props","wrapperRef","handleClickOutside","event","contains","target","state","currentTab","setState","showMenu","toggleMenu","onSearch","e","key","currentTarget","value","onChange","name","setWrapperRef","bind","node","document","addEventListener","removeEventListener","queryParams","link","includes","onSelect","renderLink","label","selected","closeDateType","extraFilter","priorityValues","map","p","priorities","priority","onPrioritySelect","ops","option","search","pipelineId","renderDates","isFiltered","clearFilter","renderFilter","options","tabOnClick","renderTabContent","Component"],"mappings":"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","sourcesContent":["import Button from \"erxes-common-ui/lib/components/button\";\nimport Icon from \"erxes-common-ui/lib/components/icon\";\nimport { FormControl } from \"modules/common/components/form\";\nimport { Tabs, TabTitle } from \"modules/common/components/tabs\";\nimport { IOption } from \"modules/common/types\";\nimport { __ } from \"modules/common/utils\";\nimport SelectTeamMembers from \"modules/settings/team/containers/SelectTeamMembers\";\nimport React from \"react\";\nimport Select from \"react-select-plus\";\nimport RTG from \"react-transition-group\";\nimport { PRIORITIES } from \"../constants\";\nimport {\n  FilterBox,\n  FilterButton,\n  MenuFooter,\n  RightMenuContainer,\n  TabContent,\n} from \"../styles/rightMenu\";\nimport { IOptions } from \"../types\";\nimport Archive from \"./Archive\";\nimport SelectLabel from \"./label/SelectLabel\";\n\ntype Props = {\n  onSearch: (search: string) => void;\n  onSelect: (values: string[] | string, name: string) => void;\n  queryParams: any;\n  link: string;\n  extraFilter?: React.ReactNode;\n  options: IOptions;\n  isFiltered: boolean;\n  clearFilter: () => void;\n};\n\ntype StringState = {\n  currentTab: string;\n};\n\ntype State = {\n  showMenu: boolean;\n} & StringState;\n\nexport default class RightMenu extends React.Component<Props, State> {\n  private wrapperRef;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentTab: \"Filter\",\n      showMenu: false,\n    };\n\n    this.setWrapperRef = this.setWrapperRef.bind(this);\n    this.handleClickOutside = this.handleClickOutside.bind(this);\n  }\n\n  setWrapperRef(node) {\n    this.wrapperRef = node;\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"click\", this.handleClickOutside, true);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"click\", this.handleClickOutside, true);\n  }\n\n  handleClickOutside = (event) => {\n    if (\n      this.wrapperRef &&\n      !this.wrapperRef.contains(event.target) &&\n      this.state.currentTab === \"Filter\"\n    ) {\n      this.setState({ showMenu: false });\n    }\n  };\n\n  toggleMenu = () => {\n    this.setState({ showMenu: !this.state.showMenu });\n  };\n\n  onSearch = (e: React.KeyboardEvent<Element>) => {\n    if (e.key === \"Enter\") {\n      const target = e.currentTarget as HTMLInputElement;\n      this.props.onSearch(target.value || \"\");\n    }\n  };\n\n  onChange = (name: string, value: string) => {\n    this.setState({ [name]: value } as Pick<StringState, keyof StringState>);\n  };\n\n  renderDates() {\n    const { queryParams, link } = this.props;\n\n    if (link.includes(\"calendar\")) {\n      return null;\n    }\n\n    const { onSelect } = this.props;\n\n    const renderLink = (label: string, name: string) => {\n      const selected = queryParams.closeDateType === name;\n\n      return (\n        <FilterButton\n          selected={selected}\n          onClick={onSelect.bind(this, name, \"closeDateType\")}\n        >\n          {__(label)}\n          {selected && <Icon icon=\"check-1\" size={14} />}\n        </FilterButton>\n      );\n    };\n\n    return (\n      <>\n        {renderLink(\"Due to the next day\", \"nextDay\")}\n        {renderLink(\"Due in the next week\", \"nextWeek\")}\n        {renderLink(\"Due in the next month\", \"nextMonth\")}\n        {renderLink(\"Has no close date\", \"noCloseDate\")}\n        {renderLink(\"Overdue\", \"overdue\")}\n      </>\n    );\n  }\n\n  renderFilter() {\n    const { queryParams, onSelect, extraFilter } = this.props;\n\n    const priorityValues = PRIORITIES.map((p) => ({ label: p, value: p }));\n    const priorities = queryParams ? queryParams.priority : [];\n\n    const onPrioritySelect = (ops: IOption[]) =>\n      onSelect(\n        ops.map((option) => option.value),\n        \"priority\"\n      );\n\n    return (\n      <FilterBox>\n        <FormControl\n          defaultValue={queryParams.search}\n          placeholder={__(\"Search ...\")}\n          onKeyPress={this.onSearch}\n          autoFocus={true}\n        />\n        <SelectTeamMembers\n          label=\"Filter by created members\"\n          name=\"userIds\"\n          queryParams={queryParams}\n          onSelect={onSelect}\n        />\n        <Select\n          placeholder=\"Filter by priority\"\n          value={priorities}\n          options={priorityValues}\n          name=\"priority\"\n          onChange={onPrioritySelect}\n          multi={true}\n          loadingPlaceholder={__(\"Loading...\")}\n        />\n        <SelectTeamMembers\n          label=\"Filter by team members\"\n          name=\"assignedUserIds\"\n          queryParams={queryParams}\n          onSelect={onSelect}\n          customOption={{\n            value: \"\",\n            label: \"Assigned to no one\",\n          }}\n        />\n        <SelectLabel\n          queryParams={queryParams}\n          name=\"labelIds\"\n          onSelect={onSelect}\n          filterParams={{ pipelineId: queryParams.pipelineId }}\n          multi={true}\n          customOption={{ value: \"\", label: \"No label chosen\" }}\n        />\n\n        {extraFilter}\n        {this.renderDates()}\n      </FilterBox>\n    );\n  }\n\n  renderTabContent() {\n    if (this.state.currentTab === \"Filter\") {\n      const { isFiltered, clearFilter } = this.props;\n\n      return (\n        <>\n          <TabContent>{this.renderFilter()}</TabContent>\n          {isFiltered && (\n            <MenuFooter>\n              <Button\n                block={true}\n                btnStyle=\"warning\"\n                uppercase={false}\n                onClick={clearFilter}\n                icon=\"times-circle\"\n              >\n                {__(\"Clear Filter\")}\n              </Button>\n            </MenuFooter>\n          )}\n        </>\n      );\n    }\n\n    const { queryParams, options } = this.props;\n\n    return (\n      <TabContent>\n        <Archive queryParams={queryParams} options={options} />\n      </TabContent>\n    );\n  }\n\n  render() {\n    const tabOnClick = (name: string) => {\n      this.onChange(\"currentTab\", name);\n    };\n\n    const { currentTab, showMenu } = this.state;\n    const { isFiltered } = this.props;\n\n    return (\n      <div ref={this.setWrapperRef}>\n        {isFiltered && (\n          <Button\n            btnStyle=\"warning\"\n            icon=\"times-circle\"\n            uppercase={false}\n            onClick={this.props.clearFilter}\n          >\n            {__(\"Clear Filter\")}\n          </Button>\n        )}\n        <Button\n          btnStyle=\"simple\"\n          uppercase={false}\n          icon=\"bars\"\n          onClick={this.toggleMenu}\n        >\n          {showMenu ? __(\"Hide Menu\") : __(\"Show Menu\")}\n        </Button>\n\n        <RTG.CSSTransition\n          in={this.state.showMenu}\n          timeout={300}\n          classNames=\"slide-in-right\"\n          unmountOnExit={true}\n        >\n          <RightMenuContainer>\n            <Tabs full={true}>\n              <TabTitle\n                className={currentTab === \"Filter\" ? \"active\" : \"\"}\n                onClick={tabOnClick.bind(this, \"Filter\")}\n              >\n                {__(\"Filter\")}\n              </TabTitle>\n              <TabTitle\n                className={currentTab === \"Archived items\" ? \"active\" : \"\"}\n                onClick={tabOnClick.bind(this, \"Archived items\")}\n              >\n                {__(\"Archived items\")}\n              </TabTitle>\n            </Tabs>\n            {this.renderTabContent()}\n          </RightMenuContainer>\n        </RTG.CSSTransition>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}