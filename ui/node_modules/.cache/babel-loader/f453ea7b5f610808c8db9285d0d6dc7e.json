{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/activityLogs/components/items/InternalNote.tsx\";\nimport dayjs from 'dayjs';\nimport { ActivityContent, ActivityDate, DeleteAction, FlexBody, FlexCenterContent, LogWrapper } from 'modules/activityLogs/styles';\nimport Tip from 'modules/common/components/Tip';\nimport { renderUserFullName } from 'modules/common/utils';\nimport Form from 'modules/internalNotes/components/Form';\nimport React from 'react';\nimport xss from 'xss';\n\nvar InternalNote =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(InternalNote, _React$Component);\n\n  function InternalNote(props) {\n    var _this;\n\n    _classCallCheck(this, InternalNote);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(InternalNote).call(this, props));\n\n    _this.onEditing = function () {\n      _this.setState({\n        editing: !_this.state.editing\n      });\n    };\n\n    _this.renderBody = function () {\n      var internalNote = _this.props.internalNote;\n      var createdUser = internalNote.createdUser;\n      var userName = 'Unknown';\n\n      if (createdUser.details) {\n        userName = renderUserFullName(createdUser);\n      }\n\n      return React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }, userName), \" left a note\");\n    };\n\n    _this.state = {\n      editing: false\n    };\n    return _this;\n  }\n\n  _createClass(InternalNote, [{\n    key: \"renderContent\",\n    value: function renderContent() {\n      var _this$props = this.props,\n          internalNote = _this$props.internalNote,\n          isLoading = _this$props.isLoading,\n          edit = _this$props.edit,\n          currentUser = _this$props.currentUser;\n      var content = internalNote.content;\n      var isCurrentUserNote = currentUser._id === internalNote.createdUser._id;\n\n      if (this.state.editing) {\n        return React.createElement(Form, {\n          save: edit,\n          isActionLoading: isLoading,\n          content: content,\n          callback: this.onEditing,\n          contentType: \"activityLog\",\n          contentTypeId: internalNote._id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 64\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(ActivityContent, {\n        isInternalNote: true,\n        dangerouslySetInnerHTML: {\n          __html: xss(content)\n        },\n        onClick: isCurrentUserNote ? this.onEditing : undefined,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          internalNote = _this$props2.internalNote,\n          remove = _this$props2.remove,\n          currentUser = _this$props2.currentUser;\n      var isCurrentUserNote = currentUser._id === internalNote.createdUser._id;\n      return React.createElement(LogWrapper, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(FlexCenterContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, React.createElement(FlexBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, this.renderBody()), isCurrentUserNote && React.createElement(DeleteAction, {\n        onClick: remove,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, \"Delete\"), React.createElement(Tip, {\n        text: dayjs(internalNote.createdAt).format('llll'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, React.createElement(ActivityDate, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, dayjs(internalNote.createdAt).format('MMM D, h:mm A')))), this.renderContent());\n    }\n  }]);\n\n  return InternalNote;\n}(React.Component);\n\nexport default InternalNote;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/activityLogs/components/items/InternalNote.tsx"],"names":["dayjs","ActivityContent","ActivityDate","DeleteAction","FlexBody","FlexCenterContent","LogWrapper","Tip","renderUserFullName","Form","React","xss","InternalNote","props","onEditing","setState","editing","state","renderBody","internalNote","createdUser","userName","details","isLoading","edit","currentUser","content","isCurrentUserNote","_id","__html","undefined","remove","createdAt","format","renderContent","Component"],"mappings":";;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SACEC,eADF,EAEEC,YAFF,EAGEC,YAHF,EAIEC,QAJF,EAKEC,iBALF,EAMEC,UANF,QAOO,6BAPP;AASA,OAAOC,GAAP,MAAgB,+BAAhB;AACA,SAASC,kBAAT,QAAmC,sBAAnC;AACA,OAAOC,IAAP,MAAiB,uCAAjB;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,GAAP,MAAgB,KAAhB;;IAWMC,Y;;;;;AACJ,wBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,sFAAMA,KAAN;;AADiB,UAQnBC,SARmB,GAQP,YAAM;AAChB,YAAKC,QAAL,CAAc;AAAEC,QAAAA,OAAO,EAAE,CAAC,MAAKC,KAAL,CAAWD;AAAvB,OAAd;AACD,KAVkB;;AAAA,UAYnBE,UAZmB,GAYN,YAAM;AAAA,UACTC,YADS,GACQ,MAAKN,KADb,CACTM,YADS;AAAA,UAETC,WAFS,GAEOD,YAFP,CAETC,WAFS;AAIjB,UAAIC,QAAQ,GAAG,SAAf;;AAEA,UAAID,WAAW,CAACE,OAAhB,EAAyB;AACvBD,QAAAA,QAAQ,GAAGb,kBAAkB,CAACY,WAAD,CAA7B;AACD;;AAED,aACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAASC,QAAT,CADF,iBADF;AAKD,KA3BkB;;AAGjB,UAAKJ,KAAL,GAAa;AACXD,MAAAA,OAAO,EAAE;AADE,KAAb;AAHiB;AAMlB;;;;oCAuBe;AAAA,wBACyC,KAAKH,KAD9C;AAAA,UACNM,YADM,eACNA,YADM;AAAA,UACQI,SADR,eACQA,SADR;AAAA,UACmBC,IADnB,eACmBA,IADnB;AAAA,UACyBC,WADzB,eACyBA,WADzB;AAAA,UAENC,OAFM,GAEMP,YAFN,CAENO,OAFM;AAGd,UAAMC,iBAAiB,GAAGF,WAAW,CAACG,GAAZ,KAAoBT,YAAY,CAACC,WAAb,CAAyBQ,GAAvE;;AAEA,UAAI,KAAKX,KAAL,CAAWD,OAAf,EAAwB;AACtB,eACE,oBAAC,IAAD;AACE,UAAA,IAAI,EAAEQ,IADR;AAEE,UAAA,eAAe,EAAED,SAFnB;AAGE,UAAA,OAAO,EAAEG,OAHX;AAIE,UAAA,QAAQ,EAAE,KAAKZ,SAJjB;AAKE,UAAA,WAAW,EAAC,aALd;AAME,UAAA,aAAa,EAAEK,YAAY,CAACS,GAN9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAUD;;AAED,aACE,oBAAC,eAAD;AACE,QAAA,cAAc,EAAE,IADlB;AAEE,QAAA,uBAAuB,EAAE;AAAEC,UAAAA,MAAM,EAAElB,GAAG,CAACe,OAAD;AAAb,SAF3B;AAGE,QAAA,OAAO,EAAEC,iBAAiB,GAAG,KAAKb,SAAR,GAAoBgB,SAHhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF;AAOD;;;6BAEQ;AAAA,yBACuC,KAAKjB,KAD5C;AAAA,UACCM,YADD,gBACCA,YADD;AAAA,UACeY,MADf,gBACeA,MADf;AAAA,UACuBN,WADvB,gBACuBA,WADvB;AAEP,UAAME,iBAAiB,GAAGF,WAAW,CAACG,GAAZ,KAAoBT,YAAY,CAACC,WAAb,CAAyBQ,GAAvE;AAEA,aACE,oBAAC,UAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,iBAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAW,KAAKV,UAAL,EAAX,CADF,EAEGS,iBAAiB,IAChB,oBAAC,YAAD;AAAc,QAAA,OAAO,EAAEI,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAHJ,EAKE,oBAAC,GAAD;AAAK,QAAA,IAAI,EAAE/B,KAAK,CAACmB,YAAY,CAACa,SAAd,CAAL,CAA8BC,MAA9B,CAAqC,MAArC,CAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGjC,KAAK,CAACmB,YAAY,CAACa,SAAd,CAAL,CAA8BC,MAA9B,CAAqC,eAArC,CADH,CADF,CALF,CADF,EAYG,KAAKC,aAAL,EAZH,CADF;AAgBD;;;;EA7EwBxB,KAAK,CAACyB,S;;AAgFjC,eAAevB,YAAf","sourcesContent":["import dayjs from 'dayjs';\nimport {\n  ActivityContent,\n  ActivityDate,\n  DeleteAction,\n  FlexBody,\n  FlexCenterContent,\n  LogWrapper\n} from 'modules/activityLogs/styles';\nimport { IUser } from 'modules/auth/types';\nimport Tip from 'modules/common/components/Tip';\nimport { renderUserFullName } from 'modules/common/utils';\nimport Form from 'modules/internalNotes/components/Form';\nimport { IInternalNote } from 'modules/internalNotes/types';\nimport React from 'react';\nimport xss from 'xss';\n\ntype Props = {\n  activity: any;\n  edit: (variables, callback: () => void) => void;\n  remove: () => void;\n  internalNote: IInternalNote;\n  isLoading: boolean;\n  currentUser: IUser;\n};\n\nclass InternalNote extends React.Component<Props, { editing: boolean }> {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      editing: false\n    };\n  }\n\n  onEditing = () => {\n    this.setState({ editing: !this.state.editing });\n  };\n\n  renderBody = () => {\n    const { internalNote } = this.props;\n    const { createdUser } = internalNote;\n\n    let userName = 'Unknown';\n\n    if (createdUser.details) {\n      userName = renderUserFullName(createdUser);\n    }\n\n    return (\n      <span>\n        <strong>{userName}</strong> left a note\n      </span>\n    );\n  };\n\n  renderContent() {\n    const { internalNote, isLoading, edit, currentUser } = this.props;\n    const { content } = internalNote;\n    const isCurrentUserNote = currentUser._id === internalNote.createdUser._id;\n\n    if (this.state.editing) {\n      return (\n        <Form\n          save={edit}\n          isActionLoading={isLoading}\n          content={content}\n          callback={this.onEditing}\n          contentType=\"activityLog\"\n          contentTypeId={internalNote._id}\n        />\n      );\n    }\n\n    return (\n      <ActivityContent\n        isInternalNote={true}\n        dangerouslySetInnerHTML={{ __html: xss(content) }}\n        onClick={isCurrentUserNote ? this.onEditing : undefined}\n      />\n    );\n  }\n\n  render() {\n    const { internalNote, remove, currentUser } = this.props;\n    const isCurrentUserNote = currentUser._id === internalNote.createdUser._id;\n\n    return (\n      <LogWrapper>\n        <FlexCenterContent>\n          <FlexBody>{this.renderBody()}</FlexBody>\n          {isCurrentUserNote && (\n            <DeleteAction onClick={remove}>Delete</DeleteAction>\n          )}\n          <Tip text={dayjs(internalNote.createdAt).format('llll')}>\n            <ActivityDate>\n              {dayjs(internalNote.createdAt).format('MMM D, h:mm A')}\n            </ActivityDate>\n          </Tip>\n        </FlexCenterContent>\n        {this.renderContent()}\n      </LogWrapper>\n    );\n  }\n}\n\nexport default InternalNote;\n"]},"metadata":{},"sourceType":"module"}