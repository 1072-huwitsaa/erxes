{"ast":null,"code":"import _defineProperty from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/boards/components/portable/ItemChooser.tsx\";\nimport { PipelinePopoverContent } from 'modules/boards/styles/item';\nimport Chooser from 'modules/common/components/Chooser';\nimport Icon from 'erxes-common-ui/lib/components/icon';\nimport { Select } from 'modules/common/styles/chooser';\nimport { __ } from 'modules/common/utils';\nimport React from 'react';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Popover from 'react-bootstrap/Popover';\nimport BoardSelect from '../../containers/BoardSelect';\n\nvar ItemChooser =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ItemChooser, _React$Component);\n\n  function ItemChooser(props) {\n    var _this;\n\n    _classCallCheck(this, ItemChooser);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ItemChooser).call(this, props));\n    _this.ref = void 0;\n\n    _this.onOverlayClose = function () {\n      _this.ref.hide();\n    };\n\n    _this.clearFilter = function (e) {\n      e.stopPropagation();\n\n      _this.onChangeField('stageId', '');\n\n      _this.onChangeField('pipelineId', '');\n\n      _this.onChangeField('boardId', '');\n    };\n\n    _this.renderSelectChooser = function () {\n      var _this$state = _this.state,\n          stageId = _this$state.stageId,\n          pipelineId = _this$state.pipelineId,\n          boardId = _this$state.boardId;\n      var filtered = stageId || pipelineId || boardId;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, React.createElement(OverlayTrigger, {\n        ref: function ref(overlayTrigger) {\n          _this.ref = overlayTrigger;\n        },\n        trigger: \"click\",\n        placement: \"bottom-start\",\n        overlay: _this.renderBoardSelect(),\n        rootClose: true,\n        container: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(Select, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }, __('Filter'), React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, filtered && React.createElement(Icon, {\n        icon: \"times\",\n        onClick: _this.clearFilter,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }), React.createElement(Icon, {\n        icon: \"angle-down\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101\n        },\n        __self: this\n      })))));\n    };\n\n    _this.onChangeField = function (name, value) {\n      var filterStageId = _this.props.filterStageId;\n\n      if (name === 'stageId' && filterStageId) {\n        filterStageId(value, _this.state.boardId, _this.state.pipelineId);\n      }\n\n      _this.setState(_defineProperty({}, name, value));\n    };\n\n    _this.ref = React.createRef();\n    var _stageId = props.stageId,\n        _boardId = props.boardId,\n        _pipelineId = props.pipelineId;\n    _this.state = {\n      stageId: _stageId || '',\n      boardId: _boardId || '',\n      pipelineId: _pipelineId || ''\n    };\n    return _this;\n  }\n\n  _createClass(ItemChooser, [{\n    key: \"renderBoardSelect\",\n    value: function renderBoardSelect() {\n      var _this2 = this;\n\n      var data = this.props.data;\n      var _this$state2 = this.state,\n          stageId = _this$state2.stageId,\n          pipelineId = _this$state2.pipelineId,\n          boardId = _this$state2.boardId;\n\n      var stgIdOnChange = function stgIdOnChange(stgId) {\n        return _this2.onChangeField('stageId', stgId);\n      };\n\n      var plIdOnChange = function plIdOnChange(plId) {\n        return _this2.onChangeField('pipelineId', plId);\n      };\n\n      var brIdOnChange = function brIdOnChange(brId) {\n        return _this2.onChangeField('boardId', brId);\n      };\n\n      return React.createElement(Popover, {\n        id: \"board-popover\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }, React.createElement(PipelinePopoverContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 65\n        },\n        __self: this\n      }, React.createElement(BoardSelect, {\n        type: data.options.type,\n        stageId: stageId,\n        pipelineId: pipelineId,\n        boardId: boardId,\n        onChangeStage: stgIdOnChange,\n        onChangePipeline: plIdOnChange,\n        onChangeBoard: brIdOnChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(Chooser, Object.assign({}, this.props, {\n        renderFilter: this.renderSelectChooser,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return ItemChooser;\n}(React.Component);\n\nexport default ItemChooser;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/boards/components/portable/ItemChooser.tsx"],"names":["PipelinePopoverContent","Chooser","Icon","Select","__","React","OverlayTrigger","Popover","BoardSelect","ItemChooser","props","ref","onOverlayClose","hide","clearFilter","e","stopPropagation","onChangeField","renderSelectChooser","state","stageId","pipelineId","boardId","filtered","overlayTrigger","renderBoardSelect","name","value","filterStageId","setState","createRef","data","stgIdOnChange","stgId","plIdOnChange","plId","brIdOnChange","brId","options","type","Component"],"mappings":"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","sourcesContent":["import { PipelinePopoverContent } from 'modules/boards/styles/item';\nimport Chooser, { CommonProps } from 'modules/common/components/Chooser';\nimport Icon from 'erxes-common-ui/lib/components/icon';\nimport { Select } from 'modules/common/styles/chooser';\nimport { __ } from 'modules/common/utils';\nimport React from 'react';\nimport OverlayTrigger from 'react-bootstrap/OverlayTrigger';\nimport Popover from 'react-bootstrap/Popover';\nimport BoardSelect from '../../containers/BoardSelect';\n\ntype Props = {\n  boardId?: string;\n  pipelineId?: string;\n  stageId?: string;\n  filterStageId?: (\n    stageId?: string,\n    boardId?: string,\n    pipelineId?: string\n  ) => void;\n} & CommonProps;\n\ntype State = {\n  stageId: string;\n  boardId: string;\n  pipelineId: string;\n};\n\nclass ItemChooser extends React.Component<Props, State> {\n  private ref;\n\n  constructor(props) {\n    super(props);\n\n    this.ref = React.createRef();\n    const { stageId, boardId, pipelineId } = props;\n\n    this.state = {\n      stageId: stageId || '',\n      boardId: boardId || '',\n      pipelineId: pipelineId || ''\n    };\n  }\n\n  onOverlayClose = () => {\n    this.ref.hide();\n  };\n\n  clearFilter = e => {\n    e.stopPropagation();\n    this.onChangeField('stageId', '');\n    this.onChangeField('pipelineId', '');\n    this.onChangeField('boardId', '');\n  };\n\n  renderBoardSelect() {\n    const { data } = this.props;\n    const { stageId, pipelineId, boardId } = this.state;\n\n    const stgIdOnChange = stgId => this.onChangeField('stageId', stgId);\n    const plIdOnChange = plId => this.onChangeField('pipelineId', plId);\n    const brIdOnChange = brId => this.onChangeField('boardId', brId);\n\n    return (\n      <Popover id=\"board-popover\">\n        <PipelinePopoverContent>\n          <BoardSelect\n            type={data.options.type}\n            stageId={stageId}\n            pipelineId={pipelineId}\n            boardId={boardId}\n            onChangeStage={stgIdOnChange}\n            onChangePipeline={plIdOnChange}\n            onChangeBoard={brIdOnChange}\n          />\n        </PipelinePopoverContent>\n      </Popover>\n    );\n  }\n\n  renderSelectChooser = () => {\n    const { stageId, pipelineId, boardId } = this.state;\n\n    const filtered = stageId || pipelineId || boardId;\n\n    return (\n      <div>\n        <OverlayTrigger\n          ref={overlayTrigger => {\n            this.ref = overlayTrigger;\n          }}\n          trigger=\"click\"\n          placement=\"bottom-start\"\n          overlay={this.renderBoardSelect()}\n          rootClose={true}\n          container={this}\n        >\n          <Select>\n            {__('Filter')}\n            <span>\n              {filtered && <Icon icon=\"times\" onClick={this.clearFilter} />}\n              <Icon icon=\"angle-down\" />\n            </span>\n          </Select>\n        </OverlayTrigger>\n      </div>\n    );\n  };\n\n  onChangeField = <T extends keyof State>(name: T, value: State[T]) => {\n    const { filterStageId } = this.props;\n\n    if (name === 'stageId' && filterStageId) {\n      filterStageId(value as string, this.state.boardId, this.state.pipelineId);\n    }\n\n    this.setState(({ [name]: value } as unknown) as Pick<State, keyof State>);\n  };\n\n  render() {\n    return <Chooser {...this.props} renderFilter={this.renderSelectChooser} />;\n  }\n}\n\nexport default ItemChooser;\n"]},"metadata":{},"sourceType":"module"}