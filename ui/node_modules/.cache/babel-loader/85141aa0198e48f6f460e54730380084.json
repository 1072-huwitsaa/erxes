{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/settings/scripts/components/Form.tsx\";\nimport FormControl from 'modules/common/components/form/Control';\nimport FormGroup from 'modules/common/components/form/Group';\nimport ControlLabel from 'modules/common/components/form/Label';\nimport { __ } from 'modules/common/utils';\nimport React from 'react';\nimport Select from 'react-select-plus';\nimport CommonForm from '../../common/components/Form';\n\nvar Form =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Form, _React$Component);\n\n  function Form(props) {\n    var _this;\n\n    _classCallCheck(this, Form);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Form).call(this, props));\n\n    _this.generateDoc = function (values) {\n      var object = _this.props.object;\n      var finalValues = values;\n\n      if (object) {\n        finalValues._id = object._id;\n      }\n\n      return {\n        _id: finalValues._id,\n        name: finalValues.name,\n        messengerId: finalValues.messengerId,\n        kbTopicId: finalValues.kbTopicId,\n        leadIds: (_this.state.leads || []).map(function (lead) {\n          return lead.value;\n        })\n      };\n    };\n\n    _this.onChangeLeads = function (leads) {\n      _this.setState({\n        leads: leads\n      });\n    };\n\n    _this.generateLeadOptions = function (leads) {\n      return leads.map(function (lead) {\n        return {\n          value: lead._id,\n          label: lead.name\n        };\n      });\n    };\n\n    _this.renderContent = function (formProps) {\n      var _this$props = _this.props,\n          leads = _this$props.leads,\n          messengers = _this$props.messengers,\n          kbTopics = _this$props.kbTopics;\n      var object = _this.props.object || {};\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      }, React.createElement(ControlLabel, {\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77\n        },\n        __self: this\n      }, \"Name\"), React.createElement(FormControl, Object.assign({}, formProps, {\n        name: \"name\",\n        defaultValue: object.name || '',\n        required: true,\n        autoFocus: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78\n        },\n        __self: this\n      }))), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(ControlLabel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, \"Messenger\"), React.createElement(FormControl, Object.assign({}, formProps, {\n        name: \"messengerId\",\n        componentClass: \"select\",\n        placeholder: __('Select messenger'),\n        defaultValue: object.messengerId,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }), React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }), messengers.map(function (integration) {\n        return React.createElement(\"option\", {\n          key: integration._id,\n          value: integration._id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99\n          },\n          __self: this\n        }, integration.name);\n      }))), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      }, React.createElement(ControlLabel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107\n        },\n        __self: this\n      }, \"Leads\"), React.createElement(Select, {\n        placeholder: __('Select leads'),\n        onChange: _this.onChangeLeads,\n        value: _this.state.leads,\n        options: _this.generateLeadOptions(leads),\n        multi: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 109\n        },\n        __self: this\n      })), React.createElement(FormGroup, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(ControlLabel, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, \"Knowledgebase topic\"), React.createElement(FormControl, Object.assign({}, formProps, {\n        name: \"kbTopicId\",\n        componentClass: \"select\",\n        placeholder: __('Select topic'),\n        defaultValue: object.kbTopicId,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }), React.createElement(\"option\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }), kbTopics.map(function (topic) {\n        return React.createElement(\"option\", {\n          key: topic._id,\n          value: topic._id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 130\n          },\n          __self: this\n        }, topic.title);\n      }))));\n    };\n\n    var _object = props.object || {};\n\n    _this.state = {\n      leads: _this.generateLeadOptions(_object.leads || [])\n    };\n    return _this;\n  }\n\n  _createClass(Form, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(CommonForm, Object.assign({}, this.props, {\n        name: \"response template\",\n        renderContent: this.renderContent,\n        generateDoc: this.generateDoc,\n        object: this.props.object,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Form;\n}(React.Component);\n\nexport default Form;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/settings/scripts/components/Form.tsx"],"names":["FormControl","FormGroup","ControlLabel","__","React","Select","CommonForm","Form","props","generateDoc","values","object","finalValues","_id","name","messengerId","kbTopicId","leadIds","state","leads","map","lead","value","onChangeLeads","setState","generateLeadOptions","label","renderContent","formProps","messengers","kbTopics","integration","topic","title","Component"],"mappings":"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","sourcesContent":["import FormControl from 'modules/common/components/form/Control';\nimport FormGroup from 'modules/common/components/form/Group';\nimport ControlLabel from 'modules/common/components/form/Label';\nimport { IButtonMutateProps, IFormProps } from 'modules/common/types';\nimport { __ } from 'modules/common/utils';\nimport { ITopic } from 'modules/knowledgeBase/types';\nimport { IIntegration } from 'modules/settings/integrations/types';\nimport React from 'react';\nimport Select from 'react-select-plus';\nimport CommonForm from '../../common/components/Form';\nimport { ICommonFormProps } from '../../common/types';\nimport { IScript } from '../types';\n\ntype Props = {\n  object?: IScript;\n  leads: IIntegration[];\n  messengers: IIntegration[];\n  kbTopics: ITopic[];\n  renderButton: (props: IButtonMutateProps) => JSX.Element;\n};\n\ntype State = {\n  leads?: Array<{ value: string; label: string }>;\n};\n\nclass Form extends React.Component<Props & ICommonFormProps, State> {\n  constructor(props) {\n    super(props);\n\n    const object = (props.object || {}) as IScript;\n\n    this.state = {\n      leads: this.generateLeadOptions(object.leads || [])\n    };\n  }\n\n  generateDoc = (values: {\n    _id?: string;\n    name: string;\n    messengerId: string;\n    kbTopicId: string;\n  }) => {\n    const { object } = this.props;\n    const finalValues = values;\n\n    if (object) {\n      finalValues._id = object._id;\n    }\n\n    return {\n      _id: finalValues._id,\n      name: finalValues.name,\n      messengerId: finalValues.messengerId,\n      kbTopicId: finalValues.kbTopicId,\n      leadIds: (this.state.leads || []).map(lead => lead.value)\n    };\n  };\n\n  onChangeLeads = leads => {\n    this.setState({ leads });\n  };\n\n  generateLeadOptions = (leads: IIntegration[]) => {\n    return leads.map(lead => ({\n      value: lead._id,\n      label: lead.name\n    }));\n  };\n\n  renderContent = (formProps: IFormProps) => {\n    const { leads, messengers, kbTopics } = this.props;\n    const object = this.props.object || ({} as IScript);\n\n    return (\n      <React.Fragment>\n        <FormGroup>\n          <ControlLabel required={true}>Name</ControlLabel>\n          <FormControl\n            {...formProps}\n            name=\"name\"\n            defaultValue={object.name || ''}\n            required={true}\n            autoFocus={true}\n          />\n        </FormGroup>\n\n        <FormGroup>\n          <ControlLabel>Messenger</ControlLabel>\n\n          <FormControl\n            {...formProps}\n            name=\"messengerId\"\n            componentClass=\"select\"\n            placeholder={__('Select messenger')}\n            defaultValue={object.messengerId}\n          >\n            <option />\n            {messengers.map(integration => (\n              <option key={integration._id} value={integration._id}>\n                {integration.name}\n              </option>\n            ))}\n          </FormControl>\n        </FormGroup>\n\n        <FormGroup>\n          <ControlLabel>Leads</ControlLabel>\n\n          <Select\n            placeholder={__('Select leads')}\n            onChange={this.onChangeLeads}\n            value={this.state.leads}\n            options={this.generateLeadOptions(leads)}\n            multi={true}\n          />\n        </FormGroup>\n\n        <FormGroup>\n          <ControlLabel>Knowledgebase topic</ControlLabel>\n\n          <FormControl\n            {...formProps}\n            name=\"kbTopicId\"\n            componentClass=\"select\"\n            placeholder={__('Select topic')}\n            defaultValue={object.kbTopicId}\n          >\n            <option />\n            {kbTopics.map(topic => (\n              <option key={topic._id} value={topic._id}>\n                {topic.title}\n              </option>\n            ))}\n          </FormControl>\n        </FormGroup>\n      </React.Fragment>\n    );\n  };\n\n  render() {\n    return (\n      <CommonForm\n        {...this.props}\n        name=\"response template\"\n        renderContent={this.renderContent}\n        generateDoc={this.generateDoc}\n        object={this.props.object}\n      />\n    );\n  }\n}\n\nexport default Form;\n"]},"metadata":{},"sourceType":"module"}