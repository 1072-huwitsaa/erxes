{"ast":null,"code":"import _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/settings/productService/components/product/ProductList.tsx\";\nimport Button from 'modules/common/components/Button';\nimport DataWithLoader from 'modules/common/components/DataWithLoader';\nimport EmptyState from 'modules/common/components/EmptyState';\nimport { FormControl } from 'modules/common/components/form';\nimport HeaderDescription from 'modules/common/components/HeaderDescription';\nimport ModalTrigger from 'modules/common/components/ModalTrigger';\nimport Pagination from 'modules/common/components/pagination/Pagination';\nimport Table from 'modules/common/components/table';\nimport { Count, Title } from 'modules/common/styles/main';\nimport { __, Alert, confirm, router } from 'modules/common/utils';\nimport Wrapper from 'modules/layout/components/Wrapper';\nimport { BarItems } from 'modules/layout/styles';\nimport TaggerPopover from 'modules/tags/components/TaggerPopover';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport Form from '../../containers/product/ProductForm';\nimport CategoryList from '../../containers/productCategory/CategoryList';\nimport Row from './ProductRow';\n\nvar List =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(List, _React$Component);\n\n  function List(props) {\n    var _this;\n\n    _classCallCheck(this, List);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(List).call(this, props));\n    _this.timer = void 0;\n\n    _this.renderRow = function () {\n      var _this$props = _this.props,\n          products = _this$props.products,\n          history = _this$props.history,\n          toggleBulk = _this$props.toggleBulk,\n          bulk = _this$props.bulk;\n      return products.map(function (product) {\n        return React.createElement(Row, {\n          history: history,\n          key: product._id,\n          product: product,\n          toggleBulk: toggleBulk,\n          isChecked: bulk.includes(product),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 57\n          },\n          __self: this\n        });\n      });\n    };\n\n    _this.onChange = function () {\n      var _this$props2 = _this.props,\n          toggleAll = _this$props2.toggleAll,\n          products = _this$props2.products;\n      toggleAll(products, 'products');\n    };\n\n    _this.removeProducts = function (products) {\n      var productIds = [];\n      products.forEach(function (product) {\n        productIds.push(product._id);\n      });\n\n      _this.props.remove({\n        productIds: productIds\n      }, _this.props.emptyBulk);\n    };\n\n    _this.renderCount = function (productCount) {\n      return React.createElement(Count, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, productCount, \" product\", productCount > 1 && 's');\n    };\n\n    _this.search = function (e) {\n      if (_this.timer) {\n        clearTimeout(_this.timer);\n      }\n\n      var history = _this.props.history;\n      var searchValue = e.target.value;\n\n      _this.setState({\n        searchValue: searchValue\n      });\n\n      _this.timer = setTimeout(function () {\n        router.removeParams(history, 'page');\n        router.setParams(history, {\n          searchValue: searchValue\n        });\n      }, 500);\n    };\n\n    _this.state = {\n      searchValue: _this.props.searchValue\n    };\n    return _this;\n  }\n\n  _createClass(List, [{\n    key: \"moveCursorAtTheEnd\",\n    value: function moveCursorAtTheEnd(e) {\n      var tmpValue = e.target.value;\n      e.target.value = '';\n      e.target.value = tmpValue;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props3 = this.props,\n          productsCount = _this$props3.productsCount,\n          loading = _this$props3.loading,\n          queryParams = _this$props3.queryParams,\n          isAllSelected = _this$props3.isAllSelected,\n          history = _this$props3.history,\n          bulk = _this$props3.bulk,\n          emptyBulk = _this$props3.emptyBulk,\n          currentCategory = _this$props3.currentCategory;\n      var breadcrumb = [{\n        title: __('Settings'),\n        link: '/settings'\n      }, {\n        title: __('Product & Service')\n      }];\n      var trigger = React.createElement(Button, {\n        btnStyle: \"primary\",\n        uppercase: false,\n        icon: \"plus-circle\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }, \"Add Product / Service\");\n\n      var modalContent = function modalContent(props) {\n        return React.createElement(Form, Object.assign({}, props, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }));\n      };\n\n      var actionBarRight = React.createElement(BarItems, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(FormControl, {\n        type: \"text\",\n        placeholder: __('Type to search'),\n        onChange: this.search,\n        value: this.state.searchValue,\n        autoFocus: true,\n        onFocus: this.moveCursorAtTheEnd,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }), React.createElement(Link, {\n        to: \"/settings/importHistories?type=product\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, React.createElement(Button, {\n        btnStyle: \"simple\",\n        uppercase: false,\n        icon: \"arrow-from-right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, __('Go to import'))), React.createElement(ModalTrigger, {\n        title: \"Add Product / Service\",\n        trigger: trigger,\n        autoOpenKey: \"showProductModal\",\n        content: modalContent,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }));\n      var content = React.createElement(React.Fragment, null, this.renderCount(currentCategory.productCount || productsCount), React.createElement(Table, {\n        hover: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        style: {\n          width: 60\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, React.createElement(FormControl, {\n        checked: isAllSelected,\n        componentClass: \"checkbox\",\n        onChange: this.onChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      })), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }, __('Name')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176\n        },\n        __self: this\n      }, __('Type')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, __('Category')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, __('Unit Price')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, __('SKU')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, __('Tags')))), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, this.renderRow())));\n\n      if (currentCategory.productCount === 0) {\n        content = React.createElement(EmptyState, {\n          image: \"/images/actions/8.svg\",\n          text: \"No Brands\",\n          size: \"small\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190\n          },\n          __self: this\n        });\n      }\n\n      if (bulk.length > 0) {\n        var tagButton = React.createElement(Button, {\n          btnStyle: \"simple\",\n          size: \"small\",\n          icon: \"tag-alt\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200\n          },\n          __self: this\n        }, \"Tag\");\n\n        var onClick = function onClick() {\n          return confirm().then(function () {\n            _this2.removeProducts(bulk);\n          }).catch(function (error) {\n            Alert.error(error.message);\n          });\n        };\n\n        actionBarRight = React.createElement(BarItems, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215\n          },\n          __self: this\n        }, React.createElement(TaggerPopover, {\n          type: \"product\",\n          successCallback: emptyBulk,\n          targets: bulk,\n          trigger: tagButton,\n          refetchQueries: ['productCountByTags'],\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216\n          },\n          __self: this\n        }), React.createElement(Button, {\n          btnStyle: \"danger\",\n          size: \"small\",\n          icon: \"cancel-1\",\n          onClick: onClick,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223\n          },\n          __self: this\n        }, \"Remove\"));\n      }\n\n      var actionBarLeft = React.createElement(Title, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236\n        },\n        __self: this\n      }, currentCategory.name || 'All products');\n      return React.createElement(Wrapper, {\n        header: React.createElement(Wrapper.Header, {\n          title: __('Product & Service'),\n          breadcrumb: breadcrumb,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 242\n          },\n          __self: this\n        }),\n        mainHead: React.createElement(HeaderDescription, {\n          icon: \"/images/actions/30.svg\",\n          title: 'Product & Service',\n          description: \"All information and know-how related to your business's products and services are found here. Create and add in unlimited products and servicess so that you and your team members can edit and share.\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 248\n          },\n          __self: this\n        }),\n        actionBar: React.createElement(Wrapper.ActionBar, {\n          left: actionBarLeft,\n          right: actionBarRight,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 255\n          },\n          __self: this\n        }),\n        leftSidebar: React.createElement(CategoryList, {\n          queryParams: queryParams,\n          history: history,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 258\n          },\n          __self: this\n        }),\n        footer: React.createElement(Pagination, {\n          count: productsCount,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 260\n          },\n          __self: this\n        }),\n        content: React.createElement(DataWithLoader, {\n          data: content,\n          loading: loading,\n          count: productsCount,\n          emptyText: \"There is no data\",\n          emptyImage: \"/images/actions/5.svg\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 262\n          },\n          __self: this\n        }),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return List;\n}(React.Component);\n\nexport default List;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/settings/productService/components/product/ProductList.tsx"],"names":["Button","DataWithLoader","EmptyState","FormControl","HeaderDescription","ModalTrigger","Pagination","Table","Count","Title","__","Alert","confirm","router","Wrapper","BarItems","TaggerPopover","React","Link","Form","CategoryList","Row","List","props","timer","renderRow","products","history","toggleBulk","bulk","map","product","_id","includes","onChange","toggleAll","removeProducts","productIds","forEach","push","remove","emptyBulk","renderCount","productCount","search","e","clearTimeout","searchValue","target","value","setState","setTimeout","removeParams","setParams","state","tmpValue","productsCount","loading","queryParams","isAllSelected","currentCategory","breadcrumb","title","link","trigger","modalContent","actionBarRight","moveCursorAtTheEnd","content","width","length","tagButton","onClick","then","catch","error","message","actionBarLeft","name","Component"],"mappings":"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","sourcesContent":["import Button from 'modules/common/components/Button';\nimport DataWithLoader from 'modules/common/components/DataWithLoader';\nimport EmptyState from 'modules/common/components/EmptyState';\nimport { FormControl } from 'modules/common/components/form';\nimport HeaderDescription from 'modules/common/components/HeaderDescription';\nimport ModalTrigger from 'modules/common/components/ModalTrigger';\nimport Pagination from 'modules/common/components/pagination/Pagination';\nimport Table from 'modules/common/components/table';\nimport { Count, Title } from 'modules/common/styles/main';\nimport { IRouterProps } from 'modules/common/types';\nimport { __, Alert, confirm, router } from 'modules/common/utils';\nimport Wrapper from 'modules/layout/components/Wrapper';\nimport { BarItems } from 'modules/layout/styles';\nimport TaggerPopover from 'modules/tags/components/TaggerPopover';\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport Form from '../../containers/product/ProductForm';\nimport CategoryList from '../../containers/productCategory/CategoryList';\nimport { IProduct, IProductCategory } from '../../types';\nimport Row from './ProductRow';\n\ninterface IProps extends IRouterProps {\n  history: any;\n  queryParams: any;\n  products: IProduct[];\n  productsCount: number;\n  isAllSelected: boolean;\n  bulk: any[];\n  emptyBulk: () => void;\n  remove: (doc: { productIds: string[] }, emptyBulk: () => void) => void;\n  toggleBulk: () => void;\n  toggleAll: (targets: IProduct[], containerId: string) => void;\n  loading: boolean;\n  searchValue: string;\n  currentCategory: IProductCategory;\n}\n\ntype State = {\n  searchValue?: string;\n};\n\nclass List extends React.Component<IProps, State> {\n  private timer?: NodeJS.Timer;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      searchValue: this.props.searchValue\n    };\n  }\n\n  renderRow = () => {\n    const { products, history, toggleBulk, bulk } = this.props;\n\n    return products.map(product => (\n      <Row\n        history={history}\n        key={product._id}\n        product={product}\n        toggleBulk={toggleBulk}\n        isChecked={bulk.includes(product)}\n      />\n    ));\n  };\n\n  onChange = () => {\n    const { toggleAll, products } = this.props;\n    toggleAll(products, 'products');\n  };\n\n  removeProducts = products => {\n    const productIds: string[] = [];\n\n    products.forEach(product => {\n      productIds.push(product._id);\n    });\n\n    this.props.remove({ productIds }, this.props.emptyBulk);\n  };\n\n  renderCount = productCount => {\n    return (\n      <Count>\n        {productCount} product{productCount > 1 && 's'}\n      </Count>\n    );\n  };\n\n  search = e => {\n    if (this.timer) {\n      clearTimeout(this.timer);\n    }\n\n    const { history } = this.props;\n    const searchValue = e.target.value;\n\n    this.setState({ searchValue });\n\n    this.timer = setTimeout(() => {\n      router.removeParams(history, 'page');\n      router.setParams(history, { searchValue });\n    }, 500);\n  };\n\n  moveCursorAtTheEnd(e) {\n    const tmpValue = e.target.value;\n\n    e.target.value = '';\n    e.target.value = tmpValue;\n  }\n\n  render() {\n    const {\n      productsCount,\n      loading,\n      queryParams,\n      isAllSelected,\n      history,\n      bulk,\n      emptyBulk,\n      currentCategory\n    } = this.props;\n\n    const breadcrumb = [\n      { title: __('Settings'), link: '/settings' },\n      { title: __('Product & Service') }\n    ];\n\n    const trigger = (\n      <Button btnStyle=\"primary\" uppercase={false} icon=\"plus-circle\">\n        Add Product / Service\n      </Button>\n    );\n\n    const modalContent = props => <Form {...props} />;\n\n    let actionBarRight = (\n      <BarItems>\n        <FormControl\n          type=\"text\"\n          placeholder={__('Type to search')}\n          onChange={this.search}\n          value={this.state.searchValue}\n          autoFocus={true}\n          onFocus={this.moveCursorAtTheEnd}\n        />\n        <Link to=\"/settings/importHistories?type=product\">\n          <Button btnStyle=\"simple\" uppercase={false} icon=\"arrow-from-right\">\n            {__('Go to import')}\n          </Button>\n        </Link>\n        <ModalTrigger\n          title=\"Add Product / Service\"\n          trigger={trigger}\n          autoOpenKey=\"showProductModal\"\n          content={modalContent}\n        />\n      </BarItems>\n    );\n\n    let content = (\n      <>\n        {this.renderCount(currentCategory.productCount || productsCount)}\n        <Table hover={true}>\n          <thead>\n            <tr>\n              <th style={{ width: 60 }}>\n                <FormControl\n                  checked={isAllSelected}\n                  componentClass=\"checkbox\"\n                  onChange={this.onChange}\n                />\n              </th>\n              <th>{__('Name')}</th>\n              <th>{__('Type')}</th>\n              <th>{__('Category')}</th>\n              <th>{__('Unit Price')}</th>\n              <th>{__('SKU')}</th>\n              <th>{__('Tags')}</th>\n            </tr>\n          </thead>\n          <tbody>{this.renderRow()}</tbody>\n        </Table>\n      </>\n    );\n\n    if (currentCategory.productCount === 0) {\n      content = (\n        <EmptyState\n          image=\"/images/actions/8.svg\"\n          text=\"No Brands\"\n          size=\"small\"\n        />\n      );\n    }\n\n    if (bulk.length > 0) {\n      const tagButton = (\n        <Button btnStyle=\"simple\" size=\"small\" icon=\"tag-alt\">\n          Tag\n        </Button>\n      );\n\n      const onClick = () =>\n        confirm()\n          .then(() => {\n            this.removeProducts(bulk);\n          })\n          .catch(error => {\n            Alert.error(error.message);\n          });\n\n      actionBarRight = (\n        <BarItems>\n          <TaggerPopover\n            type=\"product\"\n            successCallback={emptyBulk}\n            targets={bulk}\n            trigger={tagButton}\n            refetchQueries={['productCountByTags']}\n          />\n          <Button\n            btnStyle=\"danger\"\n            size=\"small\"\n            icon=\"cancel-1\"\n            onClick={onClick}\n          >\n            Remove\n          </Button>\n        </BarItems>\n      );\n    }\n\n    const actionBarLeft = (\n      <Title>{currentCategory.name || 'All products'}</Title>\n    );\n\n    return (\n      <Wrapper\n        header={\n          <Wrapper.Header\n            title={__('Product & Service')}\n            breadcrumb={breadcrumb}\n          />\n        }\n        mainHead={\n          <HeaderDescription\n            icon=\"/images/actions/30.svg\"\n            title={'Product & Service'}\n            description={`All information and know-how related to your business's products and services are found here. Create and add in unlimited products and servicess so that you and your team members can edit and share.`}\n          />\n        }\n        actionBar={\n          <Wrapper.ActionBar left={actionBarLeft} right={actionBarRight} />\n        }\n        leftSidebar={\n          <CategoryList queryParams={queryParams} history={history} />\n        }\n        footer={<Pagination count={productsCount} />}\n        content={\n          <DataWithLoader\n            data={content}\n            loading={loading}\n            count={productsCount}\n            emptyText=\"There is no data\"\n            emptyImage=\"/images/actions/5.svg\"\n          />\n        }\n      />\n    );\n  }\n}\n\nexport default List;\n"]},"metadata":{},"sourceType":"module"}