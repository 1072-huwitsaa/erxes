{"ast":null,"code":"import _objectSpread from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _defineProperty from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/anu-ujin/Works/open-source/erxes/ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/anu-ujin/Works/open-source/erxes/ui/src/modules/settings/permissions/components/PermissionList.tsx\";\nimport Button from 'modules/common/components/Button';\nimport DataWithLoader from 'modules/common/components/DataWithLoader';\nimport { FormControl } from 'modules/common/components/form';\nimport ModalTrigger from 'modules/common/components/ModalTrigger';\nimport Pagination from 'modules/common/components/pagination/Pagination';\nimport Table from 'modules/common/components/table';\nimport { Title } from 'modules/common/styles/main';\nimport { __, router } from 'modules/common/utils';\nimport Wrapper from 'modules/layout/components/Wrapper';\nimport SelectTeamMembers from 'modules/settings/team/containers/SelectTeamMembers';\nimport React from 'react';\nimport Select from 'react-select-plus';\nimport { isObject } from 'util';\nimport GroupList from '../containers/GroupList';\nimport { FilterItem, FilterWrapper, NotWrappable } from '../styles';\nimport PermissionForm from './PermissionForm';\nimport PermissionRow from './PermissionRow';\nimport { correctValue, filterActions, generateModuleParams } from './utils';\n\nvar PermissionList =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(PermissionList, _React$Component);\n\n  function PermissionList() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, PermissionList);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(PermissionList)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.setFilter = function (name, item) {\n      var _router$setParams;\n\n      var history = _this.props.history;\n      router.setParams(history, (_router$setParams = {}, _defineProperty(_router$setParams, name, isObject(item) ? correctValue(item) : item), _defineProperty(_router$setParams, \"page\", null), _defineProperty(_router$setParams, \"perPage\", null), _router$setParams));\n    };\n\n    _this.renderForm = function (props) {\n      var _this$props = _this.props,\n          modules = _this$props.modules,\n          actions = _this$props.actions,\n          groups = _this$props.groups,\n          refetchQueries = _this$props.refetchQueries;\n\n      var extendedProps = _objectSpread({}, props, {\n        modules: modules,\n        actions: actions,\n        groups: groups,\n        refetchQueries: refetchQueries\n      });\n\n      return React.createElement(PermissionForm, Object.assign({}, extendedProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }));\n    };\n\n    return _this;\n  }\n\n  _createClass(PermissionList, [{\n    key: \"renderObjects\",\n    value: function renderObjects() {\n      var _this$props2 = this.props,\n          groups = _this$props2.groups,\n          modules = _this$props2.modules,\n          permissions = _this$props2.permissions,\n          actions = _this$props2.actions,\n          refetchQueries = _this$props2.refetchQueries,\n          remove = _this$props2.remove;\n      return permissions.map(function (object) {\n        return React.createElement(PermissionRow, {\n          key: object._id,\n          actions: actions,\n          groups: groups,\n          modules: modules,\n          removeItem: remove,\n          permission: object,\n          refetchQueries: refetchQueries,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66\n          },\n          __self: this\n        });\n      });\n    }\n  }, {\n    key: \"renderFilter\",\n    value: function renderFilter() {\n      var _this2 = this;\n\n      var _this$props3 = this.props,\n          queryParams = _this$props3.queryParams,\n          modules = _this$props3.modules,\n          actions = _this$props3.actions;\n\n      var usersOnChange = function usersOnChange(users) {\n        _this2.setFilter('userId', users);\n      };\n\n      var allowedOnChange = function allowedOnChange(e) {\n        _this2.setFilter('allowed', {\n          value: e.target.checked ? 'allowed' : 'notAllowed'\n        });\n      };\n\n      return React.createElement(FilterWrapper, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, __('Filters'), \":\"), React.createElement(FilterItem, {\n        id: \"permission-choose-module\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, React.createElement(Select, {\n        placeholder: __('Choose module'),\n        value: queryParams.module,\n        options: generateModuleParams(modules),\n        onChange: this.setFilter.bind(this, 'module'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      })), React.createElement(FilterItem, {\n        id: \"permission-choose-action\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104\n        },\n        __self: this\n      }, React.createElement(Select, {\n        placeholder: __('Choose action'),\n        value: queryParams.action,\n        options: filterActions(actions, queryParams.module),\n        onChange: this.setFilter.bind(this, 'action'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105\n        },\n        __self: this\n      })), React.createElement(FilterItem, {\n        id: \"permission-choose-users\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, React.createElement(SelectTeamMembers, {\n        label: __('Choose users'),\n        name: \"userId\",\n        value: queryParams.userId,\n        onSelect: usersOnChange,\n        multi: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }, __('Granted'), \":\"), React.createElement(FormControl, {\n        componentClass: \"checkbox\",\n        defaultChecked: queryParams.allowed !== 'notAllowed',\n        id: \"allowed\",\n        onChange: allowedOnChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      })));\n    }\n  }, {\n    key: \"renderData\",\n    value: function renderData() {\n      return React.createElement(Table, {\n        whiteSpace: \"nowrap\",\n        hover: true,\n        bordered: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, __('Module')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, __('Action')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, __('Email')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, __('Group')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, __('Allow')), React.createElement(\"th\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, __('Actions')))), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, this.renderObjects()));\n    }\n  }, {\n    key: \"renderActionBar\",\n    value: function renderActionBar() {\n      var trigger = React.createElement(Button, {\n        id: \"permission-new-permission\",\n        btnStyle: \"primary\",\n        icon: \"plus-circle\",\n        uppercase: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, \"New permission\");\n      var title = React.createElement(Title, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, this.props.currentGroupName || __('All permissions'));\n      var actionBarRight = React.createElement(NotWrappable, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(ModalTrigger, {\n        title: \"New permission\",\n        size: \"lg\",\n        trigger: trigger,\n        content: this.renderForm,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }));\n      return React.createElement(Wrapper.ActionBar, {\n        left: title,\n        right: actionBarRight,\n        background: \"colorWhite\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      });\n    }\n  }, {\n    key: \"renderContent\",\n    value: function renderContent() {\n      var _this$props4 = this.props,\n          isLoading = _this$props4.isLoading,\n          totalCount = _this$props4.totalCount;\n      return React.createElement(React.Fragment, null, this.renderFilter(), React.createElement(DataWithLoader, {\n        data: this.renderData(),\n        loading: isLoading,\n        count: totalCount,\n        emptyText: __('There is no permissions in this group'),\n        emptyImage: \"/images/actions/11.svg\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props5 = this.props,\n          totalCount = _this$props5.totalCount,\n          queryParams = _this$props5.queryParams;\n      var breadcrumb = [{\n        title: 'Settings',\n        link: '/settings'\n      }, {\n        title: __('Permissions')\n      }];\n      return React.createElement(Wrapper, {\n        header: React.createElement(Wrapper.Header, {\n          title: __('Permissions'),\n          breadcrumb: breadcrumb,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 231\n          },\n          __self: this\n        }),\n        actionBar: this.renderActionBar(),\n        leftSidebar: React.createElement(GroupList, {\n          queryParams: queryParams,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 234\n          },\n          __self: this\n        }),\n        footer: React.createElement(Pagination, {\n          count: totalCount,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 235\n          },\n          __self: this\n        }),\n        content: this.renderContent(),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return PermissionList;\n}(React.Component);\n\nexport default PermissionList;","map":{"version":3,"sources":["/home/anu-ujin/Works/open-source/erxes/ui/src/modules/settings/permissions/components/PermissionList.tsx"],"names":["Button","DataWithLoader","FormControl","ModalTrigger","Pagination","Table","Title","__","router","Wrapper","SelectTeamMembers","React","Select","isObject","GroupList","FilterItem","FilterWrapper","NotWrappable","PermissionForm","PermissionRow","correctValue","filterActions","generateModuleParams","PermissionList","setFilter","name","item","history","props","setParams","renderForm","modules","actions","groups","refetchQueries","extendedProps","permissions","remove","map","object","_id","queryParams","usersOnChange","users","allowedOnChange","e","value","target","checked","module","bind","action","userId","allowed","renderObjects","trigger","title","currentGroupName","actionBarRight","isLoading","totalCount","renderFilter","renderData","breadcrumb","link","renderActionBar","renderContent","Component"],"mappings":"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","sourcesContent":["import Button from 'modules/common/components/Button';\nimport DataWithLoader from 'modules/common/components/DataWithLoader';\nimport { FormControl } from 'modules/common/components/form';\nimport ModalTrigger from 'modules/common/components/ModalTrigger';\nimport Pagination from 'modules/common/components/pagination/Pagination';\nimport Table from 'modules/common/components/table';\nimport { Title } from 'modules/common/styles/main';\nimport { __, router } from 'modules/common/utils';\nimport Wrapper from 'modules/layout/components/Wrapper';\nimport SelectTeamMembers from 'modules/settings/team/containers/SelectTeamMembers';\nimport React from 'react';\nimport Select from 'react-select-plus';\nimport { isObject } from 'util';\nimport GroupList from '../containers/GroupList';\nimport { FilterItem, FilterWrapper, NotWrappable } from '../styles';\nimport { IActions, IModule, IPermissionDocument, IUserGroup } from '../types';\nimport PermissionForm from './PermissionForm';\nimport PermissionRow from './PermissionRow';\nimport {\n  correctValue,\n  filterActions,\n  generatedList,\n  generateModuleParams\n} from './utils';\n\ntype Props = {\n  history: any;\n  queryParams: any;\n  isLoading: boolean;\n  totalCount: number;\n  currentGroupName?: string;\n} & commonProps;\n\ntype commonProps = {\n  modules: IModule[];\n  actions: IActions[];\n  groups: IUserGroup[];\n  permissions: IPermissionDocument[];\n  remove: (id: string) => void;\n  refetchQueries: any;\n};\n\nclass PermissionList extends React.Component<Props> {\n  setFilter = (name: string, item: generatedList) => {\n    const { history } = this.props;\n\n    router.setParams(history, {\n      [name]: isObject(item) ? correctValue(item) : item,\n      page: null,\n      perPage: null\n    });\n  };\n\n  renderObjects() {\n    const {\n      groups,\n      modules,\n      permissions,\n      actions,\n      refetchQueries,\n      remove\n    } = this.props;\n\n    return permissions.map(object => {\n      return (\n        <PermissionRow\n          key={object._id}\n          actions={actions}\n          groups={groups}\n          modules={modules}\n          removeItem={remove}\n          permission={object}\n          refetchQueries={refetchQueries}\n        />\n      );\n    });\n  }\n\n  renderFilter() {\n    const { queryParams, modules, actions } = this.props;\n\n    const usersOnChange = users => {\n      this.setFilter('userId', users);\n    };\n\n    const allowedOnChange = e => {\n      this.setFilter('allowed', {\n        value: e.target.checked ? 'allowed' : 'notAllowed'\n      });\n    };\n\n    return (\n      <FilterWrapper>\n        <strong>{__('Filters')}:</strong>\n        <FilterItem id=\"permission-choose-module\">\n          <Select\n            placeholder={__('Choose module')}\n            value={queryParams.module}\n            options={generateModuleParams(modules)}\n            onChange={this.setFilter.bind(this, 'module')}\n          />\n        </FilterItem>\n\n        <FilterItem id=\"permission-choose-action\">\n          <Select\n            placeholder={__('Choose action')}\n            value={queryParams.action}\n            options={filterActions(actions, queryParams.module)}\n            onChange={this.setFilter.bind(this, 'action')}\n          />\n        </FilterItem>\n        <FilterItem id=\"permission-choose-users\">\n          <SelectTeamMembers\n            label={__('Choose users')}\n            name=\"userId\"\n            value={queryParams.userId}\n            onSelect={usersOnChange}\n            multi={false}\n          />\n        </FilterItem>\n\n        <div>\n          <strong>{__('Granted')}:</strong>\n          <FormControl\n            componentClass=\"checkbox\"\n            defaultChecked={queryParams.allowed !== 'notAllowed'}\n            id=\"allowed\"\n            onChange={allowedOnChange}\n          />\n        </div>\n      </FilterWrapper>\n    );\n  }\n\n  renderData() {\n    return (\n      <Table whiteSpace=\"nowrap\" hover={true} bordered={true}>\n        <thead>\n          <tr>\n            <th>{__('Module')}</th>\n            <th>{__('Action')}</th>\n            <th>{__('Email')}</th>\n            <th>{__('Group')}</th>\n            <th>{__('Allow')}</th>\n            <th>{__('Actions')}</th>\n          </tr>\n        </thead>\n        <tbody>{this.renderObjects()}</tbody>\n      </Table>\n    );\n  }\n\n  renderForm = props => {\n    const { modules, actions, groups, refetchQueries } = this.props;\n\n    const extendedProps = {\n      ...props,\n      modules,\n      actions,\n      groups,\n      refetchQueries\n    };\n\n    return <PermissionForm {...extendedProps} />;\n  };\n\n  renderActionBar() {\n    const trigger = (\n      <Button\n        id=\"permission-new-permission\"\n        btnStyle=\"primary\"\n        icon=\"plus-circle\"\n        uppercase={false}\n      >\n        New permission\n      </Button>\n    );\n\n    const title = (\n      <Title>{this.props.currentGroupName || __('All permissions')}</Title>\n    );\n\n    const actionBarRight = (\n      <NotWrappable>\n        <ModalTrigger\n          title=\"New permission\"\n          size=\"lg\"\n          trigger={trigger}\n          content={this.renderForm}\n        />\n      </NotWrappable>\n    );\n\n    return (\n      <Wrapper.ActionBar\n        left={title}\n        right={actionBarRight}\n        background=\"colorWhite\"\n      />\n    );\n  }\n\n  renderContent() {\n    const { isLoading, totalCount } = this.props;\n\n    return (\n      <>\n        {this.renderFilter()}\n        <DataWithLoader\n          data={this.renderData()}\n          loading={isLoading}\n          count={totalCount}\n          emptyText={__('There is no permissions in this group')}\n          emptyImage=\"/images/actions/11.svg\"\n        />\n      </>\n    );\n  }\n\n  render() {\n    const { totalCount, queryParams } = this.props;\n\n    const breadcrumb = [\n      { title: 'Settings', link: '/settings' },\n      { title: __('Permissions') }\n    ];\n\n    return (\n      <Wrapper\n        header={\n          <Wrapper.Header title={__('Permissions')} breadcrumb={breadcrumb} />\n        }\n        actionBar={this.renderActionBar()}\n        leftSidebar={<GroupList queryParams={queryParams} />}\n        footer={<Pagination count={totalCount} />}\n        content={this.renderContent()}\n      />\n    );\n  }\n}\n\nexport default PermissionList;\n"]},"metadata":{},"sourceType":"module"}