(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{132:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return j})),n.d(t,"metadata",(function(){return g})),n.d(t,"rightToc",(function(){return h})),n.d(t,"default",(function(){return y}));var a=n(2),r=n(6),l=n(0),s=n.n(l),o=n(136),b=n(156),i=n(142),c=n(83),p=n.n(c),u=37,m=39;var d=function(e){var t=e.block,n=e.children,a=e.defaultValue,r=e.values,o=e.groupId,c=Object(b.a)(),d=c.tabGroupChoices,O=c.setTabGroupChoices,j=Object(l.useState)(a),g=j[0],h=j[1],N=Object(l.useState)(!1),y=N[0],f=N[1];if(null!=o){var x=d[o];null!=x&&x!==g&&r.some((function(e){return e.value===x}))&&h(x)}var w=function(e){h(e),null!=o&&O(o,e)},v=[],_=function(e){e.metaKey||e.altKey||e.ctrlKey||f(!0)},C=function(){f(!1)};return Object(l.useEffect)((function(){window.addEventListener("keydown",_),window.addEventListener("mousedown",C)}),[]),s.a.createElement("div",null,s.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(i.a)("tabs",{"tabs--block":t})},r.map((function(e){var t=e.value,n=e.label;return s.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":g===t,className:Object(i.a)("tabs__item",p.a.tabItem,{"tabs__item--active":g===t}),style:y?{}:{outline:"none"},key:t,ref:function(e){return v.push(e)},onKeyDown:function(e){!function(e,t,n){switch(n.keyCode){case m:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case u:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(v,e.target,e),_(e)},onFocus:function(){return w(t)},onClick:function(){w(t),f(!1)},onPointerDown:function(){return f(!1)}},n)}))),s.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},l.Children.toArray(n).filter((function(e){return e.props.value===g}))[0]))};var O=function(e){return s.a.createElement("div",null,e.children)},j={id:"ubuntu",title:"Ubuntu 18.04"},g={unversionedId:"installation/ubuntu",id:"installation/ubuntu",isDocsHomePage:!1,title:"Ubuntu 18.04",description:"Server Installation Requirements",source:"@site/docs/installation/ubuntu.mdx",slug:"/installation/ubuntu",permalink:"/installation/ubuntu",editUrl:"https://github.com/erxes/erxes/edit/develop/docs/docs/installation/ubuntu.mdx",version:"current",lastUpdatedBy:"Batnasan Byambasuren",lastUpdatedAt:1599128271,sidebar:"docs",previous:{title:"Integrations Overview",permalink:"/overview/integrations-overview"},next:{title:"AWS Marketplace",permalink:"/installation/aws"}},h=[{value:"Server Installation Requirements",id:"server-installation-requirements",children:[{value:"Minimum required server resources",id:"minimum-required-server-resources",children:[]}]},{value:"First steps: Setting up a server with Ubuntu 18.04",id:"first-steps-setting-up-a-server-with-ubuntu-1804",children:[{value:"Configure your DNS Records to point at your server",id:"configure-your-dns-records-to-point-at-your-server",children:[]}]},{value:"Quickstart - Installing erxes on Ubuntu 18.04",id:"quickstart---installing-erxes-on-ubuntu-1804",children:[]},{value:"Log into server as root",id:"log-into-server-as-root",children:[]},{value:"Create a user password and log out of root user",id:"create-a-user-password-and-log-out-of-root-user",children:[]},{value:"Log in as the <code>erxes</code> user",id:"log-in-as-the-erxes-user",children:[]},{value:"Install Let&#39;s Encrypt using Certbot",id:"install-lets-encrypt-using-certbot",children:[]},{value:"Final MongoDB Configuration steps",id:"final-mongodb-configuration-steps",children:[]},{value:"Log into server as root and create erxes user",id:"log-into-server-as-root-and-create-erxes-user",children:[]},{value:"Set-up a basic firewall for SSH, nginx 80 and port 443",id:"set-up-a-basic-firewall-for-ssh-nginx-80-and-port-443",children:[{value:"Basic Firewall - Port 22",id:"basic-firewall---port-22",children:[]},{value:"HTTP &amp; HTTPS - Port 80 &amp; Port 443",id:"http--https---port-80--port-443",children:[]}]},{value:"Allow the &quot;erxes&quot; user to <strong>SSH</strong> into server",id:"allow-the-erxes-user-to-ssh-into-server",children:[]},{value:"Log in to your server as the &quot;erxes&quot; user.",id:"log-in-to-your-server-as-the-erxes-user",children:[]},{value:"Nvm install",id:"nvm-install",children:[]},{value:"Install Node.js with nvm",id:"install-nodejs-with-nvm",children:[]},{value:"Yarn install",id:"yarn-install",children:[]},{value:"Install MongoDB",id:"install-mongodb",children:[{value:"Deploy a MongoDB Replica Set",id:"deploy-a-mongodb-replica-set",children:[]}]},{value:"Install Redis",id:"install-redis",children:[]},{value:"Install RabbitMQ and dependencies",id:"install-rabbitmq-and-dependencies",children:[{value:"Install Erlang 22.x",id:"install-erlang-22x",children:[]},{value:"Update all packages",id:"update-all-packages",children:[]},{value:"Install RabbitMQ",id:"install-rabbitmq",children:[]}]},{value:"Install Elasticsearch",id:"install-elasticsearch",children:[]},{value:"Install and configure NGINX",id:"install-and-configure-nginx",children:[]},{value:"Configure NGINX",id:"configure-nginx",children:[{value:"Configure NGINX",id:"configure-nginx-1",children:[]}]},{value:"Install Let&#39;s Encrypt using Certbot",id:"install-lets-encrypt-using-certbot-1",children:[]},{value:"Install erxes",id:"install-erxes",children:[{value:"Download, extract and install each of the erxes components",id:"download-extract-and-install-each-of-the-erxes-components",children:[]}]},{value:"Install PM2",id:"install-pm2",children:[{value:"Configure PM2 <code>ecosystem.config.js</code>",id:"configure-pm2-ecosystemconfigjs",children:[]},{value:"Configure frontend environment variables",id:"configure-frontend-environment-variables",children:[]}]},{value:"export MongoDB URL",id:"export-mongodb-url",children:[]},{value:"Initialize and Load permissions for erxes",id:"initialize-and-load-permissions-for-erxes",children:[]},{value:"Congratulations, time to log in",id:"congratulations-time-to-log-in",children:[]},{value:"Known Issues and frequent Questions",id:"known-issues-and-frequent-questions",children:[]}],N={rightToc:h};function y(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(a.a)({},N,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"server-installation-requirements"},"Server Installation Requirements"),Object(o.b)("p",null,"erxes gives you several options for installing the erxes platform. Below you will find two guides:"),Object(o.b)("p",null,"The first guide is the ",Object(o.b)("strong",{parentName:"p"},"Quick Start")," guide where we provide a script that automates most of the installation process. The second guide is a comprehensive, ",Object(o.b)("strong",{parentName:"p"},"Step by Step")," guide where advanced developers can see exactly what is being installed and how."),Object(o.b)("div",{className:"admonition admonition-info alert alert--info"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})))),"Ubuntu 18.04")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"These instructions are for installing erxes on ",Object(o.b)("strong",{parentName:"p"},"Ubuntu 18.04"),". They should work on any hosting provider that allows you to install Ubuntu 18.04."),Object(o.b)("p",{parentName:"div"},Object(o.b)("strong",{parentName:"p"},"Ubuntu 18.04")," is currently the only officially supported ",Object(o.b)("strong",{parentName:"p"},"Linux distro"),". Other distros such as ",Object(o.b)("em",{parentName:"p"},"Centos and Debian are not specifically supported"),", but some users are able to adapt the below commands to make ",Object(o.b)("strong",{parentName:"p"},"erxes")," work on them."))),Object(o.b)("h3",{id:"minimum-required-server-resources"},"Minimum required server resources"),Object(o.b)("p",null,"Each hosting company has slightly different server configurations and set-ups. Hosting companies such as ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.linode.com/"}),"Linode.com"),", ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://digitalocean.com"}),"Digital Ocean")," and ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://aws.amazon.com/ec2"}),"AWS EC2")," offer many different server specifications and configuration options."),Object(o.b)("p",null,"To install and properly run your ",Object(o.b)("strong",{parentName:"p"},"erxes")," installation, you must meet these minimum requirements:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Ubuntu 18.04 installed and running"),Object(o.b)("li",{parentName:"ul"},"2 CPUs"),Object(o.b)("li",{parentName:"ul"},"4GB RAM"),Object(o.b)("li",{parentName:"ul"},"ability to to SSH into the server")),Object(o.b)("div",{className:"admonition admonition-tip alert alert--success"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})))),"Use one-click installs")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"You can use the ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://marketplace.digitalocean.com/apps/erxes"}),"Digital Ocean Marketplace")," and ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://aws.amazon.com/marketplace/pp/B086MZ9FVS?qid=1594055516154&sr=0-1&ref_=srh_res_product_title"}),"AWS Marketplace")," for an even easier set-up experience."))),Object(o.b)("h2",{id:"first-steps-setting-up-a-server-with-ubuntu-1804"},"First steps: Setting up a server with Ubuntu 18.04"),Object(o.b)("p",null,"You must have an account with your hosting provider prior to doing these steps."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Create a server with ",Object(o.b)("strong",{parentName:"li"},"Ubuntu 18.04")," installed, a minimum of ",Object(o.b)("strong",{parentName:"li"},"2 CPUs")," and ",Object(o.b)("strong",{parentName:"li"},"4GB RAM"),"."),Object(o.b)("li",{parentName:"ul"},"If you're using a ",Object(o.b)("strong",{parentName:"li"},"subdomain"),", then the ",Object(o.b)("strong",{parentName:"li"},"subdomain")," must be created with your hosting provider hosting your main domain's website or app.")),Object(o.b)("h3",{id:"configure-your-dns-records-to-point-at-your-server"},"Configure your DNS Records to point at your server"),Object(o.b)("p",null,"Your server will have an ",Object(o.b)("strong",{parentName:"p"},"ip address"),". You will need to point your domain name to your new server."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"If you are using a ",Object(o.b)("strong",{parentName:"li"},"subdomain"),", you will need to follow the instructions of updating the `A Records' of the hosting company for your website."),Object(o.b)("li",{parentName:"ul"},"If you are NOT using a ",Object(o.b)("strong",{parentName:"li"},"subdomain"),", then you will need to follow the instructions of your domain name registrar.")),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"Example with a domain called, example.com")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},"If your domain name is ",Object(o.b)("strong",{parentName:"p"},"example.com"),", and the ",Object(o.b)("strong",{parentName:"p"},"ip address")," assigned to your server is ",Object(o.b)("strong",{parentName:"p"},"44.123.32.12"),", then you will have two ",Object(o.b)("inlineCode",{parentName:"p"},"A records")," that look like this:"),Object(o.b)("table",{parentName:"div"},Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"),Object(o.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Name"),Object(o.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Value"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A"),Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(o.b)("a",Object(a.a)({parentName:"td"},{href:"http://www.example.com"}),"www.example.com")),Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"points to 44.123.32.12")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A"),Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"example.com"),Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"points to 44.123.32.12")))))),Object(o.b)("div",{className:"admonition admonition-note alert alert--secondary"},Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-heading"}),Object(o.b)("h5",{parentName:"div"},Object(o.b)("span",Object(a.a)({parentName:"h5"},{className:"admonition-icon"}),Object(o.b)("svg",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"}),Object(o.b)("path",Object(a.a)({parentName:"svg"},{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})))),"Example with a subdomain called, erxes.example.com")),Object(o.b)("div",Object(a.a)({parentName:"div"},{className:"admonition-content"}),Object(o.b)("p",{parentName:"div"},'You first need to create a subdomain. For example, "erxes.example.com". Then you need to edit the ',Object(o.b)("strong",{parentName:"p"},"DNS"),"."),Object(o.b)("p",{parentName:"div"},"If your domain name is ",Object(o.b)("strong",{parentName:"p"},"erxes.example.com"),", and the ",Object(o.b)("strong",{parentName:"p"},"ip address")," assigned to your server is ",Object(o.b)("strong",{parentName:"p"},"44.123.32.12"),", then you will have a two ",Object(o.b)("inlineCode",{parentName:"p"},"A records")," that look like this:"),Object(o.b)("table",{parentName:"div"},Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Type"),Object(o.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Name"),Object(o.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Value"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A"),Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"erxes.example.com"),Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"points to 44.123.32.12")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"A"),Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),Object(o.b)("a",Object(a.a)({parentName:"td"},{href:"http://www.erxes.example.com"}),"www.erxes.example.com")),Object(o.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"points to 44.123.32.12")))),Object(o.b)("p",{parentName:"div"},Object(o.b)("strong",{parentName:"p"},"Note:"),' You do not need to create a subdomain called "erxes.example.com", you can use another name of your choice such as "admin.example.com".'))),Object(o.b)("p",null,"Please select from the ",Object(o.b)("strong",{parentName:"p"},"Quickstart")," or ",Object(o.b)("strong",{parentName:"p"},"Step by Step")," instructions below and continue with your installation of ",Object(o.b)("strong",{parentName:"p"},"erxes"),"."),Object(o.b)(d,{defaultValue:"quickstart",values:[{label:"Quickstart",value:"quickstart"},{label:"Step by Step",value:"step-by-step"}],mdxType:"Tabs"},Object(o.b)(O,{value:"quickstart",mdxType:"TabItem"},Object(o.b)("h2",{id:"quickstart---installing-erxes-on-ubuntu-1804"},"Quickstart - Installing erxes on Ubuntu 18.04"),Object(o.b)("h2",{id:"log-into-server-as-root"},"Log into server as root"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Open the terminal or command prompt on your computer. You will need your ",Object(o.b)("strong",{parentName:"li"},"IP address"),". (In this example, ",Object(o.b)("strong",{parentName:"li"},"44.123.32.12"),"). Type ",Object(o.b)("inlineCode",{parentName:"li"},"yes"),", when asked if you want to continue connecting.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# example ssh root@44.123.32.12\nssh root@your-ip-address\n")),Object(o.b)("p",null,"(",Object(o.b)("strong",{parentName:"p"},"Note"),": Some people get an error, ",Object(o.b)("strong",{parentName:"p"},"WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!"),", please see the solution ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/installation/ubuntu#known-issues-and-frequent-questions"}),"here"),".)"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Run the ",Object(o.b)("strong",{parentName:"li"},"Quickstart Script")," to")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'bash -c "$(wget -O - https://raw.githubusercontent.com/erxes/erxes/develop/scripts/install/ubuntu18.sh)"\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"You will be asked to enter the domain name you would like to use. If you are using a subdomain, enter in the complete subdomain. For example, ",Object(o.b)("inlineCode",{parentName:"li"},"erxes.example.com"),".")),Object(o.b)("p",null,"See example below:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"Please enter a domain name you wish to use: erxes.example.com\n")),Object(o.b)("p",null,"The installation process takes a few minutes to complete."),Object(o.b)("p",null,"You will know the installation was successful if no errors occurred and you see the following output at the end of the installation. All processes should have a status of ",Object(o.b)("inlineCode",{parentName:"p"},"online"),", and the final line should say, ",Object(o.b)("inlineCode",{parentName:"p"},"Installation complete"),"."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"\u250c\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 id \u2502 name               \u2502 mode     \u2502 \u21ba    \u2502 status    \u2502 cpu      \u2502 memory   \u2502\n\u251c\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 0  \u2502 erxes-api          \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 37.9mb   \u2502\n\u2502 1  \u2502 erxes-api-cronjob  \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 38.6mb   \u2502\n\u2502 2  \u2502 erxes-api-worker   \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 35.6mb   \u2502\n\u2502 7  \u2502 erxes-elkSyncer    \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 11.2mb   \u2502\n\u2502 6  \u2502 erxes-email-verif\u2026 \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 29.3mb   \u2502\n\u2502 4  \u2502 erxes-engages      \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 33.6mb   \u2502\n\u2502 8  \u2502 erxes-integrations \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 26.8mb   \u2502\n\u2502 5  \u2502 erxes-logger       \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 29.7mb   \u2502\n\u2502 3  \u2502 erxes-widgets      \u2502 fork     \u2502 0    \u2502 online    \u2502 0%       \u2502 34.4mb   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n[PM2] Saving current process list...\n[PM2] Successfully saved in /home/erxes/.pm2/dump.pm2\nCommand may disrupt existing ssh connections. Proceed with operation (y|n)? Firewall is active and enabled on system startup\nRule added\nRule added (v6)\nRule added\nRule added (v6)\nRule added\nRule added (v6)\nNow using node v12.16.3 (npm v6.14.4)\n\nInstallation complete\n")),Object(o.b)("h2",{id:"create-a-user-password-and-log-out-of-root-user"},"Create a user password and log out of root user"),Object(o.b)("p",null,"An ",Object(o.b)("strong",{parentName:"p"},"erxes")," user was automatically created. Now we need a unique password."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Create a password for the ",Object(o.b)("strong",{parentName:"li"},"erxes")," user.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"passwd erxes\n")),Object(o.b)("p",null,"You will be prompted to enter and verify and password for the ",Object(o.b)("inlineCode",{parentName:"p"},"erxes")," user. It will look something like this after you finish entering a new password."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"Enter new UNIX password:\nRetype new UNIX password:\npasswd: password updated successfully\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Log out of the ",Object(o.b)("inlineCode",{parentName:"li"},"root")," user.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"exit\n")),Object(o.b)("h2",{id:"log-in-as-the-erxes-user"},"Log in as the ",Object(o.b)("inlineCode",{parentName:"h2"},"erxes")," user"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Open the terminal or command prompt on your computer. You will need your ",Object(o.b)("strong",{parentName:"li"},"IP address"),". (In this example, ",Object(o.b)("strong",{parentName:"li"},"44.123.32.12"),"). Use the following command to log in as the ",Object(o.b)("inlineCode",{parentName:"li"},"erxes")," user and use the password you created in the previous steps.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# example ssh erxes@44.123.32.12\n# erxes@44.123.32.12's password:\n\nssh root@your-ip-address\nerxes@your-ip-address's password:\n")),Object(o.b)("p",null,"After successful logging back into the server as ",Object(o.b)("inlineCode",{parentName:"p"},"erxes"),", you are ready to continue and finish the installation process for ",Object(o.b)("strong",{parentName:"p"},"erxes"),"."),Object(o.b)("h2",{id:"install-lets-encrypt-using-certbot"},"Install Let's Encrypt using Certbot"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Let's Encrypt")," enables you to use ",Object(o.b)("strong",{parentName:"p"},"HTTPS")," on your website. It will issue you a certificate which shows that you control your domain. ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.nginx.com/resources/wiki/start/topics/tutorials/install/"}),"Let's Encrypt additional information"),"."),Object(o.b)("p",null,"Execute Certbot. You will asked several questions, you can answer as follows:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Enter your email address"),Object(o.b)("li",{parentName:"ul"},"Agree with the ",Object(o.b)("strong",{parentName:"li"},"Terms of Service")),Object(o.b)("li",{parentName:"ul"},"Answer ",Object(o.b)("inlineCode",{parentName:"li"},"Yes")," or ",Object(o.b)("inlineCode",{parentName:"li"},"No"),", if you want to share your email address with the Electronic Frontier Foundation"),Object(o.b)("li",{parentName:"ul"},"Select the corresponding number associated with your domain name, usually ",Object(o.b)("inlineCode",{parentName:"li"},"1")),Object(o.b)("li",{parentName:"ul"},"Choose ",Object(o.b)("inlineCode",{parentName:"li"},"2")," to redirect all your traffic to a secure ",Object(o.b)("strong",{parentName:"li"},"HTTPS"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo certbot --nginx\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Now run the following to ",Object(o.b)("strong",{parentName:"li"},"test and set-up")," automatic renewal of your 90 day certbot. This needs to succeed so that your renewals are automatic.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo certbot renew --dry-run\n")),Object(o.b)("p",null,"Check your website in the browser. You should see the ",Object(o.b)("strong",{parentName:"p"},"Secure Padlock")," next to your URL."),Object(o.b)("h2",{id:"final-mongodb-configuration-steps"},"Final MongoDB Configuration steps"),Object(o.b)("p",null,"The script created a random password for your ",Object(o.b)("strong",{parentName:"p"},"MongoDB")," database. We need to copy it from the ",Object(o.b)("inlineCode",{parentName:"p"},"ecosystem.json")," file and set it as an ",Object(o.b)("inlineCode",{parentName:"p"},"env")," variable. This will require several steps."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"cd ~/erxes.io\nnano ecosystem.config.js\n")),Object(o.b)("p",null,"Locate the ",Object(o.b)("inlineCode",{parentName:"p"},'"MONGO_URL": "mongodb://erxes:82e3e42ef31e51d51687b366118200e2@localhost/erxes?authSource=admin&replicaSet=rs0",')," under the ",Object(o.b)("inlineCode",{parentName:"p"},"erxes-api"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Copy the MONGO_URL and exit the nano editor with ",Object(o.b)("inlineCode",{parentName:"p"},"ctrl + x"),".")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Now you will need to ",Object(o.b)("inlineCode",{parentName:"p"},"export")," and set the variable ",Object(o.b)("inlineCode",{parentName:"p"},"MONGO_URL"),", with the copied URL. See below:"))),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Example:")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),'# example\n# export MONGO_URL="mongodb://erxes:92c54fa1f0658xxxxc2d9ce618b008b4@localhost/erxes?authSource=admin&replicaSet=rs0"\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Use your copied MONGO_URL below:")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),'export MONGO_URL="YOUR_COPIED_MONGO_URL_HERE"\n'))),Object(o.b)(O,{value:"step-by-step",mdxType:"TabItem"},Object(o.b)("h2",{id:"log-into-server-as-root-and-create-erxes-user"},"Log into server as root and create erxes user"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Open the terminal or command prompt on your computer. You will need your ",Object(o.b)("strong",{parentName:"li"},"IP address"),". (In this example, ",Object(o.b)("strong",{parentName:"li"},"44.123.32.12"),"). Type ",Object(o.b)("inlineCode",{parentName:"li"},"yes"),", when asked if you want to continue connecting.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# example ssh root@44.123.32.12\nssh root@your-ip-address\n")),Object(o.b)("p",null,"(",Object(o.b)("strong",{parentName:"p"},"Note"),": Some people get an error, ",Object(o.b)("strong",{parentName:"p"},"WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!"),", please see the solution ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"/installation/ubuntu#known-issues-and-frequent-questions"}),"here"),".)"),Object(o.b)("p",null,"You don't want to use the ",Object(o.b)("strong",{parentName:"p"},"root")," user to administer your server. So everything will be done by a user called, ",Object(o.b)("strong",{parentName:"p"},"erxes"),". To accomplish this, run the following commands:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},'Add a user called "erxes". When prompted, enter in a ',Object(o.b)("strong",{parentName:"li"},"unique")," password. You will need to keep this password available, as later operations will require using it. (Finish adding the user simply by pressing the ",Object(o.b)("inlineCode",{parentName:"li"},"enter")," or ",Object(o.b)("inlineCode",{parentName:"li"},"return")," key through the questions.)")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"adduser erxes\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Grant the ",Object(o.b)("strong",{parentName:"li"},"erxes")," user adminstrative rights.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"usermod -aG sudo erxes\n")),Object(o.b)("p",null,"Your next step as ",Object(o.b)("strong",{parentName:"p"},"root")," user, is to set-up a basic firewall for your server."),Object(o.b)("h2",{id:"set-up-a-basic-firewall-for-ssh-nginx-80-and-port-443"},"Set-up a basic firewall for SSH, nginx 80 and port 443"),Object(o.b)("h3",{id:"basic-firewall---port-22"},"Basic Firewall - Port 22"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Allow OpenSSH with ",Object(o.b)("strong",{parentName:"li"},"ufw"),". OpenSSH will use ",Object(o.b)("strong",{parentName:"li"},"port 22"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"ufw allow OpenSSH\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Enable ",Object(o.b)("strong",{parentName:"li"},"ufw"),' and allow the "disrupt existing ssh connections". Type ',Object(o.b)("inlineCode",{parentName:"li"},"y"),' when asked, "',Object(o.b)("strong",{parentName:"li"},"Command may disrupt existing ssh connections. Proceed with operation (y|n)?"),'"')),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"ufw enable\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Check the ",Object(o.b)("strong",{parentName:"li"},"ufw")," status")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"ufw status\n")),Object(o.b)("p",null,"You should have an output like below:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"Status: active\n\nTo                         Action      From\n--                         ------      ----\nOpenSSH                    ALLOW       Anywhere\nOpenSSH (v6)               ALLOW       Anywhere (v6)\n")),Object(o.b)("h3",{id:"http--https---port-80--port-443"},"HTTP & HTTPS - Port 80 & Port 443"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Allow ",Object(o.b)("strong",{parentName:"li"},"HTTP")," (port 80) and ",Object(o.b)("strong",{parentName:"li"},"HTTPS")," (port 443) with ",Object(o.b)("strong",{parentName:"li"},"ufw"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"ufw allow proto tcp from any to any port 80,443\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Check the ufw status")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"ufw status\n")),Object(o.b)("p",null,"You should have an output like below:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"Status: active\n\nTo                         Action      From\n--                         ------      ----\nOpenSSH                    ALLOW       Anywhere\n80,443/tcp                 ALLOW       Anywhere\nOpenSSH (v6)               ALLOW       Anywhere (v6)\n80,443/tcp (v6)            ALLOW       Anywhere (v6)\n")),Object(o.b)("h2",{id:"allow-the-erxes-user-to-ssh-into-server"},'Allow the "erxes" user to ',Object(o.b)("strong",{parentName:"h2"},"SSH")," into server"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"open the ",Object(o.b)("inlineCode",{parentName:"li"},"sshd_config")," file to edit")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"nano /etc/ssh/ssh_config\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Scroll down until you see ",Object(o.b)("inlineCode",{parentName:"li"},"PasswordAuthentication"),". Change it from ",Object(o.b)("inlineCode",{parentName:"li"},"PasswordAuthentication no")," to ",Object(o.b)("inlineCode",{parentName:"li"},"PasswordAuthentication yes"),". ",Object(o.b)("strong",{parentName:"li"},"NOTE"),": Some servers have this line commented out with a ",Object(o.b)("inlineCode",{parentName:"li"},"#"),", like ",Object(o.b)("inlineCode",{parentName:"li"},"# PasswordAuthentication no"),". You will need to uncomment it by deleting the ",Object(o.b)("inlineCode",{parentName:"li"},"#"),".")),Object(o.b)("p",null,"The line should look like this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"PasswordAuthentication yes\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Save and exit with ",Object(o.b)("inlineCode",{parentName:"p"},"ctrl + x")," and then ",Object(o.b)("inlineCode",{parentName:"p"},"y")," to accept the changes.")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Reload the SSH config file"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo service sshd reload\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Exit from server, so that you can log back in as the ",Object(o.b)("strong",{parentName:"li"},"erxes")," user")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"exit\n")),Object(o.b)("p",null,'You have created a new user called, "erxes" and you set-up a basic firewall to protect your server against malicious attacks.'),Object(o.b)("p",null,"Please continue with the following steps to log in to your server as the ",Object(o.b)("strong",{parentName:"p"},"erxes")," user."),Object(o.b)("h2",{id:"log-in-to-your-server-as-the-erxes-user"},'Log in to your server as the "erxes" user.'),Object(o.b)("p",null,"Before you can log into your new server, we need to ",Object(o.b)("strong",{parentName:"p"},"add the SSH key")," to your ",Object(o.b)("strong",{parentName:"p"},"local")," computer."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"NOTE:")," You need to use the ",Object(o.b)("strong",{parentName:"p"},"IP address")," of your server."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Run the following command and ",Object(o.b)("strong",{parentName:"li"},"create a new password"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"#ssh-copy-id erxes@44.123.32.12 <--- This is an example. Use your ip address\nssh-copy-id erxes@your-IP-address\n")),Object(o.b)("p",null,"Now you can log into your server as the ",Object(o.b)("strong",{parentName:"p"},"erxes")," user."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Log back into the server as the ",Object(o.b)("strong",{parentName:"li"},"erxes")," user. You will need your IP address. (In this example, ",Object(o.b)("strong",{parentName:"li"},"44.123.32.12"),"). Enter your previously created password, if prompted.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# example ssh erxes@44.123.32.12 <--- This is an example. Use your ip address\nssh erxes@your-ip-address\n")),Object(o.b)("p",null,"In the following sections, you will install software dependencies that are needed to run ",Object(o.b)("strong",{parentName:"p"},"erxes"),"."),Object(o.b)("h2",{id:"nvm-install"},"Nvm install"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Node Version Manage (nvm)")," is a tool that allows you to download and install ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://nodejs.org/"}),"Node.js"),". You can read more about the installation process here: ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://gist.github.com/d2s/372b5943bce17b964a79"}),"How to install NVM")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"nvm")," and initialize by reloading the shell configuration.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.35.3/install.sh | bash\nsource ~/.bashrc\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Verify ",Object(o.b)("strong",{parentName:"li"},"nvm")," is installed by running:")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"nvm --version\n")),Object(o.b)("p",null,"You should get a similar output as below:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"0.35.3\n# your version of nvm may be different\n")),Object(o.b)("p",null,"You are ready to continue with installing ",Object(o.b)("strong",{parentName:"p"},"Node.js"),"."),Object(o.b)("h2",{id:"install-nodejs-with-nvm"},"Install Node.js with nvm"),Object(o.b)("p",null,"You can read more about installing ",Object(o.b)("strong",{parentName:"p"},"Node.js")," with ",Object(o.b)("strong",{parentName:"p"},"nvm")," here: ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://gist.github.com/d2s/372b5943bce17b964a79#install-nodejs-with-nvm"}),"How to install Node.js with NVM")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"Node.js"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"nvm install --lts\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Check to see if ",Object(o.b)("strong",{parentName:"li"},"Node.js")," is installed correctly.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"node -v\n")),Object(o.b)("p",null,"You should get a similar output as below:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"v12.18.3\n# your version of node.js may be different\n")),Object(o.b)("p",null,"With ",Object(o.b)("strong",{parentName:"p"},"Node.js")," installed, you can continue with installing ",Object(o.b)("strong",{parentName:"p"},"Yarn"),"."),Object(o.b)("h2",{id:"yarn-install"},"Yarn install"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Yarn")," is a package manager. The alternative is ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.npmjs.com/"}),"npm"),". We recommend ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://yarnpkg.com/"}),"yarn"),". For additional ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://classic.yarnpkg.com/en/docs/install/#debian-stable"}),"yarn installation instructions, read this"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"yarn"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list\nsudo apt update && sudo apt install --no-install-recommends yarn\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Check to see if ",Object(o.b)("strong",{parentName:"li"},"yarn")," is installed correctly")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"yarn --version\n")),Object(o.b)("p",null,"You should get a similar output as below:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"1.22.4\n# your version of yarn may be different\n")),Object(o.b)("p",null,"As long as you received a version response to ",Object(o.b)("inlineCode",{parentName:"p"},"yarn --version"),", then you can continue and install ",Object(o.b)("strong",{parentName:"p"},"MongoDB"),"."),Object(o.b)("h2",{id:"install-mongodb"},"Install MongoDB"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"MongoDB")," is a robust and general purpose document-based database. For additional ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.mongodb.com/manual/tutorial/install-mongodb-on-ubuntu/"}),"MongoDB installation instructions, read this"),"."),Object(o.b)("p",null,"Erxes supports MongoDB version 3.6+ is supported. Previous versions are not supported."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"MongoDB"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'wget -qO - https://www.mongodb.org/static/pgp/server-4.2.asc | sudo apt-key add -\necho "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu bionic/mongodb-org/4.2 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-4.2.list\nsudo apt-get update\nsudo apt-get install -y mongodb-org\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Start and enable ",Object(o.b)("strong",{parentName:"li"},"MongoDB"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo systemctl start mongod\nsudo systemctl enable mongod\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Check to see if ",Object(o.b)("strong",{parentName:"li"},"MongoDB")," is installed correctly")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"mongod --version\n")),Object(o.b)("p",null,"As long as you received a version response to ",Object(o.b)("inlineCode",{parentName:"p"},"mongod --version"),", then you can continue below."),Object(o.b)("h3",{id:"deploy-a-mongodb-replica-set"},"Deploy a MongoDB Replica Set"),Object(o.b)("p",null,"MongoDB ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.mongodb.com/manual/reference/glossary/#term-replica-set"}),"replica sets")," add an extra layer of redundancy and help with load balancing. They are a group of ",Object(o.b)("strong",{parentName:"p"},"mongod processes")," that maintain matching data sets. You can read about ",Object(o.b)("strong",{parentName:"p"},"replication")," ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://docs.mongodb.com/manual/replication/"}),"here"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Stop the ",Object(o.b)("strong",{parentName:"li"},"mongod")," processes")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo systemctl stop mongod\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Open ",Object(o.b)("strong",{parentName:"li"},"mongod.conf"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo nano /etc/mongod.conf\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Enable the ",Object(o.b)("strong",{parentName:"li"},"replicaset")," settings, by searching for ",Object(o.b)("inlineCode",{parentName:"li"},"#replication"),". Remove the ",Object(o.b)("inlineCode",{parentName:"li"},"#")," to activate it and edit to include the set name, as follows:")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'replication:\n  replSetName: "rs0"\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Save and Exit with ",Object(o.b)("inlineCode",{parentName:"p"},"ctrl + x")," and then ",Object(o.b)("inlineCode",{parentName:"p"},"y")," to accept the changes.")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Restart mongob"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo systemctl start mongod\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Connect to mongo shell")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"mongo\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Initialize replicaSet")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"rs.initiate()\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"You should have an output similar to below. Verify ",Object(o.b)("strong",{parentName:"li"},"SECONDARY")," changes to ",Object(o.b)("strong",{parentName:"li"},"Primary")," by pressing enter several times.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'{\n    "info2" : "no configuration specified. Using a default configuration for the set",\n    "me" : "127.0.0.1:27017",\n    "ok" : 1,\n    "$clusterTime" : {\n        "clusterTime" : Timestamp(1594140533, 1),\n        "signature" : {\n            "hash" : BinData(0,"AAAAAAAAAAAAAAAAAAAAAAAAAAA="),\n            "keyId" : NumberLong(0)\n        }\n    },\n    "operationTime" : Timestamp(1594140533, 1)\n}\n\nrs0:SECONDARY>\nrs0:PRIMARY> # <----- This is what you are looking for\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"press ",Object(o.b)("inlineCode",{parentName:"li"},"ctrl-c")," to quit mongo")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"rs0:PRIMARY>\nbye\n")),Object(o.b)("p",null,"If you were able to return to the command line prompt. Then you may continue with the installation of ",Object(o.b)("strong",{parentName:"p"},"Redis"),"."),Object(o.b)("h2",{id:"install-redis"},"Install Redis"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Redis")," is an in memory quick-response database. For additional ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.digitalocean.com/community/tutorials/how-to-install-and-secure-redis-on-ubuntu-18-04"}),"Redis installation instructions, read this"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"redis"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo apt-get install -y redis-server\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Check to see if ",Object(o.b)("strong",{parentName:"li"},"redis")," is installed correctly.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo systemctl status redis\n")),Object(o.b)("p",null,"You should get an output similar to this"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"\u25cf redis-server.service - Advanced key-value store\n   Loaded: loaded (/lib/systemd/system/redis-server.service; enabled; vendor preset: enabled)\n   Active: active (running) since Wed 2020-07-08 20:39:33 UTC; 10s ago\n     Docs: http://redis.io/documentation,\n           man:redis-server(1)\n Main PID: 15778 (redis-server)\n    Tasks: 4 (limit: 4915)\n   CGroup: /system.slice/redis-server.service\n           \u2514\u250015778 /usr/bin/redis-server 127.0.0.1:6379\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Type ",Object(o.b)("inlineCode",{parentName:"li"},"ctrl + c")," to quit")),Object(o.b)("p",null,"Providing you got ",Object(o.b)("strong",{parentName:"p"},"Active: active (running)")," output for ",Object(o.b)("strong",{parentName:"p"},"Redis")," you may now continue with the next steps."),Object(o.b)("h2",{id:"install-rabbitmq-and-dependencies"},"Install RabbitMQ and dependencies"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"RabbitMQ")," is a message broker. It is used to relay messages to and from two other applications. For additional ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.rabbitmq.com/install-debian.html#apt-packagecloud"}),"RabbitMQ installation instructions, read this"),"."),Object(o.b)("h3",{id:"install-erlang-22x"},"Install Erlang 22.x"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Erlang")," is the programming language that ",Object(o.b)("strong",{parentName:"p"},"RabbitMQ")," is written in. It must be installed when you install ",Object(o.b)("strong",{parentName:"p"},"RabbitMQ"),". For additional information about ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.rabbitmq.com/install-debian.html#apt-bintray-erlang"}),"installing Erlang, read this"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"Erlang"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"curl -fsSL https://github.com/rabbitmq/signing-keys/releases/download/2.0/rabbitmq-release-signing-key.asc | sudo apt-key add -\nsudo apt-get install apt-transport-https\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Create the ",Object(o.b)("inlineCode",{parentName:"li"},"bintray.erlang.list")," file and write to the ",Object(o.b)("inlineCode",{parentName:"li"},"/etc/apt/sources.list.d")," directory.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo touch /etc/apt/sources.list.d/bintray.erlang.list\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Open the ",Object(o.b)("inlineCode",{parentName:"li"},"bintray.erlang.list")," file.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo nano /etc/apt/sources.list.d/bintray.erlang.list\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Now copy the following text to the open ",Object(o.b)("inlineCode",{parentName:"li"},"bintray.erlang.list")," file")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-txt"}),"# This repository provides Erlang packages produced by the RabbitMQ team\n# See below for supported distribution and component values\ndeb https://dl.bintray.com/rabbitmq-erlang/debian bionic erlang-22.x\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Save and exit with ",Object(o.b)("inlineCode",{parentName:"p"},"ctrl + x")," and then ",Object(o.b)("inlineCode",{parentName:"p"},"y")," to accept the changes.")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Verify that you have properly added the above text to the proper file."))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo cat /etc/apt/sources.list.d/bintray.erlang.list\n")),Object(o.b)("p",null,"The output should match the above pasted text."),Object(o.b)("h3",{id:"update-all-packages"},"Update all packages"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Update and list of ",Object(o.b)("inlineCode",{parentName:"li"},"apt")," sources")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo apt-get update\n")),Object(o.b)("p",null,"Metapackages such as erlang and erlang-nox must only be used with apt version pinning. They do not pin their dependency versions. The following steps are recommended."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"Erlang")," packages.")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"NOTE:")," COPY THE ENTIRE CODE BLOCK AS ONE COMMAND."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo apt-get install -y erlang-base \\\n    erlang-asn1 erlang-crypto erlang-eldap erlang-ftp erlang-inets \\\n    erlang-mnesia erlang-os-mon erlang-parsetools erlang-public-key \\\n    erlang-runtime-tools erlang-snmp erlang-ssl \\\n    erlang-syntax-tools erlang-tftp erlang-tools erlang-xmerl\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Verify ",Object(o.b)("strong",{parentName:"li"},"Erlang")," installation")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"erl\n")),Object(o.b)("p",null,"You should get an output similar to the following:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"Erlang/OTP 22 [erts-10.7.2.1] [source] [64-bit] [smp:4:4] [ds:4:4:10] [async-threads:1]\n\nEshell V10.7.2.1  (abort with ^G)\n1>    # halt(). to exit\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"type ",Object(o.b)("inlineCode",{parentName:"li"},"halt().")," to exit from ",Object(o.b)("strong",{parentName:"li"},"Erlang")," in the terminal.")),Object(o.b)("p",null,"You have now installed the ",Object(o.b)("strong",{parentName:"p"},"dependencies")," for ",Object(o.b)("strong",{parentName:"p"},"RabbitMQ"),". Continue with the following steps."),Object(o.b)("h3",{id:"install-rabbitmq"},"Install RabbitMQ"),Object(o.b)("p",null,"The following steps will install RabbitMQ."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"RabbitMQ")," by importing a signing key from ",Object(o.b)("a",Object(a.a)({parentName:"li"},{href:"https://packagecloud.io/rabbitmq"}),"PackageCloud"),", add the PackageCloud repo, and ",Object(o.b)("strong",{parentName:"li"},"install rabbitmq-server"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'wget -O - "https://packagecloud.io/rabbitmq/rabbitmq-server/gpgkey" | sudo apt-key add -\ncurl -s https://packagecloud.io/install/repositories/rabbitmq/rabbitmq-server/script.deb.sh | sudo bash\nsudo apt-get install -y rabbitmq-server\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Enable and start the ",Object(o.b)("strong",{parentName:"li"},"RabbitMQ")," server")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo systemctl enable rabbitmq-server\nsudo systemctl start rabbitmq-server\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Verify ",Object(o.b)("strong",{parentName:"li"},"RabbitMQ")," is properly installed and running.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo service rabbitmq-server status\n")),Object(o.b)("p",null,"You should see similar output to the following:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'\u25cf rabbitmq-server.service - RabbitMQ broker\n   Loaded: loaded (/lib/systemd/system/rabbitmq-server.service; enabled; vendor preset: enabled)\n   Active: active (running) since Wed 2020-07-08 21:11:16 UTC; 1min 21s ago\n Main PID: 18883 (beam.smp)\n   Status: "Initialized"\n    Tasks: 91 (limit: 4915)\n   CGroup: /system.slice/rabbitmq-server.service\n           \u251c\u250018883 /usr/lib/erlang/erts-10.7.2.1/bin/beam.smp -W w -K true -A 64 -MBas ageffcbf -MHas\n           \u251c\u250019000 erl_child_setup 32768\n           \u251c\u250019030 /usr/lib/erlang/erts-10.7.2.1/bin/epmd -daemon\n           \u251c\u250019058 inet_gethost 4\n           \u2514\u250019059 inet_gethost 4\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"You can exit with ",Object(o.b)("inlineCode",{parentName:"li"},"ctrl + c"))),Object(o.b)("p",null,"If you see output similar to the above, then you are ready to continue and go onto installing ",Object(o.b)("strong",{parentName:"p"},"Elasticsearch"),"."),Object(o.b)("h2",{id:"install-elasticsearch"},"Install Elasticsearch"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Elasticsearch")," is a search feature that allows you to search for data in real time. For additional ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.elastic.co/guide/en/elasticsearch/reference/current/deb.html"}),"Elasticsearch installation instructions, read this"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"Elasticsearch"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -\necho "deb https://artifacts.elastic.co/packages/7.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-7.x.list\nsudo apt-get update && sudo apt-get install elasticsearch\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Enable ",Object(o.b)("strong",{parentName:"li"},"Elasticsearch")," with the following commands")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo /bin/systemctl daemon-reload\nsudo /bin/systemctl enable elasticsearch.service\nsudo systemctl start elasticsearch.service\n\n# can take a minute\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Verify ",Object(o.b)("strong",{parentName:"li"},"Elasticsearch")," is installed by testing the response")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"curl localhost:9200\n")),Object(o.b)("p",null,"You should get output similar to this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "name": "localhost",\n  "cluster_name": "elasticsearch",\n  "cluster_uuid": "CUntMmpoRTiLfCU_nTCeJg",\n  "version": {\n    "number": "7.8.0",\n    "build_flavor": "default",\n    "build_type": "deb",\n    "build_hash": "757314695644ea9a1dc2fecd26d1a43856725e65",\n    "build_date": "2020-06-14T19:35:50.234439Z",\n    "build_snapshot": false,\n    "lucene_version": "8.5.1",\n    "minimum_wire_compatibility_version": "6.8.0",\n    "minimum_index_compatibility_version": "6.0.0-beta1"\n  },\n  "tagline": "You Know, for Search"\n}\n')),Object(o.b)("p",null,"If the ",Object(o.b)("inlineCode",{parentName:"p"},"curl")," command outputted simlar output as above, then you are ready to configure your ",Object(o.b)("strong",{parentName:"p"},"NGINX")," proxy server."),Object(o.b)("h2",{id:"install-and-configure-nginx"},"Install and configure NGINX"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"NGINX")," is a very powerful web server. It is often used as a proxy server for emails. For additional ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.nginx.com/resources/wiki/start/topics/tutorials/install/"}),"NGINX installation instructions, read this"),"."),Object(o.b)("p",null,"NGINX is installed from the stable repo ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://launchpad.net/~nginx/+archive/ubuntu/stable"}),"https://launchpad.net/~nginx/+archive/ubuntu/stable"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Add the ",Object(o.b)("strong",{parentName:"li"},"PPA")," for ",Object(o.b)("strong",{parentName:"li"},"NGINX"),". Press ",Object(o.b)("inlineCode",{parentName:"li"},"enter")," when prompted to continue.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo add-apt-repository ppa:nginx/stable\nsudo apt-get update\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"NGINX")," with the following commands.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo apt-get install -y nginx\n")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"NGINX")," started by default when you installed it. But it is recommended to ",Object(o.b)("inlineCode",{parentName:"p"},"enable")," and ",Object(o.b)("inlineCode",{parentName:"p"},"start")," anyway."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Enable and start ",Object(o.b)("strong",{parentName:"li"},"NGINX"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo systemctl enable nginx\nsudo systemctl start nginx\n")),Object(o.b)("h2",{id:"configure-nginx"},"Configure NGINX"),Object(o.b)("p",null,"The next step is to configure ",Object(o.b)("strong",{parentName:"p"},"NGINX")," so that it allows traffic through ",Object(o.b)("inlineCode",{parentName:"p"},"Ports 80 and 443"),"."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Ensure the ",Object(o.b)("inlineCode",{parentName:"li"},"ufw")," firewall knows about the available applications.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo ufw app list\n")),Object(o.b)("p",null,"You are expecting the following output:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"Available applications:\n  Nginx Full\n  Nginx HTTP\n  Nginx HTTPS\n  OpenSSH\n")),Object(o.b)("p",null,"The output should look something like the ",Object(o.b)("inlineCode",{parentName:"p"},"Available applications")," output above. ",Object(o.b)("inlineCode",{parentName:"p"},"Nginx Full")," should be listed."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Enable Port 80 and Port 443 to allow traffic.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo ufw allow 'Nginx Full'\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Verify that ",Object(o.b)("inlineCode",{parentName:"li"},"ufw")," has been updated.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo ufw status\n")),Object(o.b)("p",null,"You are expecting the following output."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"Status: active\n\nTo                         Action      From\n--                         ------      ----\nOpenSSH                    ALLOW       Anywhere\n80,443/tcp                 ALLOW       Anywhere\nNginx Full                 ALLOW       Anywhere\nOpenSSH (v6)               ALLOW       Anywhere (v6)\n80,443/tcp (v6)            ALLOW       Anywhere (v6)\nNginx Full (v6)            ALLOW       Anywhere (v6)\n")),Object(o.b)("p",null,"Your output should match the above output. Providing your output matches the above, you may continue to configuring ",Object(o.b)("strong",{parentName:"p"},"NGINX"),"."),Object(o.b)("h3",{id:"configure-nginx-1"},"Configure NGINX"),Object(o.b)("p",null,"The next step is to create a server block with the correct directives to work with the erxes installation."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Create a new file in the correct directory, and name it your domain name. For example, if your domain name is ",Object(o.b)("inlineCode",{parentName:"li"},"erxes.example.com"),", name the file, ",Object(o.b)("inlineCode",{parentName:"li"},"erxes.example.com"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# example: sudo nano /etc/nginx/sites-available/erxes.example.com\nsudo nano /etc/nginx/sites-available/YOUR-DOMAIN-NAME\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Copy the below ",Object(o.b)("strong",{parentName:"li"},"NGINX server block")," into the open file. ",Object(o.b)("strong",{parentName:"li"},"DO NOT SAVE THE FILE")," until you replace the ",Object(o.b)("inlineCode",{parentName:"li"},"YOUR_DOMAIN_COM")," with your actual ",Object(o.b)("inlineCode",{parentName:"li"},"domain name"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-txt"}),"server {\n        listen 80;\n\n        # your domain name here\n        # for example, server_name erxes.example.com;\n        server_name YOUR_DOMAIN_COM;\n\n        # erxes build path\n        root /home/erxes/erxes.io/erxes/build;\n        index index.html;\n\n        error_log /var/log/nginx/erxes.error.log;\n        access_log /var/log/nginx/erxes.access.log;\n\n        location / {\n                root /home/erxes/erxes.io/erxes/build;\n                index index.html;\n                try_files $uri /index.html;\n        }\n\n        # widgets is running on 3200 port.\n        location /widgets/ {\n                proxy_pass http://127.0.0.1:3200/;\n                proxy_set_header Host $http_host;\n                proxy_set_header X-Real-IP $remote_addr;\n                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n                proxy_http_version 1.1;\n        }\n\n        # api project is running on 3300 port.\n        location /api/ {\n                proxy_pass http://127.0.0.1:3300/;\n                # proxy_set_header Host $http_host;\n                proxy_set_header X-Real-IP $remote_addr;\n                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n                proxy_http_version 1.1;\n                proxy_set_header Upgrade $http_upgrade;\n                # proxy_set_header Connection \"Upgrade\";\n                proxy_set_header Connection 'upgrade';\n                proxy_set_header Host $host;\n        }\n        # erxes integrations project is running on 3400 port.\n        location /integrations/ {\n                proxy_pass http://127.0.0.1:3400/;\n                proxy_set_header Host $http_host;\n                proxy_set_header X-Real-IP $remote_addr;\n                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n                proxy_http_version 1.1;\n        }\n}\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"After replacing ",Object(o.b)("inlineCode",{parentName:"li"},"YOUR_DOMAIN_COM")," with your actual domain name. Save with ",Object(o.b)("inlineCode",{parentName:"li"},"ctrl + x")," and then ",Object(o.b)("inlineCode",{parentName:"li"},"y")," to accept the changes."),Object(o.b)("li",{parentName:"ul"},"Enable the file by creating a link form it to ",Object(o.b)("strong",{parentName:"li"},"sites-enabled"),". Make sure to ",Object(o.b)("strong",{parentName:"li"},"use your domain name")," exactly as you created the file above. ",Object(o.b)("strong",{parentName:"li"},"Replace")," ",Object(o.b)("inlineCode",{parentName:"li"},"YOUR_DOMAIN_COM")," ",Object(o.b)("strong",{parentName:"li"},"with your actual domain name."))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo ln -s /etc/nginx/sites-available/YOUR_DOMAIN_COM /etc/nginx/sites-enabled/\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Open the ",Object(o.b)("strong",{parentName:"li"},"nginx.conf"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo nano /etc/nginx/nginx.conf\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Uncomment the following line ",Object(o.b)("inlineCode",{parentName:"li"},"server_names_hash_bucket_size 64;"))),Object(o.b)("p",null,"It should look like this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-txt"}),"http {\n    * * *\n\n    server_names_hash_bucket_size 64;\n\n    * * *\n}\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Save with ",Object(o.b)("inlineCode",{parentName:"p"},"ctrl + x")," and then ",Object(o.b)("inlineCode",{parentName:"p"},"y")," to accept the changes.")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Test the ",Object(o.b)("strong",{parentName:"p"},"NGINX")," configuration to make sure you don't have any errors"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo nginx -t\n")),Object(o.b)("p",null,"You should see the following output:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"nginx: the configuration file /etc/nginx/nginx.conf syntax is ok\nnginx: configuration file /etc/nginx/nginx.conf test is successful\n")),Object(o.b)("p",null,"If you got no errors, reload nginx service."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo systemctl reload nginx\n")),Object(o.b)("p",null,"Now you are ready to install the SSL Certificates using ",Object(o.b)("strong",{parentName:"p"},"Let's Encrypt")," and ",Object(o.b)("strong",{parentName:"p"},"Certbot"),"."),Object(o.b)("h2",{id:"install-lets-encrypt-using-certbot-1"},"Install Let's Encrypt using Certbot"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Let's Encrypt")," enables you to use ",Object(o.b)("strong",{parentName:"p"},"HTTPS")," on your website. It will issue you a certificate which shows that you control your domain. ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://www.nginx.com/resources/wiki/start/topics/tutorials/install/"}),"Let's Encrypt additional information"),"."),Object(o.b)("p",null,"You will follow the installation instructions as covered ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://certbot.eff.org/lets-encrypt/ubuntubionic-nginx"}),"here"),", with ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://certbot.eff.org/"}),"Certbot")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"You will need to add a ",Object(o.b)("strong",{parentName:"li"},"Certbot")," PPA to the list of repositories on the server.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo apt-get update\nsudo apt-get -y install software-properties-common\nsudo add-apt-repository universe\nsudo add-apt-repository -y ppa:certbot/certbot\nsudo apt-get update\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install Certbot")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo apt-get install -y certbot python3-certbot-nginx\n")),Object(o.b)("p",null,"Execute Certbot. You will asked several questions, you can answer as follows:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Enter your email address"),Object(o.b)("li",{parentName:"ul"},"Agree with the ",Object(o.b)("strong",{parentName:"li"},"Terms of Service")),Object(o.b)("li",{parentName:"ul"},"Answer ",Object(o.b)("inlineCode",{parentName:"li"},"Yes")," or ",Object(o.b)("inlineCode",{parentName:"li"},"No"),", if you want to share your email address with the Electronic Frontier Foundation"),Object(o.b)("li",{parentName:"ul"},"Select the corresponding number associated with your domain name, usually ",Object(o.b)("inlineCode",{parentName:"li"},"1")),Object(o.b)("li",{parentName:"ul"},"Choose ",Object(o.b)("inlineCode",{parentName:"li"},"2")," to redirect all your traffic to a secure ",Object(o.b)("strong",{parentName:"li"},"HTTPS"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo certbot --nginx\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Now run the following to ",Object(o.b)("strong",{parentName:"li"},"test and set-up")," automatic renewal of your 90 day certbot. This needs to succeed so that your renewals are automatic.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sudo certbot renew --dry-run\n")),Object(o.b)("p",null,"Check your website in the browser. You should see the ",Object(o.b)("strong",{parentName:"p"},"Secure Padlock")," next to your URL. You are now ready to move onto the final steps to install ",Object(o.b)("strong",{parentName:"p"},"erxes")," itself."),Object(o.b)("h2",{id:"install-erxes"},"Install erxes"),Object(o.b)("p",null,"All the dependencies for ",Object(o.b)("strong",{parentName:"p"},"erxes")," are now installed. You have also configured your server. Follow these remaining steps to complete the installation of ",Object(o.b)("strong",{parentName:"p"},"erxes"),"."),Object(o.b)("h3",{id:"download-extract-and-install-each-of-the-erxes-components"},"Download, extract and install each of the erxes components"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Create the empty folder directories for the installation of erxes.")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"NOTE:")," COPY THE ENTIRE CODE BLOCK AS ONE COMMAND."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"mkdir -p ~/erxes.io/erxes \\\n -p ~/erxes.io/erxes-api\\\n -p ~/erxes.io/erxes-crons \\\n -p ~/erxes.io/erxes-workers \\\n -p ~/erxes.io/erxes-widgets \\\n -p ~/erxes.io/erxes-logger \\\n -p ~/erxes.io/erxes-engages-email-sender \\\n -p ~/erxes.io/erxes-email-verifier \\\n -p ~/erxes.io/erxes-integrations \\\n -p ~/erxes.io/erxes-elkSyncer\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Individually download and extract each of these 8 packages. (These commands place them in the proper installation directories.)")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"NOTE:")," COPY THE ENTIRE CODE BLOCK AS ONE COMMAND."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"curl -L https://github.com/erxes/erxes/releases/download/0.16.0/erxes-0.16.0.tar.gz | tar -xz -C ~/erxes.io/erxes/ \\\n    && curl -L https://github.com/erxes/erxes/releases/download/0.16.0/erxes-widgets-0.16.0.tar.gz | tar -xz -C ~/erxes.io/erxes-widgets/ \\\n    && curl -L https://github.com/erxes/erxes-api/releases/download/0.16.2/erxes-api-0.16.2.tar.gz | tar -xz -C ~/erxes.io/erxes-api/ \\\n    && curl -L https://github.com/erxes/erxes-api/releases/download/0.15.5/erxes-email-verifier-0.15.5.tar.gz | tar -xz -C ~/erxes.io/erxes-email-verifier/ \\\n    && curl -L https://github.com/erxes/erxes-api/releases/download/0.15.5/erxes-engages-email-sender-0.15.5.tar.gz | tar -xz -C ~/erxes.io/erxes-engages-email-sender/ \\\n    && curl -L https://github.com/erxes/erxes-api/releases/download/0.15.5/erxes-logger-0.15.5.tar.gz | tar -xz -C ~/erxes.io/erxes-logger/ \\\n    && curl -L https://github.com/erxes/erxes-integrations/releases/download/0.16.0/erxes-integrations-0.16.0.tar.gz | tar -xz -C ~/erxes.io/erxes-integrations/ \\\n    && curl -L https://github.com/erxes/erxes-api/releases/download/0.15.5/erxes-elksyncer-0.15.5.tar.gz | tar -xz -C ~/erxes.io/erxes-elkSyncer\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install package dependencies (using ",Object(o.b)("inlineCode",{parentName:"li"},"yarn install"),") required for the packages that make up ",Object(o.b)("strong",{parentName:"li"},"erxes"),".")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"NOTE:")," COPY THE ENTIRE CODE BLOCK AS ONE COMMAND."),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"NOTE:")," This step can take a few minutes to complete."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"cd ~/erxes.io/erxes-widgets && yarn install \\\n    && cd ~/erxes.io/erxes-api && yarn install \\\n    && cd ~/erxes.io/erxes-email-verifier && yarn install \\\n    && cd ~/erxes.io/erxes-engages-email-sender && yarn install \\\n    && cd ~/erxes.io/erxes-logger && yarn install \\\n    && cd ~/erxes.io/erxes-integrations && yarn install \\\n    && cd ~\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install and configure the ",Object(o.b)("strong",{parentName:"li"},"elkSyncer")," package, following these commands.")),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"Run these commands one by one"),"."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'cd ~/erxes.io/erxes-elkSyncer/elkSyncer\nsudo apt -y install python3-pip\npip3 install -r requirements.txt\npip3 install --upgrade -r requirements.txt\nsudo mkdir -p /var/log/mongo-connector/\nsudo chown -R erxes:erxes /var/log/mongo-connector/\nexport PATH="$HOME/.local/bin:$PATH"\n')),Object(o.b)("p",null,"After successfully each of the above packages, you may continue and install ",Object(o.b)("strong",{parentName:"p"},"PM2"),"."),Object(o.b)("h2",{id:"install-pm2"},"Install PM2"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"PM2")," is a tool that helps you manage and keep ",Object(o.b)("strong",{parentName:"p"},"erxes")," online. It is a process manager. You can read more about the installation process here: ",Object(o.b)("a",Object(a.a)({parentName:"p"},{href:"https://pm2.keymetrics.io/docs/usage/quick-start/"}),"How to install PM2")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Install ",Object(o.b)("strong",{parentName:"li"},"PM2"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"npm install pm2@latest -g\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Check to see if ",Object(o.b)("strong",{parentName:"li"},"PM2")," is installed correctly.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"pm2 --version\n")),Object(o.b)("p",null,"You should get a similar output as below:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"4.4.0\n# your version of pm2 may be different\n")),Object(o.b)("p",null,"You should receive a response from ",Object(o.b)("inlineCode",{parentName:"p"},"pm2 --version"),". The version should show as last line. You will need ",Object(o.b)("strong",{parentName:"p"},"PM2")," later in the installation process. For now, continue on with the next steps to install ",Object(o.b)("strong",{parentName:"p"},"Yarn"),"."),Object(o.b)("h3",{id:"configure-pm2-ecosystemconfigjs"},"Configure PM2 ",Object(o.b)("inlineCode",{parentName:"h3"},"ecosystem.config.js")),Object(o.b)("p",null,"In the following steps, you will ",Object(o.b)("strong",{parentName:"p"},"copy")," and ",Object(o.b)("strong",{parentName:"p"},"create")," an ",Object(o.b)("inlineCode",{parentName:"p"},"ecosystem.config.js")," file that ",Object(o.b)("strong",{parentName:"p"},"PM2")," uses to manage the processes behind ",Object(o.b)("strong",{parentName:"p"},"erxes"),". ",Object(o.b)("strong",{parentName:"p"},"Before it will work, you need to provide your exact URL and a password to encrypt all the communication between your front-end and your server.")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Create and open a new ",Object(o.b)("inlineCode",{parentName:"li"},"ecosystem.config.js")," file.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"cd ~/erxes.io\nnano ecosystem.config.js\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Copy the following content into the file. ",Object(o.b)("strong",{parentName:"li"},"SAVE THE FILE AS-IS WITHOUT ANY CHANGES","*"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),'module.exports = {\n  apps: [\n    {\n      name: "erxes-api",\n      script: "dist",\n      cwd: "/home/erxes/erxes.io/erxes-api",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      node_args: "--max_old_space_size=4096",\n      env: {\n        PORT: 3300,\n        NODE_ENV: "production",\n        JWT_TOKEN_SECRET: "YOUR_SECRET_TOKEN",\n        DEBUG: "erxes-api:*",\n        MONGO_URL: "mongodb://localhost/erxes",\n        REDIS_HOST: "localhost",\n        REDIS_PORT: 6379,\n        REDIS_PASSWORD: "",\n        RABBITMQ_HOST: "amqp://localhost",\n        ELASTICSEARCH_URL: "http://localhost:9200",\n        MAIN_APP_DOMAIN: "https://YOUR_DOMAIN_COM",\n        WIDGETS_DOMAIN: "https://YOUR_DOMAIN_COM/widgets",\n        INTEGRATIONS_API_DOMAIN: "https://YOUR_DOMAIN_COM/integrations",\n      },\n    },\n    {\n      name: "erxes-cronjobs",\n      script: "dist/cronJobs",\n      cwd: "/home/erxes/erxes.io/erxes-api",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      node_args: "--max_old_space_size=4096",\n      env: {\n        PORT_CRONS: 3600,\n        NODE_ENV: "production",\n        PROCESS_NAME: "crons",\n        DEBUG: "erxes-crons:*",\n        MONGO_URL: "mongodb://localhost/erxes",\n        REDIS_HOST: "localhost",\n        REDIS_PORT: 6379,\n        REDIS_PASSWORD: "",\n        RABBITMQ_HOST: "amqp://localhost",\n      },\n    },\n    {\n      name: "erxes-workers",\n      script: "dist/workers",\n      cwd: "/home/erxes/erxes.io/erxes-api",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      node_args: "--max_old_space_size=4096",\n      env: {\n        PORT_WORKERS: 3700,\n        NODE_ENV: "production",\n        DEBUG: "erxes-workers:*",\n        MONGO_URL: "mongodb://localhost/erxes",\n        REDIS_HOST: "localhost",\n        REDIS_PORT: 6379,\n        REDIS_PASSWORD: "",\n        RABBITMQ_HOST: "amqp://localhost",\n        JWT_TOKEN_SECRET: "YOUR_SECRET_TOKEN",\n      },\n    },\n    {\n      name: "erxes-widgets",\n      script: "dist",\n      cwd: "/home/erxes/erxes.io/erxes-widgets",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      node_args: "--max_old_space_size=4096",\n      env: {\n        PORT: 3200,\n        NODE_ENV: "production",\n        ROOT_URL: "https://YOUR_DOMAIN_COM/widgets",\n        API_URL: "https://YOUR_DOMAIN_COM/api",\n        API_SUBSCRIPTIONS_URL: "wss://YOUR_DOMAIN_COM/api/subscriptions",\n      },\n    },\n    {\n      name: "erxes-engages",\n      script: "dist",\n      cwd: "/home/erxes/erxes.io/erxes-engages-email-sender",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      node_args: "--max_old_space_size=4096",\n      env: {\n        PORT: 3900,\n        NODE_ENV: "production",\n        DEBUG: "erxes-engages:*",\n        MAIN_API_DOMAIN: "https://YOUR_DOMAIN_COM/api",\n        MONGO_URL: "mongodb://localhost/erxes_engages",\n        RABBITMQ_HOST: "amqp://localhost",\n        REDIS_HOST: "localhost",\n        REDIS_PORT: 6379,\n        REDIS_PASSWORD: "",\n      },\n    },\n    {\n      name: "erxes-logger",\n      script: "dist",\n      cwd: "/home/erxes/erxes.io/erxes-logger",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      node_args: "--max_old_space_size=4096",\n      env: {\n        PORT: 3800,\n        NODE_ENV: "production",\n        DEBUG: "erxes-logs:*",\n        MONGO_URL: "mongodb://localhost/erxes_logger",\n        RABBITMQ_HOST: "amqp://localhost",\n      },\n    },\n    {\n      name: "erxes-integrations",\n      script: "dist",\n      cwd: "/home/erxes/erxes.io/erxes-integrations",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      node_args: "--max_old_space_size=4096",\n      env: {\n        PORT: 3400,\n        NODE_ENV: "production",\n        DEBUG: "erxes-integrations:*",\n        DOMAIN: "https://YOUR_DOMAIN_COM/integrations",\n        MAIN_APP_DOMAIN: "https://YOUR_DOMAIN_COM",\n        MAIN_API_DOMAIN: "https://YOUR_DOMAIN_COM/api",\n        MONGO_URL: "mongodb://localhost/erxes_integrations",\n        RABBITMQ_HOST: "amqp://localhost",\n        REDIS_HOST: "localhost",\n        REDIS_PORT: 6379,\n        REDIS_PASSWORD: "",\n      },\n    },\n    {\n      name: "erxes-elkSyncer",\n      script: "main.py",\n      cwd: "/home/erxes/erxes.io/erxes-elkSyncer/elkSyncer",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      interpreter: "/usr/bin/python3",\n      env: {\n        MONGO_URL: "mongodb://localhost/erxes",\n        ELASTICSEARCH_URL: "http://localhost:9200",\n      },\n    },\n    {\n      name: "erxes-email-verifier",\n      script: "dist",\n      cwd: "/home/erxes/erxes.io/erxes-email-verifier",\n      log_date_format: "YYYY-MM-DD HH:mm Z",\n      node_args: "--max_old_space_size=4096",\n      env: {\n        PORT_WORKERS: 3700,\n        NODE_ENV: "production",\n        DEBUG: "erxes-workers:*",\n        MONGO_URL: "mongodb://localhost/erxes",\n        REDIS_HOST: "localhost",\n        REDIS_PORT: 6379,\n        REDIS_PASSWORD: "",\n        RABBITMQ_HOST: "amqp://localhost",\n        JWT_TOKEN_SECRET: "YOUR_SECRET_TOKEN",\n      },\n    },\n  ],\n};\n')),Object(o.b)("p",null,"The next step is to set ",Object(o.b)("strong",{parentName:"p"},"environment variables")," so that we can easily populate the ",Object(o.b)("strong",{parentName:"p"},"ecosystem.config.js")," file."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Run the following command, but replace ",Object(o.b)("inlineCode",{parentName:"li"},"YOUR_ACTUAL_DOMAIN_COM")," with your actual domain name.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"#export YOUR_DOMAIN_COM=erxes.example.com\nexport YOUR_DOMAIN_COM=YOUR_ACTUAL_DOMAIN_COM\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Run the following command to create a ",Object(o.b)("strong",{parentName:"li"},"secret token"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"export YOUR_SECRET_TOKEN=`python3 -c 'import os,base64; print(base64.urlsafe_b64encode(os.urandom(16)).decode())'`\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Run each script below, to update your ",Object(o.b)("strong",{parentName:"li"},"DOMAIN_NAME_COM","*")," in the ",Object(o.b)("strong",{parentName:"li"},"ecosystem.config.js"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sed -i 's,YOUR_DOMAIN_COM,'\"${YOUR_DOMAIN_COM}\"',g' ecosystem.config.js\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Run each script below, to update your ",Object(o.b)("strong",{parentName:"li"},"SECRET_PASSWORD_TOKEN","*")," in the ",Object(o.b)("strong",{parentName:"li"},"ecosystem.config.js"))),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"sed -i 's,YOUR_SECRET_TOKEN,'\"${YOUR_SECRET_TOKEN}\"',g' ecosystem.config.js\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Start PM2")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"pm2 start ecosystem.config.js\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Generate a startup script. Copy/paste the script in the terminal and run it.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"pm2 startup\n")),Object(o.b)("p",null,"The above will generate a script like this: ",Object(o.b)("strong",{parentName:"p"},"DO NOT USE THIS EXAMPLE - USE YOURS GENERATED IN THE TERMINAL")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# DO NOT COPY THIS - USE THE ONE GENERATED IN THE TERMINAL\n# sudo env PATH=$PATH:/home/erxes/.nvm/versions/node/v12.18.2/bin /home/erxes/.nvm/versions/node/v12.18.2/lib/node_modules/pm2/bin/pm2 startup systemd -u erxes --hp /home/erxes\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Now copy ",Object(o.b)("strong",{parentName:"li"},"your output"),". Similar to the below.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"# THIS IS AN EXAMPLE - USE YOURS\nsudo env PATH=$PATH:/home/erxes/.nvm/versions/node/v12.18.2/bin /home/erxes/.nvm/versions/node/v12.18.2/lib/node_modules/pm2/bin/pm2 startup systemd -u erxes --hp /home/erxes\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Save all the applications that ",Object(o.b)("strong",{parentName:"li"},"PM2")," is managing.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"pm2 save\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Verify all process are running.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"pm2 l\n")),Object(o.b)("p",null,"The status of all the processes should say ",Object(o.b)("strong",{parentName:"p"},"online"),"."),Object(o.b)("h3",{id:"configure-frontend-environment-variables"},"Configure frontend environment variables"),Object(o.b)("p",null,"In the previous step, you set environment variables using ",Object(o.b)("strong",{parentName:"p"},"PM2"),", but ",Object(o.b)("strong",{parentName:"p"},"PM2")," does not have access to the bundled front-end static code. Therefore, you need to set the environment variables needed from the front-end differently."),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Open the appropriate ",Object(o.b)("inlineCode",{parentName:"li"},"env.js")," file in the nano editor.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"nano ~/erxes.io/erxes/build/js/env.js\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Copy the following ",Object(o.b)("strong",{parentName:"li"},"environment variables")," in between the ",Object(o.b)("strong",{parentName:"li"},"{ }"),", and replace ",Object(o.b)("strong",{parentName:"li"},"YOUR_DOMAIN_COM")," with your actual domain name.")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'NODE_ENV: "production",\nREACT_APP_API_URL: "https://YOUR_DOMAIN_COM/api",\nREACT_APP_API_SUBSCRIPTION_URL: "wss://YOUR_DOMAIN_COM/api/subscriptions",\nREACT_APP_CDN_HOST: "https://YOUR_DOMAIN_COM/widgets"\n')),Object(o.b)("p",null,"It should look like this, but ",Object(o.b)("strong",{parentName:"p"},"with your actual domain name"),":"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'window.env = {\n    NODE_ENV: "production",\n    REACT_APP_API_URL: "https://erxes.example.com/api",\n    REACT_APP_API_SUBSCRIPTION_URL: "wss://erxes.example.com/api/subscriptions",\n    REACT_APP_CDN_HOST: "https://erxes.example.com/widgets"\n}\n')),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"save the file with ",Object(o.b)("inlineCode",{parentName:"li"},"ctrl + x")," and then ",Object(o.b)("inlineCode",{parentName:"li"},"y")," to accept all changes.")),Object(o.b)("p",null,"You are now ready to ",Object(o.b)("strong",{parentName:"p"},"initialize")," and ",Object(o.b)("strong",{parentName:"p"},"load the permissions")," in ",Object(o.b)("strong",{parentName:"p"},"erxes"),"."),Object(o.b)("h2",{id:"export-mongodb-url"},"export MongoDB URL"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"initialize Erxes and generate ",Object(o.b)("strong",{parentName:"li"},"login password"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),'cd ~\nexport MONGO_URL="mongodb://localhost/erxes"\n')))),Object(o.b)("h2",{id:"initialize-and-load-permissions-for-erxes"},"Initialize and Load permissions for erxes"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"initialize Erxes and generate ",Object(o.b)("strong",{parentName:"li"},"login password"),".\ncd ~/erxes.io/erxes-api/dist")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"nvm use default\ncd ~/erxes.io/erxes-api/dist\nnode commands/initProject\n")),Object(o.b)("p",null,"You should have a generated ",Object(o.b)("strong",{parentName:"p"},"password"),". The output will be similar to this:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"Your new password: HcEjfBMxws\n\n# note this down\n")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Run this final command to finish the installation of ",Object(o.b)("strong",{parentName:"li"},"erxes"),".")),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{className:"language-bash"}),"pm2 restart erxes-api\nnode commands/loadPermissionData\n")),Object(o.b)("h2",{id:"congratulations-time-to-log-in"},"Congratulations, time to log in"),Object(o.b)("p",null,"You have installed ",Object(o.b)("strong",{parentName:"p"},"erxes")," and all the dependencies. You may now visit your url, and log in."),Object(o.b)("p",null,"The username is ",Object(o.b)("strong",{parentName:"p"},Object(o.b)("a",Object(a.a)({parentName:"strong"},{href:"mailto:admin@erxes.io"}),"admin@erxes.io")),", and the password is the password generated above."),Object(o.b)("h2",{id:"known-issues-and-frequent-questions"},"Known Issues and frequent Questions"),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},'"Host key verification failed" Error Message')),Object(o.b)("p",null,"Some users working on existing servers receive the following error message:"),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\nIT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!\nSomeone could be eavesdropping on you right now (man-in-the-middle attack)!\nIt is also possible that a host key has just been changed.\nThe fingerprint for the ECDSA key sent by the remote host is\nSHA256:JWhuzo4SNV8rJNp9-THIS-IS-AN-EXAMPLE-L3N1GIjdM6VENIE.\nPlease contact your system administrator.\nAdd correct host key in /Users/user/.ssh/known_hosts to get rid of this message.\nOffending ECDSA key in /Users/user/.ssh/known_hosts:30\nECDSA host key for 55.XX.XXX.46 has changed and you have requested strict checking.\nHost key verification failed.\n\n")),Object(o.b)("p",null,"This simply indicates that the key on the server has been changed. One solution is to delete the offending key from your local computer so this error goes away."),Object(o.b)("p",null,"You will need your ",Object(o.b)("strong",{parentName:"p"},"IP address")," and simply run this command using your ",Object(o.b)("strong",{parentName:"p"},"IP address"),"."),Object(o.b)("pre",null,Object(o.b)("code",Object(a.a)({parentName:"pre"},{}),"# example ssh-keygen -R 55.444.44.111\nssh-keygen -R your-ip-address-here\n")),Object(o.b)("p",null,"Then you should be able to log in to the server correctly."))}y.isMDXComponent=!0},136:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var i=r.a.createContext({}),c=function(e){var t=r.a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return r.a.createElement(i.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},m=r.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,i=b(e,["components","mdxType","originalType","parentName"]),p=c(n),m=a,d=p["".concat(s,".").concat(m)]||p[m]||u[m]||l;return n?r.a.createElement(d,o(o({ref:t},i),{},{components:n})):r.a.createElement(d,o({ref:t},i))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,s=new Array(l);s[0]=m;var o={};for(var b in t)hasOwnProperty.call(t,b)&&(o[b]=t[b]);o.originalType=e,o.mdxType="string"==typeof e?e:a,s[1]=o;for(var i=2;i<l;i++)s[i]=n[i];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},142:function(e,t,n){"use strict";function a(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(r&&(r+=" "),r+=t);return r}},155:function(e,t,n){"use strict";var a=n(0),r=Object(a.createContext)(void 0);t.a=r},156:function(e,t,n){"use strict";var a=n(0),r=n(155);t.a=function(){var e=Object(a.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}}}]);